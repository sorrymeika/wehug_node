!function(e,r){function i(e){return function(r){return{}.toString.call(r)=="[object "+e+"]"}}function l(){return f++}function m(e){return e.match(h)[0]}function y(e){for(e=e.replace(p,"/");e.match(g);)e=e.replace(g,"/");return e=e.replace(E,"$1/")}function b(e){var r=e.length-1,t=e.charAt(r);return"#"===t?e.substring(0,r):".js"===e.substring(r-2)||e.indexOf("?")>0||".css"===e.substring(r-3)||"/"===t?e:e+".js"}function T(e){var t,r=n.paths;return r&&(t=e.match(A))&&s(r[t[1]])&&(e=r[t[1]]+t[2]),e}function x(e){var r=n.vars;return r&&e.indexOf("{")>-1&&(e=e.replace(_,function(e,t){return s(r[t])?r[t]:e})),e}function D(e){var r=n.map,t=e;if(r)for(var i=0,a=r.length;a>i;i++){var s=r[i];if(t=u(s)?s(e)||e:e.replace(s[0],s[1]),t!==e)break}return t}function w(e,r){var t,i=e.charAt(0);if(S.test(e))t=e;else if("."===i)t=y((r?m(r):n.cwd)+e);else if("/"===i){var a=n.cwd.match(U);t=a?a[0]+e.substring(1):e}else t=n.base+e;return 0===t.indexOf("//")&&(t=location.protocol+t),t}function C(e,r){if(!e)return"";var t=n.alias&&n.alias[e];t&&s(t)&&(e=t),e=T(e),e=x(e),e=b(e);var i=w(e,r);return i=D(i),!t||z[i]||s(t)||(z[i]={exports:t,status:re.EXECUTED,exec:te.prototype.exec}),i}function G(e){return e.hasAttribute?e.src:e.getAttribute("src",4)}function F(e,r,t,n){var i=L.test(e),a=N.createElement(i?"link":"script");t&&(a.charset=t),c(n)||a.setAttribute("crossorigin",n),V(a,r,i,e),i?(a.rel="stylesheet",a.href=e):(a.async=!0,a.src=e),$=a,k?R.insertBefore(a,k):R.appendChild(a),$=null}function V(e,r,n,i){function s(){e.onload=e.onerror=e.onreadystatechange=null,n||t.data.debug||R.removeChild(e),e=null,r()}var a="onload"in e;return!n||!B&&a?void(a?(e.onload=s,e.onerror=function(){var a={uri:i,node:e,callback:r,isCSS:n};t.emit("error",a),a.pause&&(r=function(){}),s()}):e.onreadystatechange=function(){/loaded|complete/.test(e.readyState)&&s()}):void setTimeout(function(){H(e,r)},1)}function H(e,r){var n,t=e.sheet;if(B)t&&(n=!0);else if(t)try{t.cssRules&&(n=!0)}catch(i){"NS_ERROR_DOM_SECURITY_ERR"===i.name&&(n=!0)}setTimeout(function(){n?r():H(e,r)},20)}function K(){if($)return $;if(X&&"interactive"===X.readyState)return X;for(var e=R.getElementsByTagName("script"),r=e.length-1;r>=0;r--){var t=e[r];if("interactive"===t.readyState)return X=t}}function Y(e){var r=[];return e.replace(P,"").replace(M,function(e,t,n){n&&r.push(n)}),r}function te(e,r){this.uri=e,this.dependencies=r||[],this.exports=null,this.status=0,this._waitings={},this._remain=0}if(!e.seajs){var t=e.seajs={version:"2.2.3"},n=t.data={},a=i("Object"),s=i("String"),o=Array.isArray||i("Array"),u=i("Function"),c=i("Undefined"),f=0,d=n.events={};t.on=function(e,r){var n=d[e]||(d[e]=[]);return n.push(r),t},t.off=function(e,r){if(!e&&!r)return d=n.events={},t;var i=d[e];if(i)if(r)for(var a=i.length-1;a>=0;a--)i[a]===r&&i.splice(a,1);else delete d[e];return t};var v=t.emit=function(e,r){var i,n=d[e];if(n)for(n=n.slice();i=n.shift();)i(r);return t},h=/[^?#]*\//,p=/\/\.\//g,g=/\/[^\/]+\/\.\.\//,E=/([^:\/])\/\//g,A=/^([^\/:]+)(\/.+)$/,_=/{([^{]+)}/g,S=/^\/\/.|:\//,U=/^.*?\/\/.*?\//,N=document,O=m(N.URL),q=N.scripts,I=N.getElementById("seajsnode")||q[q.length-1],j=m(G(I)||O);t.resolve=C;var $,X,R=N.head||N.getElementsByTagName("head")[0]||N.documentElement,k=R.getElementsByTagName("base")[0],L=/\.css(?:\?|$)/i,B=+navigator.userAgent.replace(/.*(?:AppleWebKit|AndroidWebKit)\/(\d+).*/,"$1")<536;t.request=F;var J,M=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,P=/\\\\/g,z=t.cache={},Q={},Z={},ee={},re=te.STATUS={FETCHING:1,SAVED:2,LOADING:3,LOADED:4,EXECUTING:5,EXECUTED:6};te.prototype.resolve=function(){for(var e=this,r=e.dependencies,t=[],n=0,i=r.length;i>n;n++)t[n]=te.resolve(r[n],e.uri);return t},te.prototype.load=function(){var e=this;if(!(e.status>=re.LOADING)){e.status=re.LOADING;var r=e.resolve();v("load",r);for(var n,t=e._remain=r.length,i=0;t>i;i++)n=te.get(r[i]),n.status<re.LOADED?n._waitings[e.uri]=(n._waitings[e.uri]||0)+1:e._remain--;if(0===e._remain)return void e.onload();var a={};for(i=0;t>i;i++)n=z[r[i]],n.status<re.FETCHING?n.fetch(a):n.status===re.SAVED&&n.load();for(var s in a)a.hasOwnProperty(s)&&a[s]()}},te.prototype.onload=function(){var e=this;e.status=re.LOADED,e.callback&&e.callback();var t,n,r=e._waitings;for(t in r)r.hasOwnProperty(t)&&(n=z[t],n._remain-=r[t],0===n._remain&&n.onload());delete e._waitings,delete e._remain},te.prototype.fetch=function(e){function o(){t.request(a.requestUri,a.onRequest,a.charset,a.crossorigin)}function c(){delete Q[s],Z[s]=!0,J&&(te.save(i,J),J=null);var e,r=ee[s];for(delete ee[s];e=r.shift();)e.load()}var r=this,i=r.uri;r.status=re.FETCHING;var a={uri:i};v("fetch",a);var s=a.requestUri||i;return!s||Z[s]?void r.load():Q[s]?void ee[s].push(r):(Q[s]=!0,ee[s]=[r],v("request",a={uri:i,requestUri:s,onRequest:c,charset:u(n.charset)?n.charset(s):n.charset,crossorigin:u(n.crossorigin)?n.crossorigin(s):n.crossorigin}),void(a.requested||(e?e[a.requestUri]=o:o())))},te.prototype.exec=function(){function n(e){return te.get(n.resolve(e)).exec()}var e=this;if(e.status>=re.EXECUTING)return e.exports;e.status=re.EXECUTING;var t=e.uri;n.resolve=function(e){return te.resolve(e,t)},n.async=function(e,r){return te.use(e,r,t+"_async_"+l()),n};var i=e.factory,a=u(i)?i(n,e.exports={},e):i;return a===r&&(a=e.exports),delete e.factory,e.exports=a,e.status=re.EXECUTED,v("exec",e),a},te.resolve=function(e,r){var n={id:e,refUri:r};return v("resolve",n),n.uri||t.resolve(n.id,r)},te.define=function(e,t,n){var i=arguments.length;1===i?(n=e,e=r):2===i&&(n=t,o(e)?(t=e,e=r):t=r),!o(t)&&u(n)&&(t=Y(n.toString()));var a={id:e,uri:te.resolve(e),deps:t,factory:n};if(!a.uri&&N.attachEvent){var s=K();s&&(a.uri=s.src.replace(/\?.*/g,""))}v("define",a),a.uri?te.save(a.uri,a):J=a},te.save=function(e,r){var t=te.get(e);t.status<re.SAVED&&(t.id=r.id||e,t.dependencies=r.deps||[],t.factory=r.factory,t.status=re.SAVED)},te.get=function(e,r){return z[e]||(z[e]=new te(e,r))},te.use=function(r,t,n){var i=te.get(n,o(r)?r:[r]);i.callback=function(){for(var r=[],n=i.resolve(),a=0,s=n.length;s>a;a++)r[a]=z[n[a]].exec();t&&t.apply(e,r),delete i.callback},i.load()},te.preload=function(e){var r=n.preload,t=r.length;t?te.use(r,function(){r.splice(0,t),te.preload(e)},n.cwd+"_preload_"+l()):e()},t.use=function(e,r){return te.preload(function(){te.use(e,r,n.cwd+"_use_"+l())}),t},te.define.cmd={},e.define=te.define,t.Module=te,n.fetchedList=Z,n.cid=l,t.require=function(e){var r=te.get(te.resolve(e));return r.status<re.EXECUTING&&(r.onload(),r.exec()),r.exports};var ne=/^(.+?\/)(\?\?)?(seajs\/)+/;n.base=(j.match(ne)||["",j])[1],n.dir=j,n.cwd=O,n.charset="utf-8",n.preload=function(){var e=[],r=location.search.replace(/(seajs-\w+)(&|$)/g,"$1=1$2");return r+=" "+N.cookie,r.replace(/(seajs-\w+)=1/g,function(r,t){e.push(t)}),e}(),t.config=function(e){for(var r in e){var i=e[r],s=n[r];if(s&&a(s))for(var u in i)s[u]=i[u];else o(s)?i=s.concat(i):"base"===r&&("/"!==i.slice(-1)&&(i+="/"),i=w(i)),n[r]=i}return v("config",e),t}}}(this);var Zepto=function(){function D(t){return null==t?String(t):T[S.call(t)]||"object"}function P(t){return"function"==D(t)}function L(t){return null!=t&&t==t.window}function $(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function R(t){return"object"==D(t)}function q(t){return R(t)&&!L(t)&&Object.getPrototypeOf(t)==Object.prototype}function U(t){return"number"==typeof t.length}function k(t){return a.call(t,function(t){return null!=t})}function Z(t){return t.length>0?n.fn.concat.apply([],t):t}function I(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function M(t){return t in c?c[t]:c[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function F(t,e){return"number"!=typeof e||l[I(t)]?e:e+"px"}function z(t){var e,n;return u[t]||(e=s.createElement(t),s.body.appendChild(e),n=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),u[t]=n),u[t]}function H(t){return"children"in t?o.call(t.children):n.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function X(n,r,i){for(e in r)i&&(q(r[e])||_(r[e]))?(q(r[e])&&!q(n[e])&&(n[e]={}),_(r[e])&&!_(n[e])&&(n[e]=[]),X(n[e],r[e],i)):r[e]!==t&&(n[e]=r[e])}function V(t,e){return null==e?n(t):n(t).filter(e)}function B(t,e,n,r){return P(e)?e.call(t,n,r):e}function G(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function W(e,n){var r=e.className,i=r&&r.baseVal!==t;return n===t?i?r.baseVal:r:void(i?r.baseVal=n:e.className=n)}function J(t){var e;try{return t?"true"==t||("false"==t?!1:"null"==t?null:/^0/.test(t)||isNaN(e=Number(t))?/^[\[\{]/.test(t)?n.parseJSON(t):t:e):t}catch(r){return t}}function Y(t,e){e(t);for(var n in t.childNodes)Y(t.childNodes[n],e)}var t,e,n,r,C,N,i=[],o=i.slice,a=i.filter,s=window.document,u={},c={},l={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},f=/^\s*<(\w+|!)[^>]*>/,h=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,p=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,d=/^(?:body|html)$/i,v=/([A-Z])/g,g=["val","css","html","text","data","width","height","offset"],m=["after","prepend","before","append"],y=s.createElement("table"),x=s.createElement("tr"),b={tr:s.createElement("tbody"),tbody:y,thead:y,tfoot:y,td:x,th:x,"*":s.createElement("div")},E=/complete|loaded|interactive/,w=/^[\w-]*$/,T={},S=T.toString,j={},O=s.createElement("div"),A={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},_=Array.isArray||function(t){return t instanceof Array};return j.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var r,i=t.parentNode,o=!i;return o&&(i=O).appendChild(t),r=~j.qsa(i,e).indexOf(t),o&&O.removeChild(t),r},C=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},N=function(t){return a.call(t,function(e,n){return t.indexOf(e)==n})},j.fragment=function(e,r,i){var a,u,c;return h.test(e)&&(a=n(s.createElement(RegExp.$1))),a||(e.replace&&(e=e.replace(p,"<$1></$2>")),r===t&&(r=f.test(e)&&RegExp.$1),r in b||(r="*"),c=b[r],c.innerHTML=""+e,a=n.each(o.call(c.childNodes),function(){c.removeChild(this)})),q(i)&&(u=n(a),n.each(i,function(t,e){g.indexOf(t)>-1?u[t](e):u.attr(t,e)})),a},j.Z=function(t,e){return t=t||[],t.__proto__=n.fn,t.selector=e||"",t},j.isZ=function(t){return t instanceof j.Z},j.init=function(e,r){var i;if(!e)return j.Z();if("string"==typeof e)if(e=e.trim(),"<"==e[0]&&f.test(e))i=j.fragment(e,RegExp.$1,r),e=null;else{if(r!==t)return n(r).find(e);i=j.qsa(s,e)}else{if(P(e))return n(s).ready(e);if(j.isZ(e))return e;if(_(e))i=k(e);else if(R(e))i=[e],e=null;else if(f.test(e))i=j.fragment(e.trim(),RegExp.$1,r),e=null;else{if(r!==t)return n(r).find(e);i=j.qsa(s,e)}}return j.Z(i,e)},n=function(t,e){return j.init(t,e)},n.extend=function(t){var e,n=o.call(arguments,1);return"boolean"==typeof t&&(e=t,t=n.shift()),n.forEach(function(n){X(t,n,e)}),t},j.qsa=function(t,e){var n,r="#"==e[0],i=!r&&"."==e[0],a=r||i?e.slice(1):e,s=w.test(a);return $(t)&&s&&r?(n=t.getElementById(a))?[n]:[]:1!==t.nodeType&&9!==t.nodeType?[]:o.call(s&&!r?i?t.getElementsByClassName(a):t.getElementsByTagName(e):t.querySelectorAll(e))},n.contains=function(t,e){return t!==e&&t.contains(e)},n.type=D,n.isFunction=P,n.isWindow=L,n.isArray=_,n.isPlainObject=q,n.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},n.inArray=function(t,e,n){return i.indexOf.call(e,t,n)},n.camelCase=C,n.trim=function(t){return null==t?"":String.prototype.trim.call(t)},n.uuid=0,n.support={},n.expr={},n.map=function(t,e){var n,i,o,r=[];if(U(t))for(i=0;i<t.length;i++)n=e(t[i],i),null!=n&&r.push(n);else for(o in t)n=e(t[o],o),null!=n&&r.push(n);return Z(r)},n.each=function(t,e){var n,r;if(U(t)){for(n=0;n<t.length;n++)if(e.call(t[n],n,t[n])===!1)return t}else for(r in t)if(e.call(t[r],r,t[r])===!1)return t;return t},n.grep=function(t,e){return a.call(t,e)},window.JSON&&(n.parseJSON=JSON.parse),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){T["[object "+e+"]"]=e.toLowerCase()}),n.fn={forEach:i.forEach,reduce:i.reduce,push:i.push,sort:i.sort,indexOf:i.indexOf,concat:i.concat,map:function(t){return n(n.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return n(o.apply(this,arguments))},ready:function(t){return E.test(s.readyState)&&s.body?t(n):s.addEventListener("DOMContentLoaded",function(){t(n)},!1),this},get:function(e){return e===t?o.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return i.every.call(this,function(e,n){return t.call(e,n,e)!==!1}),this},filter:function(t){return P(t)?this.not(this.not(t)):n(a.call(this,function(e){return j.matches(e,t)}))},add:function(t,e){return n(N(this.concat(n(t,e))))},is:function(t){return this.length>0&&j.matches(this[0],t)},not:function(e){var r=[];if(P(e)&&e.call!==t)this.each(function(t){e.call(this,t)||r.push(this)});else{var i="string"==typeof e?this.filter(e):U(e)&&P(e.item)?o.call(e):n(e);this.forEach(function(t){i.indexOf(t)<0&&r.push(t)})}return n(r)},has:function(t){return this.filter(function(){return R(t)?n.contains(this,t):n(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!R(t)?t:n(t)},last:function(){var t=this[this.length-1];return t&&!R(t)?t:n(t)},find:function(t){var e,r=this;return e="object"==typeof t?n(t).filter(function(){var t=this;return i.some.call(r,function(e){return n.contains(e,t)})}):1==this.length?n(j.qsa(this[0],t)):this.map(function(){return j.qsa(this,t)})},closest:function(t,e){var r=this[0],i=!1;for("object"==typeof t&&(i=n(t));r&&!(i?i.indexOf(r)>=0:j.matches(r,t));)r=r!==e&&!$(r)&&r.parentNode;return n(r)},parents:function(t){for(var e=[],r=this;r.length>0;)r=n.map(r,function(t){return(t=t.parentNode)&&!$(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return V(e,t)},parent:function(t){return V(N(this.pluck("parentNode")),t)},children:function(t){return V(this.map(function(){return H(this)}),t)},contents:function(){return this.map(function(){return o.call(this.childNodes)})},siblings:function(t){return V(this.map(function(t,e){return a.call(H(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return n.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=z(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var e=P(t);if(this[0]&&!e)var r=n(t).get(0),i=r.parentNode||this.length>1;return this.each(function(o){n(this).wrapAll(e?t.call(this,o):i?r.cloneNode(!0):r)})},wrapAll:function(t){if(this[0]){n(this[0]).before(t=n(t));for(var e;(e=t.children()).length;)t=e.first();n(t).append(this)}return this},wrapInner:function(t){var e=P(t);return this.each(function(r){var i=n(this),o=i.contents(),a=e?t.call(this,r):t;o.length?o.wrapAll(a):i.append(a)})},unwrap:function(){return this.parent().each(function(){n(this).replaceWith(n(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var r=n(this);(e===t?"none"==r.css("display"):e)?r.show():r.hide()})},prev:function(t){return n(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return n(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0===arguments.length?this.length>0?this[0].innerHTML:null:this.each(function(e){var r=this.innerHTML;n(this).empty().append(B(this,t,e,r))})},text:function(e){return 0===arguments.length?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=e===t?"":""+e})},attr:function(n,r){var i;return"string"==typeof n&&r===t?0==this.length||1!==this[0].nodeType?t:"value"==n&&"INPUT"==this[0].nodeName?this.val():!(i=this[0].getAttribute(n))&&n in this[0]?this[0][n]:i:this.each(function(t){if(1===this.nodeType)if(R(n))for(e in n)G(this,e,n[e]);else G(this,n,B(this,r,t,this.getAttribute(n)))})},removeAttr:function(t){return this.each(function(){1===this.nodeType&&G(this,t)})},prop:function(e,n){return e=A[e]||e,n===t?this[0]&&this[0][e]:this.each(function(t){this[e]=B(this,n,t,this[e])})},data:function(e,n){var r="data-"+e.replace(v,"-$1").toLowerCase(),i=1 in arguments?this.attr(r,n):this.attr(r);return null!==i?J(i):t},val:function(t){return 0===arguments.length?this[0]&&(this[0].multiple?n(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(e){this.value=B(this,t,e,this.value)})},offset:function(t){if(t)return this.each(function(e){var r=n(this),i=B(this,t,e,r.offset()),o=r.offsetParent().offset(),a={top:i.top-o.top,left:i.left-o.left};"static"==r.css("position")&&(a.position="relative"),r.css(a)});if(0==this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(t,r){if(arguments.length<2){var i=this[0],o=getComputedStyle(i,"");if(!i)return;if("string"==typeof t)return i.style[C(t)]||o.getPropertyValue(t);if(_(t)){var a={};return n.each(_(t)?t:[t],function(t,e){a[e]=i.style[C(e)]||o.getPropertyValue(e)}),a}}var s="";if("string"==D(t))r||0===r?s=I(t)+":"+F(t,r):this.each(function(){this.style.removeProperty(I(t))});else for(e in t)t[e]||0===t[e]?s+=I(e)+":"+F(e,t[e])+";":this.each(function(){this.style.removeProperty(I(e))});return this.each(function(){this.style.cssText+=";"+s})},index:function(t){return t?this.indexOf(n(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return t?i.some.call(this,function(t){return this.test(W(t))},M(t)):!1},addClass:function(t){return t?this.each(function(e){r=[];var i=W(this),o=B(this,t,e,i);o.split(/\s+/g).forEach(function(t){n(this).hasClass(t)||r.push(t)},this),r.length&&W(this,i+(i?" ":"")+r.join(" "))}):this},removeClass:function(e){return this.each(function(n){return e===t?W(this,""):(r=W(this),B(this,e,n,r).split(/\s+/g).forEach(function(t){r=r.replace(M(t)," ")}),void W(this,r.trim()))})},toggleClass:function(e,r){return e?this.each(function(i){var o=n(this),a=B(this,e,i,W(this));a.split(/\s+/g).forEach(function(e){(r===t?!o.hasClass(e):r)?o.addClass(e):o.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var n="scrollTop"in this[0];return e===t?n?this[0].scrollTop:this[0].pageYOffset:this.each(n?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var n="scrollLeft"in this[0];return e===t?n?this[0].scrollLeft:this[0].pageXOffset:this.each(n?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),r=this.offset(),i=d.test(e[0].nodeName)?{top:0,left:0}:e.offset();return r.top-=parseFloat(n(t).css("margin-top"))||0,r.left-=parseFloat(n(t).css("margin-left"))||0,i.top+=parseFloat(n(e[0]).css("border-top-width"))||0,i.left+=parseFloat(n(e[0]).css("border-left-width"))||0,{top:r.top-i.top,left:r.left-i.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||s.body;t&&!d.test(t.nodeName)&&"static"==n(t).css("position");)t=t.offsetParent;return t})}},n.fn.detach=n.fn.remove,["width","height"].forEach(function(e){var r=e.replace(/./,function(t){return t[0].toUpperCase()});n.fn[e]=function(i){var o,a=this[0];return i===t?L(a)?a["inner"+r]:$(a)?a.documentElement["scroll"+r]:(o=this.offset())&&o[e]:this.each(function(t){a=n(this),a.css(e,B(this,i,t,a[e]()))})}}),m.forEach(function(t,e){var r=e%2;n.fn[t]=function(){var t,o,i=n.map(arguments,function(e){return t=D(e),"object"==t||"array"==t||null==e?e:j.fragment(e)}),a=this.length>1;return i.length<1?this:this.each(function(t,s){o=r?s:s.parentNode,s=0==e?s.nextSibling:1==e?s.firstChild:2==e?s:null,i.forEach(function(t){if(a)t=t.cloneNode(!0);else if(!o)return n(t).remove();Y(o.insertBefore(t,s),function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},n.fn[r?t+"To":"insert"+(e?"Before":"After")]=function(e){return n(e)[t](this),this}}),j.Z.prototype=n.fn,j.uniq=N,j.deserializeValue=J,n.zepto=j,n}();window.Zepto=Zepto,void 0===window.$&&(window.$=Zepto),function(t){function f(t){return t._zid||(t._zid=e++)}function h(t,e,n,r){if(e=p(e),e.ns)var i=d(e.ns);return(a[f(t)]||[]).filter(function(t){return t&&(!e.e||t.e==e.e)&&(!e.ns||i.test(t.ns))&&(!n||f(t.fn)===f(n))&&(!r||t.sel==r)})}function p(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function d(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function v(t,e){return t.del&&!u&&t.e in c||!!e}function g(t){return l[t]||u&&c[t]||t}function m(e,r,i,o,s,u,c){var h=f(e),d=a[h]||(a[h]=[]);r.split(/\s/).forEach(function(r){if("ready"==r)return t(document).ready(i);var a=p(r);a.fn=i,a.sel=s,a.e in l&&(i=function(e){var n=e.relatedTarget;return!n||n!==this&&!t.contains(this,n)?a.fn.apply(this,arguments):void 0}),a.del=u;var f=u||i;a.proxy=function(t){if(t=T(t),!t.isImmediatePropagationStopped()){t.data=o;var r=f.apply(e,t._args==n?[t]:[t].concat(t._args));return r===!1&&(t.preventDefault(),t.stopPropagation()),r}},a.i=d.length,d.push(a),"addEventListener"in e&&e.addEventListener(g(a.e),a.proxy,v(a,c))})}function y(t,e,n,r,i){var o=f(t);(e||"").split(/\s/).forEach(function(e){h(t,e,n,r).forEach(function(e){delete a[o][e.i],"removeEventListener"in t&&t.removeEventListener(g(e.e),e.proxy,v(e,i))})})}function T(e,r){return(r||!e.isDefaultPrevented)&&(r||(r=e),t.each(w,function(t,n){var i=r[t];e[t]=function(){return this[n]=x,i&&i.apply(r,arguments)},e[n]=b}),(r.defaultPrevented!==n?r.defaultPrevented:"returnValue"in r?r.returnValue===!1:r.getPreventDefault&&r.getPreventDefault())&&(e.isDefaultPrevented=x)),e}function S(t){var e,r={originalEvent:t};for(e in t)E.test(e)||t[e]===n||(r[e]=t[e]);return T(r,t)}var n,e=1,r=Array.prototype.slice,i=t.isFunction,o=function(t){return"string"==typeof t},a={},s={},u="onfocusin"in window,c={focus:"focusin",blur:"focusout"},l={mouseenter:"mouseover",mouseleave:"mouseout"};s.click=s.mousedown=s.mouseup=s.mousemove="MouseEvents",t.event={add:m,remove:y},t.proxy=function(e,n){if(i(e)){var r=function(){return e.apply(n,arguments)};return r._zid=f(e),r}if(o(n))return t.proxy(e[n],e);throw new TypeError("expected function")},t.fn.bind=function(t,e,n){return this.on(t,e,n)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,n,r){return this.on(t,e,n,r,1)};var x=function(){return!0},b=function(){return!1},E=/^([A-Z]|returnValue$|layer[XY]$)/,w={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(t,e,n){return this.on(e,t,n)},t.fn.undelegate=function(t,e,n){return this.off(e,t,n)},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(e,a,s,u,c){var l,f,h=this;return e&&!o(e)?(t.each(e,function(t,e){h.on(t,a,s,e,c)}),h):(o(a)||i(u)||u===!1||(u=s,s=a,a=n),(i(s)||s===!1)&&(u=s,s=n),u===!1&&(u=b),h.each(function(n,i){c&&(l=function(t){return y(i,t.type,u),u.apply(this,arguments)}),a&&(f=function(e){var n,o=t(e.target).closest(a,i).get(0);return o&&o!==i?(n=t.extend(S(e),{currentTarget:o,liveFired:i}),(l||u).apply(o,[n].concat(r.call(arguments,1)))):void 0}),m(i,e,u,s,a,f||l)}))},t.fn.off=function(e,r,a){var s=this;return e&&!o(e)?(t.each(e,function(t,e){s.off(t,r,e)}),s):(o(r)||i(a)||a===!1||(a=r,r=n),a===!1&&(a=b),s.each(function(){y(this,e,a,r)}))},t.fn.trigger=function(e,n){return e=o(e)||t.isPlainObject(e)?t.Event(e):T(e),e._args=n,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,n)})},t.fn.triggerHandler=function(e,n){var r,i;return this.each(function(a,s){r=S(o(e)?t.Event(e):e),r._args=n,r.target=s,t.each(h(s,e.type||e),function(t,e){return i=e.proxy(r),r.isImmediatePropagationStopped()?!1:void 0})}),i},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.trigger(e)}}),["focus","blur"].forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.each(function(){try{this[e]()}catch(t){}}),this}}),t.Event=function(t,e){o(t)||(e=t,t=e.type);var n=document.createEvent(s[t]||"Events"),r=!0;if(e)for(var i in e)"bubbles"==i?r=!!e[i]:n[i]=e[i];return n.initEvent(t,r,!0),T(n)}}(Zepto),function(t){function f(e,n,r){var i=t.Event(n);return t(e).trigger(i,r),!i.isDefaultPrevented()}function h(t,e,r,i){return t.global?f(e||n,r,i):void 0}function p(e){e.global&&0===t.active++&&h(e,null,"ajaxStart")}function d(e){e.global&&!--t.active&&h(e,null,"ajaxStop")}function v(t,e){var n=e.context;return e.beforeSend.call(n,t,e)===!1||h(e,n,"ajaxBeforeSend",[t,e])===!1?!1:void h(e,n,"ajaxSend",[t,e])}function g(t,e,n,r){var i=n.context,o="success";n.success.call(i,t,o,e),r&&r.resolveWith(i,[t,o,e]),h(n,i,"ajaxSuccess",[e,n,t]),y(o,e,n)}function m(t,e,n,r,i){var o=r.context;r.error.call(o,n,e,t),i&&i.rejectWith(o,[n,e,t]),h(r,o,"ajaxError",[n,r,t||e]),y(e,n,r)}function y(t,e,n){var r=n.context;n.complete.call(r,e,t),h(n,r,"ajaxComplete",[e,n]),d(n)}function x(){}function b(t){return t&&(t=t.split(";",2)[0]),t&&(t==c?"html":t==u?"json":a.test(t)?"script":s.test(t)&&"xml")||"text"}function E(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function w(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=E(e.url,e.data),e.data=void 0)}function T(e,n,r,i){return t.isFunction(n)&&(i=r,r=n,n=void 0),t.isFunction(r)||(i=r,r=void 0),{url:e,data:n,success:r,dataType:i}}function j(e,n,r,i){var o,a=t.isArray(n),s=t.isPlainObject(n);t.each(n,function(n,u){o=t.type(u),i&&(n=r?i:i+"["+(s||"object"==o||"array"==o?n:"")+"]"),!i&&a?e.add(u.name,u.value):"array"==o||!r&&"object"==o?j(e,u,r,n):e.add(n,u)})}var r,i,e=0,n=window.document,o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,a=/^(?:text|application)\/javascript/i,s=/^(?:text|application)\/xml/i,u="application/json",c="text/html",l=/^\s*$/;t.active=0,t.ajaxJSONP=function(r,i){if(!("type"in r))return t.ajax(r);var c,h,o=r.jsonpCallback,a=(t.isFunction(o)?o():o)||"jsonp"+ ++e,s=n.createElement("script"),u=window[a],l=function(e){t(s).triggerHandler("error",e||"abort")},f={abort:l};return i&&i.promise(f),t(s).on("load error",function(e,n){clearTimeout(h),t(s).off().remove(),"error"!=e.type&&c?g(c[0],f,r,i):m(null,n||"error",f,r,i),window[a]=u,c&&t.isFunction(u)&&u(c[0]),u=c=void 0}),v(f,r)===!1?(l("abort"),f):(window[a]=function(){c=arguments},s.src=r.url.replace(/\?(.+)=\?/,"?$1="+a),n.head.appendChild(s),r.timeout>0&&(h=setTimeout(function(){l("timeout")},r.timeout)),f)},t.ajaxSettings={type:"GET",beforeSend:x,success:x,error:x,complete:x,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:u,xml:"application/xml, text/xml",html:c,text:"text/plain"},crossDomain:!0,timeout:0,processData:!0,cache:!0},t.ajax=function(e){var n=t.extend({},e||{}),o=t.Deferred&&t.Deferred();for(r in t.ajaxSettings)void 0===n[r]&&(n[r]=t.ajaxSettings[r]);p(n),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host),n.url||(n.url=window.location.toString()),w(n),n.cache===!1&&(n.url=E(n.url,"_="+Date.now()));var a=n.dataType,s=/\?.+=\?/.test(n.url);if("jsonp"==a||s)return s||(n.url=E(n.url,n.jsonp?n.jsonp+"=?":n.jsonp===!1?"":"callback=?")),t.ajaxJSONP(n,o);var T,u=n.accepts[a],c={},f=function(t,e){c[t.toLowerCase()]=[t,e]},h=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,d=n.xhr(),y=d.setRequestHeader;if(o&&o.promise(d),n.crossDomain||f("X-Requested-With","XMLHttpRequest"),f("Accept",u||"*/*"),(u=n.mimeType||u)&&(u.indexOf(",")>-1&&(u=u.split(",",2)[0]),d.overrideMimeType&&d.overrideMimeType(u)),(n.contentType||n.contentType!==!1&&n.data&&"GET"!=n.type.toUpperCase())&&f("Content-Type",n.contentType||"application/x-www-form-urlencoded"),n.headers)for(i in n.headers)f(i,n.headers[i]);if(d.setRequestHeader=f,d.onreadystatechange=function(){if(4==d.readyState){d.onreadystatechange=x,clearTimeout(T);var e,r=!1;if(d.status>=200&&d.status<300||304==d.status||0==d.status&&"file:"==h){a=a||b(n.mimeType||d.getResponseHeader("content-type")),e=d.responseText;try{"script"==a?(1,eval)(e):"xml"==a?e=d.responseXML:"json"==a&&(e=l.test(e)?null:t.parseJSON(e))}catch(i){r=i}r?m(r,"parsererror",d,n,o):g(e,d,n,o)}else m(d.statusText||null,d.status?"error":"abort",d,n,o)}},v(d,n)===!1)return d.abort(),m(null,"abort",d,n,o),d;if(n.xhrFields)for(i in n.xhrFields)d[i]=n.xhrFields[i];var S="async"in n?n.async:!0;d.open(n.type,n.url,S,n.username,n.password);for(i in c)y.apply(d,c[i]);return n.timeout>0&&(T=setTimeout(function(){d.onreadystatechange=x,d.abort(),m(null,"timeout",d,n,o)},n.timeout)),d.send(n.data?n.data:null),d},t.get=function(){return t.ajax(T.apply(null,arguments))},t.post=function(){var e=T.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=T.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,n,r){if(!this.length)return this;var s,i=this,a=e.split(/\s/),u=T(e,n,r),c=u.success;return a.length>1&&(u.url=a[0],s=a[1]),u.success=function(e){i.html(s?t("<div>").html(e.replace(o,"")).find(s):e),c&&c.apply(i,arguments)},t.ajax(u),this};var S=encodeURIComponent;t.param=function(t,e){var n=[];return n.add=function(t,e){this.push(S(t)+"="+S(null===e||void 0===e?"":e))},j(n,t,e),n.join("&").replace(/%20/g,"+")}}(Zepto),function(t){t.fn.serializeArray=function(){var n,e=[];return t([].slice.call(this.get(0).elements)).each(function(){n=t(this);var r=n.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=r&&"reset"!=r&&"button"!=r&&("radio"!=r&&"checkbox"!=r||this.checked)&&e.push({name:n.attr("name"),value:n.val()})}),e},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(e)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),function(t){"__proto__"in{}||t.extend(t.zepto,{Z:function(e,n){return e=e||[],t.extend(e,t.fn),e.selector=n||"",e.__Z=!0,e},isZ:function(e){return"array"===t.type(e)&&"__Z"in e}});try{getComputedStyle(void 0)}catch(e){var n=getComputedStyle;window.getComputedStyle=function(t){try{return n(t)}catch(e){return null}}}}(Zepto),define&&define("zepto",[],function(){return Zepto});!function(t,e){function b(t){return t.replace(/([a-z])([A-Z])/,"$1-$2").toLowerCase()}function E(t){return r?r+t:t.toLowerCase()}var r,l,f,h,p,d,v,m,g,y,n="",a={Webkit:"webkit",Moz:"",O:"o"},s=window.document,u=s.createElement("div"),c=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,x={};t.each(a,function(t,i){return u.style[t+"TransitionProperty"]!==e?(n="-"+t.toLowerCase()+"-",r=i,!1):void 0}),l=n+"transform",x[f=n+"transition-property"]=x[h=n+"transition-duration"]=x[d=n+"transition-delay"]=x[p=n+"transition-timing-function"]=x[v=n+"animation-name"]=x[m=n+"animation-duration"]=x[y=n+"animation-delay"]=x[g=n+"animation-timing-function"]="",t.fx={off:r===e&&u.style.transitionProperty===e,speeds:{_default:400,fast:200,slow:600},cssPrefix:n,transitionEnd:E("TransitionEnd"),animationEnd:E("AnimationEnd")},t.fn.animate=function(n,r,i,o,a){return t.isFunction(r)&&(o=r,i=e,r=e),t.isFunction(i)&&(o=i,i=e),t.isPlainObject(r)&&(i=r.easing,o=r.complete,a=r.delay,r=r.duration),r&&(r=("number"==typeof r?r:t.fx.speeds[r]||t.fx.speeds._default)/1e3),a&&(a=parseFloat(a)/1e3),this.anim(n,r,i,o,a)},t.fn.anim=function(n,r,i,o,a){var s,E,j,u={},w="",T=this,S=t.fx.transitionEnd,C=!1;if(r===e&&(r=t.fx.speeds._default/1e3),a===e&&(a=0),t.fx.off&&(r=0),"string"==typeof n)u[v]=n,u[m]=r+"s",u[y]=a+"s",u[g]=i||"linear",S=t.fx.animationEnd;else{E=[];for(s in n)c.test(s)?w+=s+"("+n[s]+") ":(u[s]=n[s],E.push(b(s)));w&&(u[l]=w,E.push(l)),r>0&&"object"==typeof n&&(u[f]=E.join(", "),u[h]=r+"s",u[d]=a+"s",u[p]=i||"linear")}return j=function(e){if("undefined"!=typeof e){if(e.target!==e.currentTarget)return;t(e.target).unbind(S,j)}else t(this).unbind(S,j);C=!0,t(this).css(x),o&&o.call(this)},r>0&&(this.bind(S,j),setTimeout(function(){C||j.call(T)},1e3*r+25)),this.size()&&this.get(0).clientLeft,this.css(u),0>=r&&setTimeout(function(){T.each(function(){j.call(this)})},0),this},u=null}(Zepto);define("util",[],function(t,e,n){var p,r=Array.prototype,i=r.slice,o=r.concat,a=navigator.userAgent,s=a.match(/(iPhone|iPad|iPod).*OS\s([\d_]+)/i),u=a.match(/MSIE (\d+)/i),c=a.match(/(Android);?[\s\/]+([\d\.]+)?/),l=!!c,f=0,h=Object.keys,d=Object.prototype.hasOwnProperty;s?p=s[2].split("_"):c?p=c[2].split("."):u&&(p=u[1].split("."));var g=function(t,e){var n="0000000000000000"+t;return n.substr(n.length-(e||2))},v={isInApp:/SLApp/.test(a),ios:!!s,ie:!!u,android:l,osVersion:p?parseFloat(p[0]+"."+p[1]):0,isInWechat:/micromessenger/i.test(navigator.userAgent),combinePath:function(){for(var t=[].slice.apply(arguments),e=t.join("/").replace(/[\\]+/g,"/").replace(/([^\:\/]|^)[\/]{2,}/g,"$1/").replace(/([^\.]|^)\.\//g,"$1"),n=!0;n;)n=!1,e=e.replace(/([^\/]+)\/\.\.(\/|$)/g,function(t,e){return".."==e?t:(n||(n=!0),"")});return e.replace(/\/$/,"")},guid:function(){return++f},isFalse:function(t){return!t||$.isArray(t)&&!t.length||"object"==typeof t&&v.isEmptyObject(t)},isTrue:function(t){return!this.isFalse(t)},isEmptyObject:function(t){for(var e in t)return!1;return!0},keys:function(t){if(h)return h(t);var e=[];for(var n in t)d.call(t,n)&&e.push(n);return e},extend:function(t){var e=this,n=d.call(t,"constructor")?t.constructor:function(){return e.apply(this,arguments)},r=function(){this.constructor=n};r.prototype=e.prototype,n.prototype=new r;for(var i in t)n.prototype[i]=t[i];for(var i in e)n[i]=e[i];return n.__super__=e.prototype,n},random:function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},log:function(t){this.$log||(this.$log=$('<div style="height:40px;position:fixed;top:0;left:0;right:0;z-index:100000;background:#fff;overflow-y:scroll;word-break:break-all;word-wrap:break-word;"></div>').appendTo("body")),arguments.length>1&&(t+=r.slice.call(arguments,1).join(" ")),this.$log.html(t+"<br>"+this.$log.html())},indexOf:function(t,e){for(var n="function"==typeof e,r=t.length,i=0;r>i;i++)if(n?e(t[i],i):t[i]==e)return i;return-1},lastIndexOf:function(t,e){for(var n="function"==typeof e,r=t.length-1;r>=0;r--)if(n?e(t[r],r):t[r]==e)return r;return-1},first:function(t,e){for(var n,r=0,i=t.length;i>r;r++)if(n=t[r],e(n,r))return n;return null},find:function(t,e){for(var r,n=[],i=0,o=t.length;o>i;i++)r=t[i],e(r,i)&&n.push(r);return n},select:function(t,e){for(var n=[],r=t.length,i=0;r>i;i++)n.push(e(t[i],i));return n},pick:function(t,e){var r,n={};if(null==t)return n;if("function"==typeof e)for(r in t){var a=t[r];e(a,r,t)&&(n[r]=a)}else for(var s=o.apply([],i.call(arguments,1)),u=0,c=s.length;c>u;u++)r=s[u],r in t&&(n[r]=t[r]);return n},pad:g,formatMoney:function(t){return(t+"").replace(/(\d{3})+(\.|$)/,function(t,e){return t.replace(/\d{3}/g,function(t){return","+t})}).replace(/^,/,"")},deepValue:function(t,e){"string"==typeof e&&(e=e.split("."));for(var n=0,r=e.length;r>n;n++)t=t[e[n]];return t},format:function(t,e){var n=arguments;return t.replace(/\{(\d+)\}/g,function(t,e){return n[parseInt(e)+1]})},formatDate:function(t,e){if("string"==typeof t&&/^\/Date\(\d+\)\/$/.test(t))t=new Function("return new "+t.replace(/\//g,""))();else if("number"==typeof t)t=new Date(t);else if(!t)return"";var n=t.getFullYear()+"",r=t.getMonth()+1,i=t.getDate(),o=t.getHours(),a=t.getMinutes(),s=t.getSeconds(),u=t.getMilliseconds()+"0000";return(e||"yyyy-MM-dd HH:mm:ss").replace(/\y{4}/,n).replace(/y{2}/,n.substr(2,2)).replace(/M{2}/,g(r)).replace(/M/,r).replace(/d{2,}/,g(i)).replace(/d/,t).replace(/H{2,}/i,g(o)).replace(/H/i,o).replace(/m{2,}/,g(a)).replace(/m/,a).replace(/s{2,}/,g(s)).replace(/s/,s).replace(/f+/,function(t){return u.substr(0,t.length)})},style:function(t){var e=document,n=e.getElementsByTagName("head")[0],r=e.createElement("style");r.type="text/css";try{r.appendChild(e.createTextNode(t))}catch(i){r.styleSheet.cssText=t}return n.appendChild(r),r},currency:function(t,e){return(void 0===e||null===e?"￥":e)+Math.round(100*parseFloat(t))/100},template:function(t,e){var n="var __p=[];var $data=obj||{};with($data){__p.push('"+t.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/<%=([\s\S]+?)%>/g,function(t,e){return"',"+e.replace(/\\'/,"'")+",'"}).replace(/<%([\s\S]+?)%>/g,function(t,e){return"');"+e.replace(/\\'/,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+'\');}return __p.join("");',r=new Function("obj",n);return e?r(e):r},encodeHTML:function(t){return(""+t).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&#34;").split("'").join("&#39;")},getPath:function(t){return t.replace(/^http\:\/\/[^\/]+|\?.*$/g,"").toLowerCase()},cookie:function(t,e,n,r){if("undefined"==typeof e){var i=document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));return null!=i?unescape(i[2]):null}if(null===typeof e){if(e=this.cookie(name),null==e)return;n=-1}if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),n=";expires="+o.toGMTString()}document.cookie=t+"="+escape(e)+(n||"")+";path="+(r||"/")},store:window.localStorage?function(t,e){return"undefined"==typeof e?JSON.parse(localStorage.getItem(t)):void(null===e?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(e)))}:function(){return"undefined"==typeof value?JSON.parse(this.cookie(key)):void(null===value?this.cookie(key,null):this.cookie(key,JSON.stringify(value)))},noop:function(){},circlePoint:function(t,e,n,r){return{x:t+n*Math.cos(r*Math.PI/180),y:e+n*Math.sin(r*Math.PI/180)}},validateEmail:function(t){return/^[-_a-zA-Z0-9\.]+@([-_a-zA-Z0-9]+\.)+[a-zA-Z0-9]{2,3}$/.test(t)},validateMobile:function(t){return/^1[0-9]{10}$/.test(t)}};n.exports=v});define("graphics/matrix2d",[],function(){function t(t,e,n,r,i,o){this.setValues(t,e,n,r,i,o)}var e=t.prototype;return t.DEG_TO_RAD=Math.PI/180,t.identity=null,e.length=6,e.setValues=function(t,e,n,r,i,o){return this[0]=null==t?1:t,this[1]=e||0,this[2]=n||0,this[3]=null==r?1:r,this[4]=i||0,this[5]=o||0,this},e.append=function(t,e,n,r,i,o){var s=this[0],a=this[1],u=this[2],c=this[3];return(1!=t||0!=e||0!=n||1!=r)&&(this[0]=s*t+u*e,this[1]=a*t+c*e,this[2]=s*n+u*r,this[3]=a*n+c*r),this[4]=s*i+u*o+this[4],this[5]=a*i+c*o+this[5],this},e.prepend=function(t,e,n,r,i,o){var s=this[0],a=this[2],u=this[4];return this[0]=t*s+n*this[1],this[1]=e*s+r*this[1],this[2]=t*a+n*this[3],this[3]=e*a+r*this[3],this[4]=t*u+n*this[5]+i,this[5]=e*u+r*this[5]+o,this},e.appendMatrix=function(t){return this.append(t[0],t[1],t[2],t[3],t[4],t[5])},e.prependMatrix=function(t){return this.prepend(t[0],t[1],t[2],t[3],t[4],t[5])},e.appendTransform=function(e,n,r,i,o,s,a,u,c){if(o%360)var l=o*t.DEG_TO_RAD,f=Math.cos(l),h=Math.sin(l);else f=1,h=0;return s||a?(s*=t.DEG_TO_RAD,a*=t.DEG_TO_RAD,this.append(Math.cos(a),Math.sin(a),-Math.sin(s),Math.cos(s),e,n),this.append(f*r,h*r,-h*i,f*i,0,0)):this.append(f*r,h*r,-h*i,f*i,e,n),(u||c)&&(this[4]-=u*this[0]+c*this[2],this[5]-=u*this[1]+c*this[3]),this},e.prependTransform=function(e,n,r,i,o,s,a,u,c){if(o%360)var l=o*t.DEG_TO_RAD,f=Math.cos(l),h=Math.sin(l);else f=1,h=0;return(u||c)&&(this[4]-=u,this[5]-=c),s||a?(s*=t.DEG_TO_RAD,a*=t.DEG_TO_RAD,this.prepend(f*r,h*r,-h*i,f*i,0,0),this.prepend(Math.cos(a),Math.sin(a),-Math.sin(s),Math.cos(s),e,n)):this.prepend(f*r,h*r,-h*i,f*i,e,n),this},e.rotate=function(e){e*=t.DEG_TO_RAD;var n=Math.cos(e),r=Math.sin(e),i=this[0],o=this[1];return this[0]=i*n+this[2]*r,this[1]=o*n+this[3]*r,this[2]=-i*r+this[2]*n,this[3]=-o*r+this[3]*n,this},e.skew=function(e,n){return e*=t.DEG_TO_RAD,n*=t.DEG_TO_RAD,this.append(Math.cos(n),Math.sin(n),-Math.sin(e),Math.cos(e),0,0),this},e.scale=function(t,e){return this[0]*=t,this[1]*=t,this[2]*=e,this[3]*=e,this},e.translate=function(t,e){return this[4]+=this[0]*t+this[2]*e,this[5]+=this[1]*t+this[3]*e,this},e.identity=function(){return this[0]=this[3]=1,this[1]=this[2]=this[4]=this[5]=0,this},e.invert=function(){var t=this[0],e=this[1],n=this[2],r=this[3],i=this[4],o=t*r-e*n;return this[0]=r/o,this[1]=-e/o,this[2]=-n/o,this[3]=t/o,this[4]=(n*this[5]-r*i)/o,this[5]=-(t*this[5]-e*i)/o,this},e.isIdentity=function(){return 0===this[4]&&0===this[5]&&1===this[0]&&0===this[1]&&0===this[2]&&1===this[3]},e.equals=function(t){return this[4]===t[4]&&this[5]===t[5]&&this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]&&this[3]===t[3]},e.transformPoint=function(t,e,n){return n=n||{},n.x=t*this[0]+e*this[2]+this[4],n.y=t*this[1]+e*this[3]+this[5],n},e.decompose=function(e){null==e&&(e={}),e.x=this[4],e.y=this[5],e.scaleX=Math.sqrt(this[0]*this[0]+this[1]*this[1]),e.scaleY=Math.sqrt(this[2]*this[2]+this[3]*this[3]);var n=Math.atan2(-this[2],this[3]),r=Math.atan2(this[1],this[0]),i=Math.abs(1-n/r);return 1e-5>i?(e.rotation=r/t.DEG_TO_RAD,this[0]<0&&this[3]>=0&&(e.rotation+=e.rotation<=0?180:-180),e.skewX=e.skewY=0):(e.skewX=n/t.DEG_TO_RAD,e.skewY=r/t.DEG_TO_RAD),e},e.copy=function(t){return this.setValues(t[0],t[1],t[2],t[3],t[4],t[5])},e.clone=function(){return new t(this[0],this[1],this[2],this[3],this[4],this[5])},e.toString=function(){return"matrix("+this[0]+","+this[1]+","+this[2]+","+this[3]+","+this[4]+","+this[5]+")"},t});define("graphics/tween",[],function(t,e,n){var r={linear:function(t,e,n,r){return n*t/r+e},ease:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},easeIn:function(t,e,n,r){return n*(t/=r)*t+e},easeOut:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},easeInOut:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){return n*(t/=r)*t*t+e},easeOutCubic:function(t,e,n,r){return n*((t=t/r-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,r){return n*(t/=r)*t*t*t+e},easeOutQuart:function(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,r){return n*(t/=r)*t*t*t*t+e},easeOutQuint:function(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,r){return n*Math.sin(t/r*(Math.PI/2))+e},easeInOutSine:function(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e},easeInExpo:function(t,e,n,r){return 0==t?e:n*Math.pow(2,10*(t/r-1))+e},easeOutExpo:function(t,e,n,r){return t==r?e+n:n*(-Math.pow(2,-10*t/r)+1)+e},easeInOutExpo:function(t,e,n,r){return 0==t?e:t==r?e+n:(t/=r/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(-Math.pow(2,-10*--t)+2)+e},easeInCirc:function(t,e,n,r){return-n*(Math.sqrt(1-(t/=r)*t)-1)+e},easeOutCirc:function(t,e,n,r){return n*Math.sqrt(1-(t=t/r-1)*t)+e},easeInOutCirc:function(t,e,n,r){return(t/=r/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,r,i,o){if(0==t)return e;if(1==(t/=r))return e+n;if(o||(o=.3*r),!i||i<Math.abs(n)){i=n;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(n/i);return-(i*Math.pow(2,10*(t-=1))*Math.sin((t*r-s)*(2*Math.PI)/o))+e},easeOutElastic:function(t,e,n,r,i,o){if(0==t)return e;if(1==(t/=r))return e+n;if(o||(o=.3*r),!i||i<Math.abs(n)){i=n;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(n/i);return i*Math.pow(2,-10*t)*Math.sin((t*r-s)*(2*Math.PI)/o)+n+e},easeInOutElastic:function(t,e,n,r,i,o){if(0==t)return e;if(2==(t/=r/2))return e+n;if(o||(o=r*(.3*1.5)),!i||i<Math.abs(n)){i=n;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(n/i);return 1>t?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t*r-s)*(2*Math.PI)/o))+e:i*Math.pow(2,-10*(t-=1))*Math.sin((t*r-s)*(2*Math.PI)/o)*.5+n+e},easeInBack:function(t,e,n,r,i){return void 0==i&&(i=1.70158),n*(t/=r)*t*((i+1)*t-i)+e},easeOutBack:function(t,e,n,r,i){return void 0==i&&(i=1.70158),n*((t=t/r-1)*t*((i+1)*t+i)+1)+e},easeInOutBack:function(t,e,n,r,i){return void 0==i&&(i=1.70158),(t/=r/2)<1?n/2*(t*t*(((i*=1.525)+1)*t-i))+e:n/2*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)+e},easeInBounce:function(t,e,n,i){return n-r.Bounce.easeOut(i-t,0,n,i)+e},easeOutBounce:function(t,e,n,r){return(t/=r)<1/2.75?n*(7.5625*t*t)+e:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,n,i){return i/2>t?.5*r.easeInOutBounce(2*t,0,n,i)+e:.5*r.easeInOutBounce(2*t-i,0,n,i)+.5*n+e}};n.exports=r});define("core/base",[],function(t,e,n){Object.create||(Object.create=function(t){var e=function(){};return e.prototype=t,new e}),Date.now||(Date.now=function(){return+new Date}),window.sl=window.slan={},n.exports=sl});define("core/promise",["./linklist"],function(t,e,n){var r=t("./linklist"),i=Array.prototype.slice,s=/^\$(\d+)$/,o=function(t,e,n){for(var a,r=[],i=0,o=t.length;o>i;i++)a=t[i],r.push("string"==typeof a?s.test(a)?e[parseInt(a.match(s)[1])]:a.replace(/^\$\$/,"$"):a);return r.push(n),r},a=function(t,e,n){if(!(this instanceof a))return new a(t,e,n);var i=this;this.queue=new r,this.state=2,this.resolveSelf=function(){i.resolve.apply(i,arguments)},e||"number"!=typeof t?t&&(this.state=0,this.then(t,e,n)):(this.state=0,this.start(t))};a.prototype={reject:function(t){this.resolve(t||"unknow error",null)},resolve:function(){var r,s,o,t=this,e=i.call(arguments),n=t.queue.shift();if(n)if(t.state=1,r=n[0],s=n[1],r instanceof a)r.then(t.resolveSelf);else if("function"==typeof r)o=r.apply(s,e),o instanceof a?o!==t&&o.then(t.resolveSelf):o instanceof Error?t.reject(o):t.resolve(null,o);else if(r instanceof Array)for(var u=[],c=[],l=0,f=0,h=r.length;h>f;f++)!function(n,r,i){"function"==typeof n&&(n=n.apply(s,e)),n instanceof a?n.then(function(e,n){e&&(u[r]=e),l++,c[r]=n,l>=i&&t.resolve(u,c)}):(l++,c[r]=n,l>=i&&t.resolve(null,c))}(r[f],f,h);else t.resolve(null,e);else t.state=0;return t},when:function(t,e){return t instanceof Array||(t=[t]),this.queue.append([t,e||this]),1!=this.state&&this.resolve(),this},map:function(t,e,n){var r=this,i=function(){var n=arguments;return r._count=t.length,r.result=[],r.errors=[],t.forEach(function(t,i){t instanceof Array||(t=[t]),e.apply(this,o(t,n,function(t,e){r.next(i,t,e)}))}),r};return r.queue.append([i,n||this]),r},each:function(t,e,n){var r=this,i=function(){return r._count=t.length,r.result=[],r.errors=[],t.forEach(function(t,n){e.apply(this,[n,t])}),r};return r.queue.append([i,n||this]),r},start:function(t){var e=this,n=function(){return e._count=t,e.result=[],e.errors=[],e};return e.queue.append([n,this]),e},next:function(t,e,n){this._count--,e&&(this.errors[t]=e),this.result[t]=n,this._count<=0&&this.resolve(this.errors.length?this.errors:null,this.result)},bind:function(t){var e=this;return function(){e.then(i.call(arguments),t,this)}},then:function(t,e,n){var i,r=this;return t instanceof Array?(i=e,e=function(){return i.apply(this,o(t,arguments,r.resolveSelf)),r}):(n=e,e=t,t=null),r.queue.append([e,n||this]),r.state||r.resolve(),r}},a.resolve=function(){return(new a).resolve()},n.exports=a});define("core/linklist",[],function(t,e,n){var r=function(){this._idlePrev=this,this._idleNext=this},i=function(t){return t._idlePrev==t?null:t._idlePrev},s=function(t){t._idleNext&&(t._idleNext._idlePrev=t._idlePrev),t._idlePrev&&(t._idlePrev._idleNext=t._idleNext),t._idleNext=null,t._idlePrev=null};r.prototype={length:0,init:function(t){t={data:t},this.list=t,this.length=1,t._idleNext=t,t._idlePrev=t},get:function(t){var e=null;return this.each(function(n){return t(n)===!0?(e=n,!1):void 0}),e},find:function(t){var e=[];return this.each(function(n){t(n)===!0&&e.push(n)}),e},first:function(){return this._idlePrev!=this?this._idlePrev.data:null},peek:function(){return this._idlePrev==this?null:this._idlePrev},each:function(t){for(var n,e=this._idlePrev;e!=this&&(n=e._idlePrev,t.call(e,e.data)!==!1);)e=n},next:i,append:function(t,e){return e||(t={data:t}),t._idleNext=this._idleNext,this._idleNext._idlePrev=t,t._idlePrev=this,this._idleNext=t,this.length++,t},contains:function(t){var e=!1;return this.each(function(n){return t===n?(e=!0,!1):void 0}),e},shift:function(){var t=this._idlePrev;return t!=this?(this._remove(t),t.data):null},_remove:function(t){0!=this.length&&(this.length--,s(t))},remove:function(t){var e=this;e.each(function(n){return n===t?(e._remove(this),!1):void 0})},isEmpty:function(){return this._idlePrev==this}},n.exports=r});define("core/event",["$","./base"],function(t,e,n){function c(t,e,n){(t||"").split(o).forEach(function(t){n(t,e)})}function l(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function f(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function h(t,e,n,r){var i,s;return s=f(e),s.ns&&(i=l(s.ns)),t.filter(function(t){return t&&(!s.e||t.e===s.e)&&(!s.ns||i.test(t.ns))&&(!n||t.cb===n||t.cb._cb===n)&&(!r||t.ctx===r)})}function p(t,e){return this instanceof p?(e&&r.extend(this,e),this.type=t,this):new p(t,e)}var r=t("$"),i=t("./base"),s=[].slice,o=/\s+/,a=function(){return!1},u=function(){return!0};return p.prototype={isDefaultPrevented:a,isPropagationStopped:a,preventDefault:function(){this.isDefaultPrevented=u},stopPropagation:function(){this.isPropagationStopped=u}},i.event={createEvent:p,on:function(t,e,n){var i,r=this;return e?(i=this._events||(this._events=[]),c(t,e,function(t,e){var s=f(t);s.cb=e,s.ctx=n,s.ctx2=n||r,s.id=i.length,i.push(s)}),this):this},one:function(t,e,n){var r=this;return e?(c(t,e,function(t,e){var i=function(){return r.off(t,i),e.apply(n||r,arguments)};i._cb=e,r.on(t,i,n)}),this):this},off:function(t,e,n){var r=this._events;return r?t||e||n?(c(t,e,function(t,e){h(r,t,e,n).forEach(function(t){delete r[t.id]})}),this):(this._events=[],this):this},trigger:function(t){var n,r,i,o,a,e=-1;if(!this._events||!t)return this;if("string"==typeof t&&(t=new p(t)),n=s.call(arguments,1),t.args=n,n.unshift(t),r=h(this._events,t.type))for(o=r.length;++e<o;)if((i=t.isPropagationStopped())||!1===(a=r[e]).cb.apply(a.ctx2,n)){i||(t.stopPropagation(),t.preventDefault());break}return this}},i.Event=p,i.event});define("core/component",["$","util","./event"],function(t,e,n){var r=t("$"),i=t("util"),s=t("./event"),o=Array.prototype.slice,a=function(t){var e=this;e.options=r.extend({},e.options,t),e.options.className&&(e.className=e.options.className),e.options.el&&(e.el=e.options.el),e.cid=i.guid(),e.setElement(e.el),e.onDestroy&&e.on("Destroy",e.onDestroy)};a.prototype=r.extend({},s,{options:{},setElement:function(t,e){return t&&(this.$el&&this.undelegateEvents(),this.$el=r(t),this.el=this.$el[0],this.className&&this.$el.addClass(this.className),e!==!1&&this.delegateEvents()),this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},delegateEvents:function(){return this.listen(this.events),this.listen(this.options.events),this},listen:function(t,e){var n=this;if(e){var s=t.split(" "),o=s.shift().replace(/,/g,".delegateEvents"+n.cid+" ");e=r.proxy(r.isFunction(e)?e:n[e],n),s.length>0&&""!==s[0]?n.$el.on(o,s.join(" "),e):n.$el.on(o,e)}else for(var i in t)n.listen(i,t[i]);return n},listenTo:function(t){var e=o.apply(arguments),n=e[e.length-1];return"function"!=typeof t.on&&(t=r(t)),e[0]=t,e[e.length-1]=r.proxy(n,this),(this._bindListenTo||(this._bindListenTo=[])).push(e.slice()),e.shift().on.apply(t,e),this},$:function(t){return this.$el.filter(t).add(this.$el.find(t))},destroy:function(){var n,e=(this.$el,this);this._bindListenTo&&r.each(this._bindListenTo,function(t,e){n=e.shift(),n.off.apply(n,e)}),e.undelegateEvents(),e.$el.remove(),e.trigger("Destroy")}}),a.extend=i.extend,n.exports=a});define("core/view",["$","util","./component"],function(t,e,n){var r=t("$"),i=t("util"),s=t("./component"),o=Array.prototype.slice,a=function(){var e,t=this,n=o.call(arguments),i=n[0];r.isPlainObject(i)?e=i:(e=n[1]||{},e.el=n.shift()),s.apply(this,n),t.initialize.apply(t,n),t.options.initialize&&t.options.initialize.apply(t,n)};a.prototype=r.extend({},s.prototype),a.extend=function(t){var e=i.extend.call(this,t);return e.prototype.events=r.extend({},e.__super__.events,e.prototype.events),e},n.exports=a});define("core/model",["$","util","./base","./event"],function(t,e,n){var i=t("$"),r=t("util"),o=(t("./base"),t("./event")),a=Array.prototype.slice,u={date:r.formatDate,isFalse:function(t,e,n){return 1==arguments.length?r.isFalse(t):r.isFalse(t)?e:n},isTrue:function(t,e,n){return 1==arguments.length?r.isTrue(t):r.isTrue(t)?e:n},json:function(t){return t instanceof w||t instanceof A?JSON.stringify(t.data):JSON.stringify(t)},length:function(t){return t instanceof A?t.data.length:t&&t.length||0},join:function(t,e){return t instanceof A?t.data.join(e):t.join(e)},replace:function(t,e,n){return t.replace(e,n)},is:function(t,e){switch(e){case"array":return i.isArray(t);case"object":return i.isPlainObject(t);default:return typeof t==e}},equal:function(t,e,n,i){return 2==arguments.length?t==e:t==e?n:i},eval:function(t,e){for(var n={},i=this._evalCache||(this._evalCache={}),r=i[e]||(i[e]=new Function("$args","with($args){ return "+e+"}")),s=0,o=0,a=arguments.length;a>s;s++)1!=s&&(n["$"+o]=arguments[s],o++);return r.call(this,n)},lt:function(t,e){return e>t},lte:function(t,e){return e>=t},gt:function(t,e){return t>e},gte:function(t,e){return t>=e},choose:function(t,e,n){return t?e:n},or:function(t,e){return t||e},and:function(t,e){return t&&e},not:function(t){return!t},lowercase:function(t){return t.toLowerCase()},uppercase:function(t){return t.toUpperCase()},currency:function(t,e){return(e||"")+Math.round(100*parseFloat(t))/100},concat:function(){return a.call(arguments).join("")},round:function(t){return Math.round(t)},max:Math.max,min:Math.min,mul:function(t,e){return parseFloat(t)*parseFloat(e)},plus:function(t,e){return parseFloat(t)+parseFloat(e)},minus:function(t,e){return parseFloat(t)-parseFloat(e)},format:function(t){var e,n=arguments[1];return 2==arguments.length&&"object"==typeof t?e=t:(e=a.call(arguments),e.splice(1,1)),n.replace(/\{([_a-zA-Z0-9]+)\}/g,function(t,n){return e[n]})},"case":function(t){for(var e=a.call(arguments,1),n=0,i=e.length;i>n;n+=2)if(t==e[n])return e[n+1];return i%2==0?void 0:e[i-1]},listen:function(t,e,n,i,r,s,o){var a;if(i&&(a="_bind_filter"+r.prop+("number"==typeof i?i:"")+"_"+o,!e[a]&&(e[a]=!0)||!i[a]&&(i[a]=!0))){s=s.split(".");var c=s.pop(),l=s.length<=0?t:t.get(s.join("."))||t.set(s.join("."),{}).get(s);l.on("change"+(c?":"+c:""),function(){e._elAttr(i,r.prop,r.filter(u,e,e.data[n]))})}}},c=/\s*\|\s*([a-zA-Z_0-9]+)((?:\s*(?:\:|;)\s*\({0,1}\s*([a-zA-Z_0-9\.-]+|'(?:\\'|[^'])*')\){0,1})*)/g,l=/\s*\:\s*([a-zA-Z_0-9\.-]+|'(?:\\'|[^'])*')/g,h=/^((-)*\d+|true|false|undefined|null|'(?:\\'|[^'])*')$/,f=function(t,e){var o,a,u,n="",i="var S=this;",r=0,s=0;return t.replace(c,function(t,c,f){n+="V=F."+c+"(V",f.replace(l,function(t,c){var l;h.test(c)?l=c:(o=c.split("."),a=o.shift(),!e||a!=e.alias&&!(u=e.modelAlias[a])?(l="M.root.data."+c,i+='if(E)F.listen(M.root,M,K,E,S,"'+c+'",'+r++ +");"):c==e.alias?(l="M.data",i+="if(E)F.listen(M.parent,M,K,E,S,M._key,"+r++ +");"):(a==e.alias&&(u=e.collectionName),c=o.join("."),l="A"+s++,i+="var "+l+';var P=M;while(P){if(P.key=="'+u+'^child"){if(E)F.listen(P,M,K,E,S,"'+c+'",'+r++ +");"+l+"=P.data."+c+";break;}P=P.parent.parent;}")),n+=","+l}),n+=");"}),n+="return V;",new Function("F","M","V","K","E",i+n)},p=function(t,e){return t.filter(e).add(t.find(e))},d=function(t,e){var n=e.split("."),i=n.shift();if(i==t.alias)return{collection:t.collectionName,variable:n.join(".")};var r=t.modelAlias[i];return r?{collection:r,variable:n.join(".")}:void 0},v=function(t){var e={isExp:"="==t[0],args:[]};return e.isExp?e.args.push(t.substr(1)):t.replace(l,function(t,n){e.args.push(n)}),e},g=/([a-zA-Z_0-9]+)(?:\s*,(\s*[a-zA-Z_0-9]+)){0,1}\s+in\s+([a-zA-Z_0-9]+(?:\.[a-zA-Z_0-9]+){0,})((?:\s*\|\s*filter\s*\:\s*.+?){0,1})(?:\s*\|\s*orderBy\:(.+)){0,1}(\s|$)/g,m=/\b([a-zA-Z_0-9-\.]+)\s*\:\s*([a-zA-Z_0-9]+)((?:\.[a-zA-Z_0-9]+)*)((?:\s*\|\s*[a-zA-Z_0-9]+(?:\s*\:\s*\({0,1}\s*(?:[a-zA-Z_0-9\.-]+|'(?:\\'|[^'])*')\){0,1})*)*)(\s|,|$)/g,y=/\b([a-zA-Z\s]+)\s*\:\s*([a-zA-Z_0-9]+)((?:\.[a-zA-Z_0-9]+)*)((?:\s*\:\s*(?:[a-zA-Z_0-9\.]+|'(?:\\'|[^'])*'))*|\s*=\s*(?:[a-zA-Z_0-9\.]+|'(?:\\'|[^'])*'))(\s|,|$)/g,b=function(t){this.count=0,this.repeats={},this.bindings={},this.events=[],this.eventNames=[],this.eventid=0,this.scan(t)};b.prototype.scan=function(t){var a,n=this.repeats,r=this.bindings,s=this.events,o=this.eventNames,u=this.count,c=this.eventid;p(t,"[sn-repeat]").each(function(){var t=i(this),e=this,r=this.getAttribute("sn-repeat"),s=t.parents("[sn-repeat-alias]"),o={},u={};s.each(function(){var t=this.getAttribute("sn-repeat-name");o[this.getAttribute("sn-repeat-alias")]=t;var e=this.snIndexAlias;e&&(u[e]=t)}),r.replace(g,function(t,i,r,s,c,l){var p,h=s.split("."),f=h.length;1!==f&&(p=o[h[0]],p&&(h[0]=p+"^child",s=h.join("."))),e.setAttribute("sn-repeat-alias",i),e.setAttribute("sn-repeat-name",s),r&&(e.snIndexAlias=r,u[r]=s);var d=document.createElement("script");d.setAttribute("type","text/placeholder");var v,g={loopIndexAlias:u,collectionName:s,alias:i,modelAlias:o,template:e};c&&(g.filter=c),l&&(g.orderBy=l),-1==s.indexOf(".")&&(g.placeHolder=d),a=n[s],a?v=s+"_"+a.push(g):(n[s]=[g],v=s+"_1"),g.placeHolderName=v,d.setAttribute("sn-placeholder",v),e.parentNode.insertBefore(d,e)})}).remove();for(var h in n)for(var b=n[h],x=0,w=b.length;w>x;x++){var _=b[x],E=i(_.template);p(E,"[sn-binding],[sn-model],[sn-on]").each(function(){var t=this,e=this.getAttribute("sn-binding"),n=this.getAttribute("sn-model"),a=this.getAttribute("sn-on");if(t.setAttribute("sn-id",++u),n&&(n=d(_,n),n&&(this.setAttribute("sn-collection",n.collection),this.setAttribute("sn-model",n.variable))),a){this.setAttribute("sn-on",c);var p=s[c];a.replace(y,function(t,e,n,r,a){-1==o.indexOf(e)&&(o[o.length]=e),p||(p=s[c]={});var u=n+r;p[e]=i.extend(v(a),{name:d(_,u)||u,repeat:_})}),c++}e&&e.replace(m,function(t,e,n,i,s){var o;n==_.alias?n=_.collectionName+"^child"+i:_.loopIndexAlias&&_.loopIndexAlias[n]?n=_.loopIndexAlias[n]+"^child.^"+n:(o=_.modelAlias[n])&&(n=o+"^child"+i),(r[n]||(r[n]=[])).push({el:u,prop:s?{prop:e,filter:f(s,_)}:e})})})}p(t,"[sn-binding],[sn-on]").each(function(){var t=this.getAttribute("sn-binding"),e=this.getAttribute("sn-on"),n=this;if(t&&t.replace(m,function(t,e,i,s,o){i+=s,(r[i]||(r[i]=[])).push({el:n,prop:o?{prop:e,filter:f(o)}:e})}),e){this.setAttribute("sn-on",c);var a=s[c];e.replace(y,function(t,e,n,r,u){-1==o.indexOf(e)&&(o[o.length]=e),a||(a=s[c]={}),a[e]=i.extend(v(u),{name:n+r})}),c++}})};var x=function(t,e,n){if(0==e.indexOf("style."))t.style[e.substr(6)]=n;else switch(e){case"text":t.innerHTML=r.encodeHTML(n);break;case"html":t.innerHTML=n;break;case"display":t.style.display=r.isFalse(n)?"none":"block"==n||"inline"==n||"inline-block"==n||"none"==n||"-webkit-box"==n?n:"";break;case"value":t.value!=n&&(t.value=n);break;case"style":i(t).css(n);break;case"class":"undefined"==typeof t.initClassName&&(t.initClassName=t.className||""),t.className=t.initClassName+" "+("string"!=typeof n&&n?u.join(n," "):n);break;default:null===n||void 0===n?t.removeAttribute(e):t.setAttribute(e,n)}},w=function(t,e,n,i){if(4==arguments.length&&!this.created){var r={};if(this.$el=i,this.model=r,this._key=e,this.data={},n instanceof w)this.parent=n,this.key=n.key?n.key+"."+e:e,this.root=n.root;else{if(!(n instanceof A))throw new Error("Model's parent mast be Collection or Model");this.parent=n,this.key=n.key+"^child",this.root=n.root}t&&this.set(t),n.data[e]=this.data,this.created=!0}};w.prototype=Object.create(o),i.extend(w.prototype,{constructor:w,_redraw:function(){var t;for(var e in this.model)t=this.model[e],t instanceof w||t instanceof A?t._redraw():this._syncView(e,t)},_syncView:function(t,e,n){var r,s,o,a,i=this.root.finder.bindings[t&&this.key?this.key+"."+t:this.key||t];if(i)for(var c=0,l=i.length;l>c;c++)r=i[c],s=r.el,o=r.prop,"string"!=typeof o?(a=o.filter(u,this,e,t,s),o=o.prop):a=e,this._elAttr(s,o,a,n);return this},_syncOwnView:function(){return this.root!=this&&(this._syncView("",this.data),this.created&&this.parent instanceof w&&this.parent.trigger("change:"+this._key,this.data),this.parent.shouldUpdateView&&this.parent._syncOwnView()),this},_elAttr:function(t,e,n,i){"number"==typeof t?p(i||this.$el,'[sn-id="'+t+'"]').each(function(){x(this,e,n)}):x(t,e,n)},get:function(t){if("string"==typeof t&&-1!=t.indexOf(".")&&(t=t.split(".")),i.isArray(t)){for(var e=this,n=0,r=t.length;r>n;n++)if(e instanceof w)e=e.model[t[n]];else{if(!(e instanceof A))return null;e=e.models[t[n]]}return e}return this.model[t]},dirty:function(){var t,e={};for(var n in this.data)t=this.data[n],this.originalData[n]!=t&&(e[n]=t);return e},set:function(t,e){var r,s,o,n=this,a=this.model;if(n.shouldUpdateView=!1,i.isPlainObject(t))o=t;else{if("undefined"==typeof e)return e=t,t="",console.log(this,t,e),this.parent&&this.parent instanceof A&&(this.parent.data[this.parent.models.indexOf(this)]=e),this.data=e,void this._syncOwnView();(o={})[t]=e}this.originalData||(this.originalData=o);var l,u=[],c=[],s=!1,h=[];for(var f in o)this.data[f]=o[f];for(var f in o)if(r=a[f],l=o[f],r!==l){var p=f.split(".");if(p.length>1){t=p.pop(),a=this;for(var g,d=0,v=p.length;v>d;d++)if(f=p[d],g=a,a instanceof w)a=a.model[f],a||(a=g.model[f]=new w(null,f,g,g.$el),g.data[f]=a.data);else if(a instanceof A&&(a=a.models[f],!a))throw new Error("[Collection index is bigger than length!]");a.set(t,l)}else if(r instanceof w)null===l||void 0===l?r.clear():r.set(l);else if(r instanceof A){if(!i.isArray(l)){if(null!=l)throw new Error("[Array to "+typeof l+" error]不可改变"+f+"的数据类型");l=[]}r.set(l)}else i.isPlainObject(l)?c.push(a[f]=new w(null,f,this,this.$el),l):i.isArray(l)?(a[f]=new A,u.push(f)):(this.data[f]=l,a[f]=l,this.created&&(this.trigger("change:"+f,l),this!=this.root&&this.root.trigger("change:"+(this.key?this.key+"."+f:f),this,f,l)));h.push(f,l),s||(s=!0)}for(var d=0,v=c.length;v>d;d+=2)c[d].set(c[d+1]);for(var d=0,v=u.length;v>d;d++)t=u[d],a[t].constructor(this.data[t],t,this);if(s){this.root!=this&&this._syncOwnView();for(var d=0,v=h.length;v>d;d+=2)this._syncView(h[d],h[d+1])}return n.shouldUpdateView=!0,this},clear:function(){var t={};for(var e in this.data)t[e]=null;this.set(t)},toJSON:function(){return i.extend(!0,{},this.data)}});var _={contains:function(t,e){return-1!=t.indexOf(e)}},E=function(t,e){var n=this;if(this.list=[],this.collection=t,i.extend(this,e),this.selector='[sn-placeholder="'+this.placeHolderName+'"]',!this.placeHolder&&this.collection.parent.$el&&(this.placeHolder=this.collection.parent.$el.find(this.selector)[0]),this.isInCollection=!i.contains(document.body,this.placeHolder),this.filter){var r="{";for(var s in this.modelAlias){var o=this.modelAlias[s];r+=s+":model.parent.parent";for(var a=t.parent;a&&a.key!=o+"^child";)a=a.parent,r+=".parent";r+=".data,"}r+=this.alias+":model.data}";var u="var self=this,collection=this.collection;with($.extend({},collection.root.data,"+r+",filter)){",c=this.filter.replace(/^\s*\|\s*filter\s*\:/,"");u+="return "+c,u+="}",this.filter=new Function("filter","model",u);for(var l=c.split(/[\=\>\<\?\s\:\(\),]+/g),f=0,p=l.length;p>f;f++)if(!h.test(l[f])){var a,d=l[f].split("."),v=d[0];if(!v||_[v])continue;if(v==this.alias)d[0]=t.key+"^child";else{var o=this.modelAlias[v];o&&(d[0]=o+"^child")}t.root.on("change:"+d.join("."),function(){n.update()})}}};E.prototype={update:function(){var t=document.createDocumentFragment(),e=0,n=this.list,r=this.orderBy;r&&n.sort(function(t,e){return t=t.model.data[r],e=e.model.data[r],t>e?1:e>t?-1:0});for(var s=0,o=n.length;o>s;s++){var a=n[s];if(!this.filter||this.filter(_,a.model)){t.appendChild(a.el);var u=this.template.snIndexAlias;u&&a.model._syncView("^"+u,e,i(a.el).attr("sn-index-"+u,e)),e++}else a.el.parentNode&&a.el.parentNode.removeChild(a.el)}this.appendChild(t)},get:function(t){for(var e=this.list.length-1;e>=0;e--)if(this.list[e].model==t)return this.list[e]},add:function(t,e){this.list.push({model:t,el:e})},appendChild:function(t){this.isInCollection?this.collection.parent.$el.find(this.selector).add(this.placeHolder).before(t):this.placeHolder.parentNode.insertBefore(t,this.placeHolder)},clear:function(){for(var t=this.list.length-1;t>=0;t--)this.list[t].el.parentNode.removeChild(this.list[t].el);this.list.length=0},remove:function(t){for(var e=this.list.length-1;e>=0;e--)if(this.list[e].model==t){this.list[e].el.parentNode.removeChild(this.list[e].el),this.list.splice(e,1);break}}};var A=function(t,e,n){if(3==arguments.length){this.models=[],this.data=[],this.key=e,this._key=e,this.repeats=[],this.parent=n,n.key&&(this.key=n.key+"."+this.key),this.root=n.root;var i=this.root.finder.repeats[this.key];if(i)for(var s=0,o=i.length;o>s;s++)this.repeats.push(new E(this,i[s]));t&&this.set(t)}};A.prototype={constructor:A,model:w,forEach:function(t){for(var e,i=0,r=this.models.length;r>i;i++)e=this.models[i],t.call(this,e,i)},_redraw:function(){for(var t=0,e=this.models.length;e>t;t++){model=this.models[t];for(var n,t=0,e=this.repeats.length;e>t;t++)if(n=this.repeats[t],!n.get(model)){var r=item.template.cloneNode(!0);i(r);r.snModel=model,n.add(model,r),model.$el.push(r),n.update()}model._redraw()}},add:function(t){var e,n;this.shouldUpdateView=!1,i.isArray(t)||(t=[t]);for(var s=0,o=t.length;o>s;s++){var a=null,u=t[s];e=new this.model,n=this.data.length,this.models[n]=e,this.data[n]=u;for(var c=0,l=this.repeats.length;l>c;c++){var h=this.repeats[c],f=h.template.cloneNode(!0),p=i(f);f.snModel=e,h.add(e,f),a=a?a.add(p):p}e.constructor(u,n,this,a)}for(var s=0,l=this.repeats.length;l>s;s++)this.repeats[s].update();this._syncOwnView(),this.shouldUpdateView=!0},_syncOwnView:function(){return this.parent._syncView(this._key,this.data),this.created&&this.parent.trigger("change:"+this._key,this.data),this.parent.shouldUpdateView&&this.parent._syncOwnView(),this},set:function(t){this.data.length=0;for(var e=0,n=this.repeats.length;n>e;e++)this.repeats[e].clear();return this.add(t),this},get:function(t){return this.models[t]},remove:function(t){var e,n;"number"!=typeof t&&(t=this.models.indexOf(t));for(var i=0,r=this.repeats.length;r>i;i++)e=this.repeats[i],n=e.list[t].el,n.parentNode.removeChild(n),e.list.splice(t,1);this.models.splice(t,1),this.data.splice(t,1),this._syncOwnView()}},A.prototype.append=A.prototype.add;var O=function(t,e){return(t.getAttribute("sn-repeat-name")==e?t:i(t).closest('[sn-repeat-name="'+e+'"]')[0]).snModel},M=function(t,e){this.root=this,t&&(this.created||(this.data={},this.events=[],this.model={},this.key="",this.load(t),this.set(e),this.created=!0))};M.prototype=Object.create(w.prototype),i.extend(M.prototype,{constructor:M,load:function(t){return this.finder=new b(t),this.$el=t.on("input change","[sn-model]",i.proxy(this._inputChange,this)),this.bindEvents(),this},handleEvent:function(t){var u,c,l,f,e=t.currentTarget,n=i(e),r=t.type,s=e.getAttribute("sn-on"),o=this.finder.events[s],a=o[r],p=[t];if(a){u=a.name;for(var d=0;d<a.args.length;d++){var v=a.args[d],g=this;if(h.test(v))p.push(window.eval(v));else{if(a.repeat){var b,m=v.split("."),y=m.shift();if(a.repeat.alias==y)g=O(e,a.repeat.collectionName),v=m;else if(a.repeat.modelAlias[y])g=O(e,a.repeat.modelAlias[y]),v=m;else if(b=n.closest("[sn-index-"+v+"]")){p.push(b.attr("sn-index-"+v));continue}}p.push(g.get(v))}}"string"==typeof u?(f=u,c=this):(c=O(e,u.collection),f=u.variable),a.isExp?c.set(f,p[1]):(u=c.get(f),l=f.lastIndexOf("."),u&&u.apply(-1==l?c:c.get(f.substr(0,l)),p))}},bindEvents:function(){for(var e=0,n=this.finder.eventNames.length;n>e;e++){var r=this.finder.eventNames[e];-1==this.events.indexOf(r)&&(this.$el.on(r,"[sn-on]",i.proxy(this.handleEvent,this)),this.events[this.events.length]=r)}},scan:function(t){this.finder.scan(t),this._redraw(),this.bindEvents()},append:function(t,e){e?t=this.$el.find(t):(e=t,t=this.$el),t.append(e),this.scan(e)},prepend:function(t,e){e?t=this.$el.find(t):(e=t,t=this.$el),t.prepend(e),this.scan(e)},before:function(t,e){this.$el.find(t).before(e),this.scan(e)},after:function(t,e){this.$el.find(t).after(e),this.scan(e)},_inputChange:function(t){var e=t.currentTarget,n=e.getAttribute("sn-model"),i=e.getAttribute("sn-collection");i?O(e,i).set(n,e.value):this.set(n,e.value)},destory:function(){this.$el.off("input change","[sn-model]",this._inputChange)}}),M.extend=w.extend=A.extend=r.extend,e.ViewModel=M,e.filter=e.Filter=u});define("core/model2",["$","util","./base","./event","./component"],function(t,e,n){var u,i=t("$"),r=t("util"),o=(t("./base"),t("./event")),a=t("./component"),l=[],c=0,h=["tap","click","change","focus","blur","transition-end"],f=["this","$","Math","new","Date","encodeURIComponent","window","document"],v=/^((-)*\d+|true|false|undefined|null|'(?:\\'|[^'])*')$/,g=/([a-zA-Z_0-9]+)(?:\s*,(\s*[a-zA-Z_0-9]+)){0,1}\s+in\s+([a-zA-Z_0-9]+(?:\.[a-zA-Z_0-9]+){0,})(?:\s*\|\s*filter\s*\:\s*(.+?)){0,1}(?:\s*\|\s*orderBy\:(.+)){0,1}(\s|$)/,m=/\{\{(.+?)\}\}/g,y=/'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/[img]*(?=[\)|\.|,])|\/\/.*|\bvar\s+[_,a-zA-Z0-9]+\s*\=|(^|[\!\=\>\<\?\s\:\(\),\%&\|\+\-\*\/\[\]]+)([\$a-zA-Z_][\$a-zA-Z_0-9]*(?:\.[a-zA-Z_0-9]+)*(?![a-zA-Z_0-9]*\())/g,b=/([a-zA-Z_0-9]+(?:\.[a-zA-Z_0-9]+)*)\s*=\s*((?:\((?:'(?:\\'|[^'])*'|[^\)])+\)|'(?:\\'|[^'])*'|[^;])+?)(?=\;|\,|$)/g,_=/\b(this\.[\.\w]+\()((?:'(?:\\'|[^'])*'|[^\)])*)\)/g,x=function(t,e){var n="var $el=$(el),root=model.root,$data=$.extend({},global,root.data,{$state:root.$state.data}";if(t){n+=",{";for(var i=t.parent,r=t;null!=i;r=i,i=i.parent)n+=i.alias+":"+(r.isChild?"model.closest('"+i.collectionName+"^child').data":'root.upperRepeatEl(el,function(el){ if (el.snRepeat.repeat.alias == "'+i.alias+'") return el.snModel.data; },null)')+",",i.indexAlias&&(n+=i.indexAlias+':function(){ for (var node=el;node!=null;node=node.parentNode) { if (node.snIndexAlias=="'+i.indexAlias+'") return node.snIndex } return ""},');n+=t.alias+":model.data",t.indexAlias&&(n+=","+t.indexAlias+':function(){ for (var node=el;node!=null;node=node.parentNode) { if (node.snIndexAlias=="'+t.indexAlias+'") return node.snIndex }return ""}'),n+="}"}return n+=");with($data){"+e+"}"},w=function(t){for(var e=t.split("."),n=[],i="",r="$state"==e[0]?e.shift():"$data",s=0;s<e.length;s++)n[s]=(0==s?r:n[s-1])+"."+e[s];for(var s=0;s<n.length;s++)i+=(s?"&&":"")+n[s]+"!==null&&"+n[s]+"!==undefined";return"(("+i+")?typeof "+t+'==="function"?'+t+"():"+t+':"")'},E=function(t,e,n){for(var i=t.length?t:[t],r=0,s=i.length;s>r;r++){var o=i[r],a=e(o,r,n);a!==!1&&1==o.nodeType&&o.childNodes.length&&E(o.childNodes,e,a)}},A={contains:function(t,e){return-1!=t.indexOf(e)},like:function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),-1!=t.indexOf(e)||-1!=e.indexOf(t)},util:r},M=function(t,e,n){if(t instanceof M)this.key=t.key?t.key+"."+e:e;else{if(!(t instanceof k))throw new Error("Model's parent mast be Collection or Model");this.key=t.key+"^child"}this.type=i.isPlainObject(n)?"object":"value",t.data[e]=this.data="object"==this.type?i.extend({},n):n,this._key=e,this.model={},this.parent=t,this.root=t.root,this._elements={},this.set(n)},N={getModel:function(t){if("string"==typeof t&&-1!=t.indexOf(".")&&(t=t.split(".")),i.isArray(t)){var e=this;if("this"==t[0]){for(var n=1,r=t.length;r>n;n++)if(!(e=e[t[n]]))return null}else for(var n=0,r=t.length;r>n;n++)if(e instanceof M)e=e.model[t[n]];else{if(!(e instanceof k))return null;e=e.models[t[n]]}return e}return"this"==t?this:""==t?this.data:this.model[t]},get:function(t){var e=this.getModel(t);return e instanceof M||e instanceof k?e.data:e},cover:function(t,e){return this.set(!0,t,e)},set:function(t,e,n){var s,a,u,c,r=this,l=r.model,h=!1;if("boolean"!=typeof t&&(n=e,e=t,t=!1),i.isPlainObject(e))a=e;else if(null===e)!t&&(t=!0),a={};else{if("undefined"==typeof n)return n=e,e="",u=this.parent,u.data[u instanceof k?u.models.indexOf(this):this._key]=n,this.data=n,!this.root._initSet&&this._triggerChangeEvent(this.key),this;if(c=e.split("."),c.length>1){for(var f=c.pop(),d=0,p=c.length;p>d;d++)e=c[d],l=l[e],l instanceof M||(l=l[e]=new M(this,e,{}));return void l.set(t,f,n)}h=t,t=!1,(a={})[e]=n}if(i.isPlainObject(this.data)||(this.data={}),t)for(var v in this.data)void 0===a[v]&&(a[v]=null);i.extend(!0,this.data,a);for(var v in a)if(s=l[v],value=a[v],s!==value)if(s instanceof M)null===value||void 0===value?s.reset():s.set(h,value);else if(s instanceof k){if(!i.isArray(value)){if(null!=value)throw new Error("[Array to "+typeof value+" error]不可改变"+v+"的数据类型");value=[]}s.set(value)}else i.isPlainObject(value)?l[v]=new M(this,v,value):i.isArray(value)?l[v]=new k(this,v,value):(l[v]=value,!this.root._initSet&&this._triggerChangeEvent(this.key?this.key+"/"+v:v));return!this.root._initSet&&this._triggerChangeEvent(this.key),r},_triggerChangeEvent:function(t,e){var n=this;return t="change"+(t?":"+t:"").replace(/\./g,"/"),!e&&(e=this),-1==r.indexOf(l,function(i){return i[0]==n.root&&i[1]==t&&i[2]==e})&&l.push([this.root,t,e]),u||(u=setTimeout(function(){for(var n,i,t=Date.now(),e=[],r=0,s=l.length;s>r;r++)n=l[r],i=n[0],i.trigger(n[1],n[2]),-1===e.indexOf(i)&&e.push(i);l.length=0,u=null,e.forEach(function(t){t.trigger("viewDidUpdate")}),console.log(Date.now()-t)},0)),this},reset:function(){var t={};for(var e in this.data)t[e]=null;this.set(t)},closest:function(t){for(var e,n=this.parent;null!=n;n=n.parent){if(e="function"==typeof t?t(n):n.key==t?1:0)return n;if(e===!1)return null}},contains:function(t,e){for(t=t.parent;null!=t;t=t.parent){if(t==this)return!0;if(e&&t instanceof k)return!1}return!1},under:function(t){for(var e=this.parent;null!=e&&t!=e;e=e.parent)if(e instanceof k)return!1;return!0},_pushNode:function(t,e){var n=t.snElementId||(t.snElementId=++c);(this._elements[n]||(this._elements[n]=[])).push(e)}};N.clear=N.reset,M.prototype=i.extend({},o,N);var O=function(t){i.extend(this,t);var e=this,n=this.collectionName.split("."),r=this.parent;for(this.key=n[n.length-1];r;){if(r.alias==n[0]){n[0]=r.collectionName+"^child",this.collectionName=n.join("."),this.isChild=!0;break}r=r.parent}var s=document.createComment(this.collectionName);s.repeat=this,this.replacement=s,this.el.parentNode.replaceChild(s,this.el),this.snRepeats=[],this.filters&&(this.filter=this.viewModel._compile("{{"+this.filters+"}}",this,function(t,n){for(var r=(Date.now(),n.under()),s=0;s<e.snRepeats.length;s++){var o=e.snRepeats[s];(r||n==o.referenceModel||n.under(o.referenceModel)||n.under(o.collection())||n.contains(o.referenceModel))&&o.update()}}));var o="change:"+this.collectionName.replace(/\./g,"/");this.syncModels=[],this.viewModel.on(o+"/add",function(t,n,i){e.syncModels=e.syncModels.concat(i);for(var r=0;r<e.snRepeats.length;r++){var s=e.snRepeats[r];e.isChild&&n.parent!=s.referenceModel||s.add(i).update()}}).on(o+"/remove",function(t,n,i){for(var r=0;r<i.length;r++){for(var s=i[r],o=e.snRepeats.length-1;o>=0;o--)e.snRepeats[o].remove(function(t){return t.model==s});for(var o=e.syncModels.length-1;o>=0;o--)e.syncModels[o]==s&&e.syncModels.splice(o,1)}})};O.prototype.append=function(t){var e=this,n=new $(this,t.replacement,t.model),i=!1;e.snRepeats.push(n);for(var r=0;r<e.syncModels.length;r++){var s=e.syncModels[r];e.isChild&&s.parent.parent!=n.referenceModel||(n.add(s),i=!0)}i&&n.update()};var $=function(t,e,n){this.replacement=e,this.repeat=t,this.referenceModel=n,e.ownSnRepeat=this,this.elements=[]};$.prototype={collection:function(){return this.referenceModel.model[this.repeat.key]},_removeEl:function(t){E(i(t).remove(),function(t,e){if(t._origin)for(var n=t._origin._elements,e=n.length-1;e>=0;e--)if(n[e]==t){n.splice(e,1);break}})},update:function(){var t=document.createDocumentFragment(),e=this.elements,n=this.repeat,i=n.orderBy,r=this.referenceModel.root,s=this.replacement.parentNode;i&&e.sort(function(t,e){return t=t.model.data[i],e=e.model.data[i],t>e?1:e>t?-1:0});var o,a=[];this.elIndex=0;for(var l=0,u=e.length;u>l;l++){var h,c=e[l];void 0===n.filter||r.call(n.filter,A,c.model,this.replacement)?(h=c.el?c.el:c.el=this.cloneNode(this.el||(this.el=this.cloneNode(n.el)),c.model),o?o.nextSibling!=h&&(o.nextSibling?o.parentNode.insertBefore(h,o.nextSibling):o.parentNode.appendChild(h)):h.parentNode||t.appendChild(h),o=h,n.indexAlias&&h.snIndex!==this.elIndex&&(h.snIndex=this.elIndex,a.push(h)),this.elIndex++):c.el&&c.el.parentNode&&c.el.parentNode.removeChild(c.el)}a.length&&(console.log(a.length),r._triggerChangeEvent(n.collectionName+"/"+n.alias+"/"+n.indexAlias,a)),t.childNodes.length&&s.insertBefore(t,this.replacement)},cloneNode:function(t,e,n,i){var s,r=t.cloneNode(!1);if(t==this.el?(r.snIndex=this.elIndex,r.snIndexAlias=this.repeat.indexAlias,r.snRepeat=this,r.snModel=e,r.snReplacement=this.replacement,i=r):r.snRepeatNode=i,n&&n.appendChild(r),8==t.nodeType&&t.repeat)r.repeat=t.repeat,e&&t.repeat.append({replacement:r,model:e});else if(t.bindings&&(r.bindings=t.bindings,e?((r._origin=t._origin)._elements.push(r),e.root.upperRepeatEl(r,function(e){e.snModel._pushNode(t._origin,r)})._render(r)):r._origin=t),1==t.nodeType&&(s=t.childNodes.length))for(var o=0;s>o;o++)this.cloneNode(t.childNodes[o],e,r,i);return r},each:function(t,e,n){"function"!=typeof e&&(n=e,e=null);for(var i=this.elements.length-1,r=i;r>=0;r--){var s=n?r:i-r;if(t.call(this,s,this.elements[s])===!1)break}return e&&e.call(this),this},remove:function(t,e){var n=this;if("function"==typeof t)for(var i=this.elements.length-1;i>=0;i--){var r=this.elements[i];t(r,i)&&(this.elements.splice(i,1),this._removeEl(r.el))}else this.elements.splice(t,e||1).forEach(function(t){n._removeEl(t.el)});return this},add:function(t){var e=this;return(i.isArray(t)?t:[t]).forEach(function(t){e.elements.push({model:t})}),this},clear:function(){return this.each(function(t,e){el.parentNode.removeChild(e.el)},function(){this.elements.length=0},!0)}};var k=function(t,e,n){this.models=[],this.parent=t,this.key=t.key?t.key+"."+e:e,this._key=e,this.eventName=this.key.replace(/\./g,"/"),this.root=t.root,this.data=[],t.data[e]=this.data,this.add(n)};k.prototype=Object.create(o),k.prototype.each=function(t){for(var e=0;e<this.models.length&&t.call(this,this.models[e],e)!==!1;e++);return this},k.prototype.first=function(t){for(var e=0;e<this.models.length;e++)if(t.call(this,this.data[e],e))return this.models[e];return null},k.prototype.add=function(t){var e,n,r=[];i.isArray(t)||(t=[t]);for(var s=0,o=t.length;o>s;s++){var a=t[s];n=this.models.length,e=new M(this,n,a),this.models.push(e),r.push(e),this.trigger("add",e)}this.root.trigger("change:"+this.eventName+"/add",this,r),this._triggerChangeEvent()},k.prototype._triggerChangeEvent=function(){this._silent||this.root._triggerChangeEvent(this.key,this)._triggerChangeEvent(this.key+"/length",this)},k.prototype.remove=function(t,e){var n;if("function"==typeof t){n=[];for(var i=this.models.length-1;i>=0;i--)t.call(this,this.models[i],i)&&(n.push(this.models.splice(i,1)[0]),this.data.splice(i,1))}else e||(e=1),n=this.models.splice(t,e),this.data.splice(t,e);this._triggerChangeEvent(),this.trigger("remove",n),this.root.trigger("change:"+this.eventName+"/remove",this,n)},k.prototype.clear=function(t){var e=this.models.slice();this.models.length=this.data.length=0,this._triggerChangeEvent(),this.root.trigger("change:"+this.eventName+"/remove",this,e)},k.prototype.set=function(t){if(this._silent=!0,t&&0!=t.length){var e=this.models.length;t.length<e&&this.remove(t.length,e-t.length);var n=0;this.each(function(e){e.set(!0,t[n]),n++}),this.add(0==n?t:t.slice(n,t.length))}else this.clear();return this._silent=!1,this._triggerChangeEvent(),this},k.prototype.get=function(t){return this.models[t]};var C=function(t,e){"undefined"!=typeof e||void 0!=t&&!i.isPlainObject(t)||(e=t,t=this.el),this.cid=r.guid(),this.data=i.extend({},e),this.model={},this.repeats={},this._fns=[],this.fns=[],this.refs={},this.root=this,this._elements={},t&&this.bind(t),this._initSet=!0,this.set(this.data),this._initSet=!1,this.onDestroy&&this.on("Destroy",this.onDestroy),this.initialize.call(this,t,e)};C.prototype=i.extend(Object.create(M.prototype),{key:"",initialize:r.noop,setState:function(t,e,n){return this.$state.set(t,e,n),this},getState:function(t){return this.$state.get(t)},endRender:function(t){return this.one("viewDidUpdate",t)},compile:function(t){var e=this._fns.indexOf(t);return-1==e&&(this._fns.push(t),e=this._fns.length-1),this.fns.length+e},_compile:function(t,e,n){var r,i=this,s="try{return '"+t.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(m,function(t,s){return"'+("+s.replace(/\\\\/g,"\\").replace(/\\'/g,"'").replace(y,function(t,s,o){if(!o)return 0==t.indexOf("var ")?t.replace(/var\s+([^\=]+)=/,function(t,e){return r=(r||[]).concat(e.split(",")),e+"="}):t;var a=o.split("."),l=a[0];if("$state"==l)return i.$state.on("change:"+o.replace("$state.","").replace(/\./g,"/"),n),s+w(o);if(!l||A[l]||-1!=f.indexOf(l)||r&&-1!=r.indexOf(l)||v.test(o))return s+o;var u;if(e)for(var c=e;null!=c;c=c.parent){if(l==c.alias){a[0]=c.collectionName+"^child";break}if(l==c.indexAlias){u=c;break}}var h=u?u.collectionName+"/"+u.alias+"/"+u.indexAlias:a.join("/").replace(/\./g,"/");return i.on("change:"+h,n),s+w(o)})+")+'"})+"';}catch(e){return '';}",o="function(global,model,el){"+x(e,(r&&r.length?"var "+r.join(",")+";":"")+s.replace("return ''+","return ").replace(/\+\'\'/g,""))+"}";return this.compile(o)},call:function(t,e,n,i,r){var s=this.fns[t];switch(arguments.length){case 1:return s.call(this);case 2:return s.call(this,e);case 3:return s.call(this,e,n);case 4:return s.call(this,e,n,i);case 5:return s.call(this,e,n,i,r);default:return s.apply(this,arguments)}},_render:function(t,e){var n=this;if(t.bindings){var i;e?(i={})[e]=t.bindings[e]:i=t.bindings;for(var s in i){var o=n.call(i[s],A,n._closestByEl(t),t);switch(s){case"textContent":t.textContent!==o+""&&(t.textContent=o);break;case"value":"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName?(t.value!=o||""===t.value&&0===o)&&(t.value=o):t.setAttribute(s,o);break;case"html":case"sn-html":t.innerHTML=o;break;case"sn-if":r.isFalse(o)?t.parentNode&&(t.snReplacement||(t.snReplacement=document.createComment("if"),t.parentNode.insertBefore(t.snReplacement,t)),t.parentNode.removeChild(t)):t.parentNode||t.snReplacement.parentNode.insertBefore(t,t.snReplacement);break;case"display":case"sn-display":t.style.display=r.isFalse(o)?"none":"block"==o||"inline"==o||"inline-block"==o?o:"";break;case"sn-style":case"style":t.style.cssText+=o;break;case"checked":case"selected":(t[s]=!!o)?t.setAttribute(s,s):t.removeAttribute(s);break;default:t.setAttribute(s,o)}}}},_renderEls:function(t,e){for(var n=0,i=t&&t.length;i>n;n++)this._render(t[n],e)},_bindAttr:function(t,e,n,r){var o,s=this;m.test(n)&&((t.bindings||(t._elements=[],t.bindings={}))[e]=s._compile(n,r,function(n,a){if(r){if(a instanceof M)o=a==s||a.under()?t._elements:a._elements[t.snElementId],s._renderEls(o);else if(a instanceof k)for(var l=0,u=a.models.length;u>l;l++)o=a.models[l]._elements[t.snElementId],s._renderEls(o);else if(i.isArray(a))for(var c,l=0,u=a.length;u>l;l++)c=a[l],o=c.snModel._elements[t.snElementId],s._renderEls(o)}else s._render(t,e)}))},_closestByEl:function(t){return this.upperRepeatEl(t,function(t){return t.snModel})},_getByEl:function(t,e){var n=this,i=e.split("."),r=i[0];return"this"==r?n:"$state"==r?n.$state:this.upperRepeatEl(t,function(t){return t.snRepeat.repeat.alias==r?t.snModel:void 0})},_getVal:function(t,e){var t=t==this||t instanceof M?t:this._getByEl(t,e);return t.get(t==this?e:e.replace(/^[^\.]+\./,""))},_setByEl:function(t,e,n){var i=this._getByEl(t,e);i.set(i==this||i==self.$state?e:e.replace(/^[^\.]+\./,""),n)},upperRepeatEl:function(t,e,n){for(;t&&(t.snRepeatNode&&(t=t.snRepeatNode),t.snModel&&t.snRepeat);){if(void 0!==(val=e(t)))return val;t=t.snReplacement}return void 0===n?this:n},bind:function(t){var e=this,n=[],r="sn-"+e.cid+"model",s=i(t).on("input change blur","["+r+"]",function(t){var n=t.currentTarget,i=n.getAttribute(r);e._setByEl(n,i,n.value)});e.$el=e.$el?e.$el.add(s):s,E(s,function(t,i,r){if(t.snViewModel)return!1;if(1==t.nodeType){var s=t.getAttribute("sn-repeat");if(null!=s){var o=s.match(g),a=o[3],l=0==a.indexOf("$state")?e.$state:e;s=new O({root:e,viewModel:l,parent:r,alias:o[1],indexAlias:o[2],collectionName:a,filters:o[4],orderBy:o[5],el:t}),(l.repeats[s.collectionName]||(l.repeats[s.collectionName]=[])).push(s),r||s.append({replacement:s.replacement,model:e})}else s=r;for(var u=t.attributes.length-1;u>=0;u--){var c=t.attributes[u].name,f=t.attributes[u].value;if(f)if("sn-error"==c?c="onerror":"sn-src"==c&&(c="src"),"ref"==c)e.refs[f]=t;else if("sn-display"==c||"sn-html"==c||"sn-if"==c||"sn-style"==c||0!=c.indexOf("sn-"))0==c.indexOf("sn-")&&-1==f.indexOf("{{")&&-1==f.indexOf("}}")&&(f="{{"+f+"}}"),e._bindAttr(t,c,f,s);else if("sn-model"==c)t.removeAttribute(c),t.setAttribute("sn-"+e.cid+"model",f);else{var d=c;if(c=c.replace(/^sn-/,""),-1!=h.indexOf(c))if(t.removeAttribute(d),c="sn-"+e.cid+c,b.test(f)||_.test(f)){var p=f.replace(_,function(t,e,n){return e+"e"+(n?",":"")+n+")"}).replace(b,'this._setByEl(e.currentTarget,"$1",$2)'),v="function(e,model,global){var el=e.currentTarget;"+x(s,p)+"}";t.setAttribute(c,e.compile(v))}else t.setAttribute(c,f)}}return!s&&t.bindings&&n.push(t),s}3==t.nodeType&&(e._bindAttr(t,"textContent",t.textContent,r),!r&&t.bindings&&n.push(t))}),s.each(function(){this.snViewModel=e.cid,this.model=e});for(var l,u,o=function(t){var r,s,n=t.currentTarget,i=n.getAttribute("sn-"+e.cid+t.type);if("false"==i)return!1;if(/^\d+$/.test(i)){var o=e._closestByEl(n);o.root===e&&e.call(i,t,o,A)}else{for(var a=[t],u=i.split(":"),c=0;c<u.length;c++){var h=u[c];0==c?(s=e._getByEl(n,h),r=e._getVal(s,h),t.model=e._closestByEl(n,h)):a.push(e._getVal(n,h))}r.apply(s,a)}},a=0;a<h.length;a++)l="transition-end"==h[a]?i.fx.transitionEnd:h[a],u="[sn-"+e.cid+h[a]+"]",s.on(l,u,o).filter(u).on(l,o);this.fns=this.fns.concat(window.eval("["+this._fns.join(",")+"]")),this._fns.length=0;for(var a=0,c=n.length;c>a;a++)e._render(n[a]);return this}},r.pick(a.prototype,["$","undelegateEvents","listenTo","listen","destroy"])),C.extend=r.extend,e.State=C.prototype.$state=new C,e.ViewModel=C,e.Filters=A});define("core/master",["$","util","./view","./route"],function(t,e,n){var r=(t("$"),t("util")),o=(t("./view"),t("./route")),a=r.getPath,l={checkQueryString:function(t,e){t.route.url!=e.url&&(t._setRoute(e),t.trigger("QueryChange"))},mapRoute:function(t,e){return this.route=new o(t,e),this},skip:0,_currentActivity:null,_activities:{},set:function(t,e){this._activities[a(t)]=e},get:function(t,e){var n=this,i="string"==typeof t?n.route.match(t):t;if(i){var r=a(i.path),s=this._activities[r];null==s?!function(t){i["package"]?seajs.use(i["package"]+".js?v"+sl.buildVersion,t):t()}(function(){seajs.use(i.view,function(t){var a,o={application:n,route:i};null!=t?(a=n.$el.find('[data-path="'+i.path+'"]'),a.length&&(o.el=a),s=new t(o),n.set(r,s),s.then(function(){e.call(n,s,i)})):(n.skip++,location.hash=n._currentActivity.url)})}):e.call(n,s,i)}},remove:function(t){this._activities[a(t)]=void 0}};n.exports=l});define("core/page",["$","util","./base","./view","./promise","../widget/dialog","../widget/tip"],function(t,e,n){var i=t("$"),r=t("util"),o=(t("./base"),t("./view")),a=t("./promise");t("../widget/dialog");t("../widget/tip");var u=r.noop,f=(r.indexOf,Array.prototype.slice,r.getPath),p=o.extend({options:{route:null},application:null,el:'<div class="view"></div>',_setRoute:function(t){this.route=t,this.hash=t.hash,this.url=t.url,this.path=t.path,this._query=this.query,this.query=i.extend({},t.query)},loadTemplate:function(){var t=this,e=1,n=function(){e--,0==e&&(t.$el.html(t.razor.html(t.data)).appendTo(t.application.$el),t.trigger("Create"),t._promise.resolve())};return t.route.api&&(e++,i.ajax({url:t.route.api,type:"GET",dataType:"json",success:function(e){t.data=e,n(e)},error:function(t){n({success:!1,content:t.responseText})}})),seajs.use(t.route.template,function(e){t.razor=e,n()}),t._promise},initialize:function(){var t=this,e=a.resolve();t._promise=e,t.className=t.el.className,t._setRoute(t.options.route),t.application=t.options.application,t.on("Start",t.onStart).on("Resume",t.onResume).on("Show",t.onShow).on("Show",t._statusChange).on("Pause",t.onPause).on("Pause",t._statusChange).on("QueryChange",t.onQueryChange).on("QueryChange",t.checkQuery),t.$el.data("path")||(t.$el.data("url",t.url).data("path",t.path),e.then(t.loadTemplate,t)),e.then(t.onCreate,t).then(function(){t.trigger("Start"),t.checkQuery()})},onCreate:u,onStart:u,onResume:u,onShow:u,onStop:u,onRestart:u,onPause:u,_statusChange:function(t){"Pause"==this._status&&this.trigger("Resume"),this._status=t.type},onQueryChange:u,then:function(t){return this._promise.then(t,this),this},queryString:function(t,e){if("undefined"==typeof e)return this.route.query[t];null===e||e===!1||""===e?delete this.route.query[t]:this.route.query[t]=e||"";var n=i.param(this.route.query);location.hash=this.route.path+(n?"?"+n:"")},_queryActions:{},checkQuery:function(){var r,t=this,e=t.query,n=t._query;i.each(t._queryActions,function(t,i){if(r=e[t]||"",r&&!n||n&&r!=n[t]){var s=i.map[r];s.exec?s.exec=!1:s.fn.apply(i.ctx)}})},bindQueryAction:function(t,e,n){var r=this,o={},a={ctx:e,map:o};return i.each(n,function(i,s){var s=n[i],a=e[s],l={fn:a,exec:!1};o[i]=l,e[s]=function(){a.apply(e,arguments),r.queryString(t)!=i&&(l.exec=!0,r.queryString(t,i))}}),this._queryActions[t]=a,this},onResult:function(t,e){return this.listenTo(this.application,t,e)},setResult:function(){return this.application.trigger.apply(this.application,arguments),this},compareUrl:function(t){return f(t)===this.route.path.toLowerCase()},back:function(t){this.application.to(t)},forward:function(t){this.application.to(t)}});sl.Page=p,n.exports=p});define("core/navigation",["$","util","./base","./view","./route","./master","./promise"],function(t,e,n){var i=t("$"),r=t("util"),o=(t("./base"),t("./view")),a=t("./route"),l=t("./master"),u=t("./promise"),p=(r.noop,Array.prototype.slice,r.getPath,a.standardizeHash),d=l.checkQueryString,v=o.extend(i.extend(l,{events:{"click a[href]:not(.js-link-default)":function(t){var n=i(t.currentTarget);if(!/^(http\:|https\:|javascript\:|mailto\:|tel\:)/.test(n.attr("href"))&&"_blank"!=n.attr("target")){t.preventDefault();var r=n.attr("href");return/^#/.test(r)||(r="#"+r),location.hash=r,!1}n.addClass("js-link-default")}},el:'<div class="screen" style="position:fixed;top:0px;bottom:0px;right:0px;width:100%;background:rgba(0,0,0,0);z-index:2000;display:none"></div><div class="viewport"></div>',initialize:function(){var t=this;t.$mask=i(t.$el[0]).on("click",!1),t.el=t.$el[1],t.promise=u.resolve()},start:function(){var e,t=this,n=i(window),r=i(document.body),s=r.find(".view");t.$el.appendTo(r),t.$el=i(t.el),s.length&&t.$el.append(s.hide()),location.hash||(location.hash="/"),t.hash=e=p(location.hash),t.promise.then(function(){return t.get(e,function(e){e.$el.show().appendTo(t.el),t._currentActivity=e,e.then(function(){e.trigger("Resume").trigger("Show"),t.trigger("start"),t.promise.resolve()})}),n.on("hashchange",function(){e=t.hash=p(location.hash),0==t.skip?t.to(e):t.skip>0?t.skip--:t.skip=0}),t.promise})},navigate:function(t){t=p(t),this.skip++,location.hash=t},to:function(t){t=p(t);var e=this,n=e.promise;n.then(function(){var i=e._currentActivity,r=e.route.match(t);return 0==n.queue.length&&t!=p(location.hash)&&e.navigate(t),i.path==r.path?(d(i,r),void n.resolve()):(e.get(r,function(t){t.path==i.path?d(t,r):(e._currentActivity=t,null===t.el.parentNode&&t.$el.appendTo(i.application.el),t.$el.show().siblings(".view").hide(),t.then(function(){t.trigger("Resume").trigger("Show")})),n.resolve()}),n)})}}));sl.Navigation=v,n.exports=v});define("core/route",["util"],function(t,e,n){var i=t("util"),r=function(t){var e=t.indexOf("?"),n="";return-1!=e&&(n=t.substr(e),t=t.substr(0,e)),(t.replace(/^#+|\/$/,"")||"/").toLowerCase()+n},s=function(t,e){this.routes=[],this.isDebug=e!==!1,this.append(t)};s.prototype.append=function(t){var e,n,r,s,o;for(var a in t){if(e=t[a],n=[],o="^(?:/{0,1})"+a.replace(/(\/|^|\?)\{((?:.+?\{[^\}]+\}){0,}[^\}]*)\}/g,function(t,e,i){return s=i.split(":"),s.length>1&&(n.push(s.shift()),i=s.join(":")),e+"("+i+")"})+"$","string"==typeof e)throw new Error("Route options error");r=e.root||"./",this.routes.push({regex:new RegExp(o,"i"),parts:n,template:i.combinePath(r,e.template),view:i.combinePath(r,e.controller),api:e.api,root:r})}},s.prototype.match=function(t){var a,u,c,e=null,n={},s=t=r(t),o=t.indexOf("?"),l=this.routes;-1!=o?(a=t.substr(o+1),t=t.substr(0,o),a.replace(/(?:^|&)([^=&]+)=([^&]*)/g,function(t,e,i){return n[e]=decodeURIComponent(i),""})):a="";for(var h=0,f=l.length;f>h;h++)if(u=l[h],c=u.regex?t.match(u.regex):null){e={path:c[0],url:s,hash:"#"+s,root:u.root,template:u.template,"package":this.isDebug?!1:i.combinePath(u.root,"controller"),view:u.view,data:{},search:a,query:n};for(var p=0,d=u.parts.length;d>p;p++)e.data[u.parts[p]]=c[p+1];u.api&&(e.api=u.api.replace(/\{([^\}]+?)\}/g,function(t,n){return e.data[n]}));break}return e},s.standardizeHash=r,n.exports=s});define("core/animation",["$","./linklist","graphics/matrix2d","graphics/tween","graphics/cubicBezier","util","../graphics/cubicBezier"],function(t,e){for(var n=t("$"),i=t("./linklist"),r=t("graphics/matrix2d"),s=t("graphics/tween"),a=t("graphics/cubicBezier"),a=(t("util"),t("../graphics/cubicBezier")),l=["webkit"],u=0;u<l.length&&!window.requestAnimationFrame;++u)window.requestAnimationFrame=window[l[u]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[l[u]+"CancelAnimationFrame"]||window[l[u]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){return setTimeout(t,16.7)},window.cancelAnimationFrame=function(t){clearTimeout(t)});var c=new i,h=!0,f=n.fx.cssPrefix+"transform",p={opacity:1},v=/(\d+\.\d+|\d+)\%/g,g=/translate\((\-{0,1}\d+(?:\.\d+){0,1}(?:\%|px){0,1})\s*\,\s*(\-{0,1}\d+(?:\.\d+){0,1}(?:\%|px){0,1})\)/,m=/matrix\((\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\,\s*(\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\,\s*(\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\,\s*(\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\,\s*(\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\,\s*(\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\)/,y=/matrix\([^\)]+\)\s*$/,x=/(translate|skew|rotate|scale|matrix)(3d){0,1}\(([^\)]+)\)/g,b=/^(matrix|translate|skew|rotate|scale|invert)(3d){0,1}$/,_=function(t){var e=[];return n.each(t,function(t,n){e.push(isNaN(parseFloat(n))?0:parseFloat(n))}),e},w=function(t,e,n){return parseFloat(t)+(parseFloat(e)-parseFloat(t))*n},E=function(t){var e=new r;return t.replace(x,function(t,n,i,r){e["matrix"==n?"append":n].apply(e,_(r.split(",")))}),e},A=function(t){var i,s,e={};return n.each(t,function(t,n){var a=t.match(b);a?("translate"===t?n=(e[f]||"")+" "+t+"("+n+") translateZ(0)":(s||(s=new r),i=e[f]||"",n=s["matrix"==t?"append":t].apply(s,_(n.split(","))).toString(),n=y.test(i)?i.replace(y,n):i+" "+n),t=f):"transform"===t&&(t=f,s=null),e[t]=n}),{css:e,matrix:s}};e.transform=A,n.fn.transform=function(t){return this.css(A(t).css),this},n.fn.matrix=function(t){return t instanceof r?(this.css(f,t.toString()),this):E(getComputedStyle(this[0],null)[f])};var N=function(){if(c.length){h=!1;for(var t,e,s,r=(+new Date,c._idlePrev);r!=c;)s=r._idlePrev,first=r.data,t=Date.now()-first.startTime,e=[],t<=first.duration?first.step(first.ease instanceof a?first.ease.get(t/first.duration):first.ease(t,first.from,first.to-first.from,first.duration)/100,t,first.duration):(first.step(first.to/100,first.duration,first.duration),c._remove(r),first.finish&&first.finish(first.to/100)),r=s;requestAnimationFrame(N)}else h=!0},$=function(t){var e=t.ease;return t.startTime=Date.now(),!e&&(t.ease=s.easeOut)||"string"==typeof e&&(t.ease=0==e.indexOf("cubic-bezier")?new a(e):s[e.replace(/\-([a-z])/g,function(t,e){return e.toUpperCase()})]),t.stop=function(){c.remove(t)},void 0===t.from&&(t.from=0),void 0===t.to&&(t.to=100),t.duration||(t.duration=300),t},k=function(t){for(var e=0,n=t.length;n>e;e++)c.append($(t[e]));h&&N()},M=function(t){var e,i,r,s,a;this.el.each(function(){if(e=this._animationStyle,i=this._originStyle,0==t)a=i;else if(1>t){a={};for(var o in e)if(s=e[o],r=i[o],o==f){for(var l=r.match(m)||["",1,0,0,1,0,0],u=0,c=E(s),u=0;6>u;u++)c[u]=w(l[u+1],c[u],t);a[o]=c.toString()+" translateZ(0)"}else isNaN(parseFloat(s))?a[o]=s:(r=isNaN(parseFloat(r))?p[o]||0:parseFloat(r),a[o]=w(r,s,t))}else a=e;n(this).css(a)}),this._step&&this._step(t)},O=function(t){1==t&&this.el.css(this.css),this._finish&&this._finish(t)},C=function(t){for(var e,i,s,l=0,u=t.length;u>l;l++)e=t[l],e.css&&(s=A(e.css),e.matrix=s.matrix,e.css=s.css,i=e.el=n(e.el),"object"==typeof e.start&&i.transform(e.start),i.each(function(){var t=this,i={},r={},s=getComputedStyle(t,null);n.each(e.css,function(e,n){"string"==typeof n&&(e==f?n=n.replace(g,function(e,n,i){return"translate("+(-1!==n.indexOf("%")?t.offsetWidth*parseFloat(n)/100:parseFloat(n))+"px,"+(-1!==i.indexOf("%")?t.offsetHeight*parseFloat(i)/100:parseFloat(i))+"px)"}):/^(top|margin(-t|T)op)$/.test(e)?n=n.replace(v,function(e){return t.parentNode.offsetHeight*parseFloat(e)/100+"px"}):/^(left|margin(-l|L)eft|padding(-l|L)eft|padding(-t|T)op)$/.test(e)&&(n=n.replace(v,function(e){return t.parentNode.offsetWidth*parseFloat(e)/100+"px"}))),r[e]=s[e],i[e]=n}),t._animationStyle=i,t._originStyle=r}),e._step=e.step,e.step=M,e._finish=e.finish,e.finish=O);return t},T=function(t){n.isArray(t)||(t=[t]),C(t),this.list=t};T.prototype.step=function(t){var e,n=this.list;this.per=t;for(var i=0,r=n.length;r>i;i++)e=n[i],e.from=t,e.step(t/100);return this},T.prototype.animate=function(t,e,n){for(var i,r=this.list,s=0,a=r.length;a>s;s++)i=r[s],i.duration=t,i.to=e,i.finish=i.start=void 0;return i.finish=n,k(r),this},e.Animation=T,e.parallel=function(t){k(C(t))},e.step=w,e.animate=function(){var t=arguments,e={},n=0,i=t[n++];return"function"==typeof i?e.step=i:(e.el=i,e.css=t[n++]),e.duration=t[n++],e.ease=t[n++],e.finish=t[n],k([e]),e};var S={step:function(t){for(var i,e=0,n=this.momentums.length;n>e;e++)i=this.momentums[e],i.current=i.start+(i.result-i.start)*t;this.momentumStep.apply(this.ctx,this.momentums)},finish:function(){this.bounce()},bounce:function(){for(var e,n,s,t=0,i=0,r=this.momentums.length;r>i;i++)s=this.momentums[i],n=s.current<s.min?s.min:s.current>s.max?s.max:s.current,n!=s.current?(s.start=s.current,s.result=n,t++):s.divisor&&n%s.divisor!=0&&(e=s.divisor,s.start=s.current,s.result=e/2>n%e?n-n%e:n-n%e+e,t++);0==t?this.end.call(this.ctx):(this.duration=400,k([this]))}},j=function(t,e,n,i,r,s,a,o){var g,m,l=e-t,u=r-e,c=e-i,h=6e-4,f=Math.abs(l)/n,p=f*f/(2*h),d=0,v=0;return s=a||s,l>0&&p>u?(v=s/(6/(p/f*h))/2,u+=v,f=f*u/p,p=u):0>l&&p>c&&(v=s/(6/(p/f*h))/2,c+=v,f=f*c/p,p=c),p*=0>l?-1:1,v*=0>l?-1:1,d=f/h,m=e+p,0!=v&&(g=.15/(v/p),g>1&&(p-=v,v/=g,p+=v,m=e+p)),i>e&&i>m||e>r&&m>r?(p=0,d=0,outside=0,m=e):(a&&0==v&&(console.log(m,a,o,a/2>m%a,m-m%a),m=m%a==0?m:(a/2>m%a||"right"==o)&&"left"!=o?m-m%a:m-m%a+a,m=m>r?r:i>m?i:m,300>d&&(d=300),p=m-e),a&&d>400&&(d=400)),{dist:p,time:Math.round(d),outside:v,result:m,current:e,start:e,max:r,min:i,divisor:a}};e.momentum=function(t,e,i,r,s,a){var o=[],l={},u=0;if("number"==typeof t[0])t=[t];else if(!t.length)return void s.call(a);for(var f,c=0,h=t.length;h>c;c++)f=j.apply(this,t[c]),0!=f.dist&&(u=Math.max(u,f.time)),o.push(f);for(var f,c=0,h=o.length;h>c;c++)f=o[c],0!=f.outside&&(f.result=f.result-f.outside+400*f.outside/u);return n.extend(l,S,{ctx:a||l,momentums:o,momentumStep:i,duration:u,ease:r,end:s}),0!=u?(e&&l.duration>e&&(l.duration=e),k([l])):l.bounce(),l}});define("core/http",["$","util"],function(t,e,n){var i=t("$"),r=t("util"),a=["url","method","headers","dataType","xhrFields","beforeSend","success","error","complete"],o=function(t){i.extend(this,r.pick(t,a)),this.params=i.extend({},this.params,t.params),this.setUrl(this.url)};o.url=function(t){return/^http\:\/\//.test(t)?t:this.prototype.baseUri.replace(/\/$/,"")+"/"+t.replace(/^\//,"")},o.prototype={baseUri:i('meta[name="api-base-url"]').attr("content"),method:"POST",dataType:"json",complete:r.noop,error:r.noop,check:function(t){var e=!(!t||!t.success);return e},DATAKEY_MSG:"msg",setHeaders:function(t,e){var n;e?(n={})[t]=e:n=t,void 0===this.headers&&(this.headers={});for(var i in n)this.headers[i]=n[i];return this},setParam:function(t,e){var n;e?(n={})[t]=e:n=t;for(var i in n)e=n[i],this.params[i]=e;return this},getParam:function(t){return t?this.params[t]:this.params},clearParams:function(){return this.params={},this},setUrl:function(t){return this.url=/^http\:\/\//.test(t)?t:this.baseUri.replace(/\/$/,"")+"/"+t.replace(/^\//,""),this},request:function(t,e){var n=this;if(!n.beforeSend||n.beforeSend()!==!1)return this.abort(),"function"==typeof t&&(e=t,t=null),n._xhr=i.ajax({url:n.url,headers:n.headers,xhrFields:n.xhrFields,data:n.params,type:n.method,dataType:n.dataType,cache:!1,error:function(t){var i={};i[n.DATAKEY_MSG]="网络错误",n.error(i,t),e&&e.call(n,i,null)},success:function(t,i,r){!n.check||n.check(t)?(n.success(t,i,r),e&&e.call(n,null,t)):(n.error(t),e&&e.call(n,t,null))},complete:function(){n._xhr=null,n.complete()}}),this},abort:function(){return this._xhr&&(this._xhr.abort(),this._xhr=null),this}},o.extend=r.extend,n.exports=o});define("common/page",["$","util","core/page","models/api"],function(t,e,n){var s=(t("$"),t("util"),t("core/page")),a=t("models/api").API;return s.extend({initialize:function(){var t=this;s.prototype.initialize.call(this,arguments),new a({url:"/api/manage/islogin",success:function(t){},error:function(){t.forward("/login")}}).request()}})});define("common/menu.html",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='\ufeff<div class="menu"> <div class="menu_hd"> 菜单 </div> <div class="menu_sub_hd"><a href="/login">退出系统</a></div> <div class="menu_bd"> <dl sn-repeat="item in data"> <dt sn-binding="class:item.current|case:true:\'curr\':\'\'"> <a sn-binding="html:item.title,href:item.url"></a> </dt> <dd sn-repeat="child in item.children" sn-binding="class:child.current|case:true:\'curr\':\'\'"> <a sn-binding="html:child.title,href:child.url"></a> </dd> </dl> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("common/menu",["$","util","./menu.html","core/model"],function(t,e,n){var i=t("$"),r=t("util"),s=t("./menu.html"),a=t("core/model");n.exports=e=function(){this.$el=i(s.html()),this.model=new a.ViewModel(this.$el,{area:r.store("global_area")||1,data:[{url:"/settings/ad_list",title:"广告位管理",children:[{title:"添加广告位",url:"/settings/add_ad"}]},{url:"/settings/news_list",title:"活动页管理",children:[{title:"添加活动页",url:"/settings/add_news"}]},{url:"/settings/set_update",title:"app更新管理"},{url:"/settings/set_resource_mapping",title:"app资源管理"}]})};var o=null;e.get=function(t){!o&&(o=new e),o.current&&o.current.set({current:!1});for(var i,n=0;n<o.model.data.data.length;n++){i=o.model.data.data[n];var r=i.children;if(i.url==t||i.id==t){o.current=o.model.get("data").get(n).set({current:!0});break}if(r)for(var s=0;s<r.length;s++)if(r[s].url==t||r[s].id==t){o.current=o.model.get("data."+n+".children."+s).set({current:!0});break}}return o.$el.show(),o}});define("models/api",["core/http"],function(t,e,n){var i=t("core/http"),r=i.extend({baseUri:$('meta[name="api-base-url"]').attr("content"),xhrFields:{withCredentials:!0}});e.API=r});define("components/timepicker",["$","util","core/model2"],function(t,e,n){var i=t("$"),r=t("util"),s=t("core/model2"),a=20;r.style('.calendar.curr{z-index:5001;width:280px;}.calendar{height:22px;padding:1px;zoom:1;display:inline-block;*display:inline;position:relative;overflow:visible;z-index:0;color:#000;}        .calendar span {cursor:pointer;border:0;margin:0;padding:0 2px;height:20px;line-height:20px;display:inline-block;position:relative;color:#000;background-color:#f1f1f1;}        .calendar-icon{margin-top: 0px;display: inline-block;vertical-align: middle;position: relative;font-size: 12px;width: 10px;height: 8px;overflow: hidden;line-height: 12px;font-family: "SimSun";}        .calendar-icon em {display: inline-block;height: 0px;overflow: hidden;position: absolute;top: 0px;left: 0px;  border-top: 4px solid #000;border-right: 4px solid #fff;border-left: 4px solid #fff;}        .calendar-up .calendar-icon em {border-top: 4px solid #fff;border-bottom: 4px solid #000;}        .calendar-up,.calendar-down {cursor:pointer;}        .calendar-wrap {top:0;left:0;position:absolute;border:1px solid #cdcdcd;background:#fff;overflow:hidden;}        .calendar-bd {width:35px;text-align:center;float:left;}        .calendar-bd i { display: block; height: '+a+"px;font-style:normal; cursor: default; }        .calendar-con{height:200px;overflow:hidden;}        .calendar-bd i.curr { background: #ddd; }");var o=s.ViewModel.extend({el:'<div class="calendar{{isShow?\' curr\':\'\'}}" > <div sn-click="this.show()"> <span><em>{{ yyyy }}</em></span> / <span><em>{{ util.pad(MM) }}</em></span> / <span><em>{{ util.pad(dd) }}</em></span> <span><em>{{ util.pad(hh) }}</em></span>&nbsp;: <span><em>{{ util.pad(mm) }}</em></span>&nbsp;: <span><em>{{ util.pad(ss) }}</em></span> </div> <div class="calendar-wrap" sn-display="{{isShow}}" style="display:none;"> <div class="calendar-bd"> <div class="calendar-up" sn-click="yearIndex=(yearIndex>0?yearIndex-1:yearIndex)"><em class="calendar-icon"><em></em></em></div> <div class="calendar-con"><div style="margin-top:-{{parseInt(yearIndex*200)}}px"><i sn-repeat="item in years" class="{{yyyy==item?\'curr\':\'\'}}" sn-click="this.setYear(item)">{{ item }}</i></div></div> <div class="calendar-down" sn-click="yearIndex=years.length>(yearIndex+1)*10?yearIndex+1:yearIndex"><em class="calendar-icon"><em></em></em></div> <i sn-click="this.today()">今天</i> </div> <div class="calendar-bd"> <div class="calendar-up" sn-click="monthIndex=(monthIndex>0?monthIndex-1:monthIndex)"><em class="calendar-icon"><em></em></em></div> <div class="calendar-con"><div style="margin-top:-{{parseInt(monthIndex*200)}}px"><i sn-repeat="item in months" class="{{MM==item?\'curr\':\'\'}}" sn-click="this.setMonth(item)">{{ util.pad(item) }}</i></div></div> <div class="calendar-down" sn-click="monthIndex=months.length>(monthIndex+1)*10?monthIndex+1:monthIndex"><em class="calendar-icon"><em></em></em></div> <i sn-click="this.now()">现在</i> </div> <div class="calendar-bd"> <div class="calendar-up" sn-click="dayIndex=(dayIndex>0?dayIndex-1:dayIndex)"><em class="calendar-icon"><em></em></em></div> <div class="calendar-con"><div style="margin-top:-{{parseInt(dayIndex*200)}}px"><i sn-repeat="item in days" class="{{dd==item?\'curr\':\'\'}}" sn-click="this.setDay(item)">{{ util.pad(item) }}</i></div></div> <div class="calendar-down" sn-click="dayIndex=days.length>(dayIndex+1)*10?dayIndex+1:dayIndex"><em class="calendar-icon"><em></em></em></div> <i sn-click="this.clearInput()">清空</i> </div> <div class="calendar-bd"> <div class="calendar-up" sn-click="hourIndex=(hourIndex>0?hourIndex-1:hourIndex)"><em class="calendar-icon"><em></em></em></div> <div class="calendar-con"><div style="margin-top:-{{parseInt(hourIndex*200)}}px"><i sn-repeat="item in hours" class="{{hh==item?\'curr\':\'\'}}" sn-click="this.setHours(item)">{{ util.pad(item) }}</i></div></div> <div class="calendar-down" sn-click="hourIndex=hours.length>(hourIndex+1)*10?hourIndex+1:hourIndex"><em class="calendar-icon"><em></em></em></div> </div> <div class="calendar-bd"> <div class="calendar-up" sn-click="minuteIndex=(minuteIndex>0?minuteIndex-1:minuteIndex)"><em class="calendar-icon"><em></em></em></div> <div class="calendar-con"><div style="margin-top:-{{parseInt(minuteIndex*200)}}px"><i sn-repeat="item in minutes" class="{{mm==item?\'curr\':\'\'}}" sn-click="this.setMinutes(item)">{{ util.pad(item) }}</i></div></div> <div class="calendar-down" sn-click="minuteIndex=minutes.length>(minuteIndex+1)*10?minuteIndex+1:minuteIndex"><em class="calendar-icon"><em></em></em></div> </div> <div class="calendar-bd"> <div class="calendar-up" sn-click="secondIndex=(secondIndex>0?secondIndex-1:secondIndex)"><em class="calendar-icon"><em></em></em></div> <div class="calendar-con"><div style="margin-top:-{{parseInt(secondIndex*200)}}px"><i sn-repeat="item in seconds" class="{{ss==item?\'curr\':\'\'}}" sn-click="this.setSeconds(item)">{{ util.pad(item) }}</i></div></div> <div class="calendar-down" sn-click="secondIndex=seconds.length>(secondIndex+1)*10?secondIndex+1:secondIndex"><em class="calendar-icon"><em></em></em></div> <i class="js_hide">确定</i> </div> </div> </div>',setYear:function(t,e){var n;return"number"==typeof t&&(n=e,e=t),this.set({yyyy:e,yearIndex:parseInt(this.data.years.indexOf(e)/10)}),this._syncDays()._update(n)},setMonth:function(t,e){var n;"number"==typeof t&&(n=e,e=t);var i=this.data.months.indexOf(e);return this.set({MM:e,monthIndex:parseInt(i/10)}),this._syncDays()._update(n)},setDay:function(t,e){var n;return"number"==typeof t&&(n=e,e=t),this.set({dd:e,dayIndex:parseInt(this.data.days.indexOf(e)/10)})._update(n)},setHours:function(t,e){var n;return"number"==typeof t&&(n=e,e=t),this.set({hh:e,hourIndex:parseInt(this.data.hours.indexOf(e)/10)})._update(n)},setMinutes:function(t,e){var n;return"number"==typeof t&&(n=e,e=t),this.set({mm:e,minuteIndex:parseInt(this.data.minutes.indexOf(e)/10)})._update(n)},setSeconds:function(t,e){var n;return"number"==typeof t&&(n=e,e=t),this.set({ss:e,secondIndex:parseInt(this.data.seconds.indexOf(e)/10)})._update(n)},_syncDays:function(){var t=[],e=this.data.months.indexOf(this.data.MM),n=parseInt(this.data.yyyy)||0;n%4!=0||n%100==0&&n%400!=0?this.aDays[1]=28:this.aDays[1]=29;for(var i=this.aDays[e],r=1;i>=r;r++)t.push(r);return this.set({dayIndex:1,days:t})},today:function(){var t=new Date;return this.setYear(t.getFullYear()).setMonth(t.getMonth()+1).setDay(t.getDate())},now:function(){var t=new Date;return this.setTime(t)},setTime:function(t){return t?(("number"==typeof t||"string"==typeof t&&/^\d+$/.test(t))&&(t=new Date(t)),this.setYear(t.getFullYear(),!1).setMonth(t.getMonth()+1,!1).setDay(t.getDate(),!1).setHours(t.getHours(),!1).setMinutes(t.getMinutes(),!1).setSeconds(t.getSeconds(),!1)._update()):this.clearInput()},clearInput:function(){return this.set({yyyy:"----",MM:"--",dd:"--",hh:"--",mm:"--",ss:"--"})._update()},_update:function(t){if(t!==!1){var e=this.data,n="----"!=e.yyyy?(e.yyyy+"/"+e.MM+"/"+e.dd).replace(/--/g,"1")+" "+(e.hh+":"+e.mm+":"+e.ss).replace(/--/g,"00"):"";n!=this.$input.val()&&this.$input.val(n).trigger("onTimeChange")}return this},getTime:function(){return Date.parse(this.$input.val().replace(/-/g,"/"))||0},show:function(){var t=this;return i(document.body).on("mouseup",function(e){(0==t.$el.has(e.target).length||i(e.target).hasClass("js_hide"))&&(t.hide(),i(this).off("mouseup",arguments.callee))}),this.set({isShow:!0})},hide:function(){this.set({isShow:!1})},constructor:function(t,e){var n=new Date;e=i.extend({yearFrom:n.getFullYear()-30,yearTo:n.getFullYear()+5},e),this.$input=t,this.aDays=[31,28,31,30,31,30,31,31,30,31,30,31];for(var a=[],o=e.yearFrom;o<=e.yearTo;o++)a.push(o);for(var l=[],o=1;12>=o;o++)l.push(o);for(var u=[],o=0;23>=o;o++)u.push(o);for(var c=[],h=[],o=0;59>=o;o++)c.push(o),h.push(o);s.ViewModel.call(this,{yyyy:"----",MM:"--",dd:"--",hh:"--",mm:"--",ss:"--",yearIndex:0,monthIndex:0,dayIndex:0,hourIndex:0,minuteIndex:0,secondIndex:0,years:a,months:l,hours:u,minutes:c,seconds:h}),this.$el.insertBefore(t)},val:function(t){this.setTime(t)}});n.exports=o});define("components/validator",["$"],function(t,e,n){var i=t("$"),r=function(t){i.extend(this,t)};r.prototype={emptyAble:!0,emptyText:"不可为空",regex:null,regexText:null,compare:null,compareText:"",validate:null,validateText:null,success:""},n.exports=e=function(t,e){var n;this.options={},this.data=e;for(var i in t)n=t[i],this.options[i]=new r(n)},e.prototype.set=function(t){this.data=t},e.prototype.valid=function(t,e){return t?""!==e&&null!=e||t.emptyAble!==!1&&(!i.isFunction(t.emptyAble)||t.emptyAble())?""==e||null==e||null===t.regex||t.regex.test(e)?t.compare&&this.data[t.compare]!=e?{success:!1,msg:t.compareText}:t.validate&&!t.validate.call(this,e)?{success:!1,msg:t.validateText}:{success:!0,msg:"function"==typeof t.success?t.success.call(this,e):t.success}:{success:!1,msg:t.regexText}:{success:!1,msg:t.emptyText}:{success:!0}},e.prototype.validate=function(t){if(t)return this.valid(this.options[t],this.data[t]);var r,i={success:!0,result:{}};for(var t in this.options)r=this.valid(this.options[t],this.data[t]),i.result[t]=r,i.success&&(i.success&=r.success);return i}});define("components/form.tpl",["util"],function(require){var util=require("util"),T={html:function($data){var __="";with($data||{}){__+='\ufeff<form action="'+util.encodeHTML(url)+'" method="'+util.encodeHTML(method)+'" enctype="'+util.encodeHTML(enctype||"multipart/form-data")+'" class="form"> ';for(var i=0,len=hiddens.length;len>i;i++){var field=hiddens[i];__+='<input type="hidden" name="'+util.encodeHTML(field.field)+'" sn-model="'+util.encodeHTML(name)+"."+util.encodeHTML(field.field)+'" sn-binding="value:'+util.encodeHTML(name)+"."+util.encodeHTML(field.field)+'" />',__+=" "}__+=' <table width="100%"> <tbody> ';for(var i=0,len=fields.length;len>i;i++){var field,items=fields[i];__+="<tr> ",items.length||(__+=" items=[items]; "),__+=" ";for(var j=0,length=items.length;length>j;j++){field=items[j];var attr='style="'+(field.width?"width:"+field.width+"px;":"")+(field.height?"height:"+field.height+"px;":"")+'" name="'+field.field+'" sn-model="'+name+"."+field.field+'" sn-binding="value:'+name+"."+field.field+'"';if(__+="<th "+(field.vAlign?'style="vertical-align:'+field.vAlign+'"':"")+">"+util.encodeHTML(field.label)+" ",field.emptyAble===!1&&(__+="<i>*</i>",__+=""),__+='</th> <td colspan="'+util.encodeHTML(field.colSpan||1)+'"> ',"text"!=field.type&&field.type)if("textarea"==field.type)__+='<textarea class="'+util.encodeHTML(field.className||"text")+'"'+attr+"></textarea>",__+=" ";else if("select"==field.type){__+='<select class="'+util.encodeHTML(field.className||"text")+'"'+attr+"> ";for(var ii=0,len1=field.options.data.length;len1>ii;ii++){var option=field.options.data[ii];__+='<option value="'+util.encodeHTML(option[field.options.value||"value"])+'">'+util.encodeHTML(option[field.options.text||"text"])+"</option>",__+=" "}__+=" </select>",__+=" "}else"number"==field.type?(__+='<input class="'+util.encodeHTML(field.className||"text_normal")+'" type="text"'+attr+"/>",__+=" "):"password"==field.type?(__+='<input class="'+util.encodeHTML(field.className||"text")+'" type="password"'+attr+"/>",__+=" "):"captcha"==field.type?(__+='<input class="'+util.encodeHTML(field.className||"text_normal")+'" type="text"'+attr+'/> <img class="captcha" src="'+util.encodeHTML(field.captcha)+"?v="+util.encodeHTML(Date.now())+'" onclick="this.src=\''+util.encodeHTML(field.captcha)+"?v='+Date.now()\" sn-binding=\"src:captcha|or:'"+util.encodeHTML(field.captcha)+"'\"/>",__+=" "):"file"==field.type?(__+='<input type="file" name="'+util.encodeHTML(field.field)+'" sn-model="'+util.encodeHTML(name)+"."+util.encodeHTML(field.field)+'"/>',__+=" "):"radio"==field.type||"checkbox"==field.type?(__+='<input type="'+util.encodeHTML(field.type)+'" name="'+util.encodeHTML(field.field)+'" sn-model="'+util.encodeHTML(name)+"."+util.encodeHTML(field.field)+'" sn-binding="checked:'+util.encodeHTML(name)+"."+util.encodeHTML(field.field)+'|or:undefined"/>',__+=" "):($data.plugins.push(field),__+='<input type="hidden"'+attr+">",__+=" ");else __+='<input class="'+util.encodeHTML(field.className||"text")+'" type="text"'+attr+"/>",__+=" ";__+=' <span sn-binding="class:'+util.encodeHTML(validator)+".result."+util.encodeHTML(field.field)+".success|case:-1:'msg_tip':true:'right_tip':false:'error_tip':'hide',html:"+util.encodeHTML(validator)+".result."+util.encodeHTML(field.field)+'.msg"></span> </td>',__+=" "}__+=" </tr>",__+=" "}__+=" </tbody> </table> </form> "}return __},helpers:{}};return T.template=T.html,T});define("components/form",["$","./form.tpl","util","./validator","core/promise","./timepicker"],function(e,t,n){var i=e("$"),r=e("./form.tpl"),s=e("util"),a=e("./validator"),o=e("core/promise"),l=e("./timepicker"),u=["emptyAble","emptyText","regex","regexText","compare","compareText","validate","validateText","success"],c=0;n.exports=t=function(e){var r,o;this.hiddens=[],this.fields=[],this.plugins=[],this.compo={};var l={};for(var c in e)if(r=e[c],"fields"==c)for(var h=0,d=r.length;d>h;h++)if(o=r[h],"hidden"===o.type)this.hiddens.push(o);else{o.length||(o=[o]),this.fields.push(o);for(var f=0,p=o.length;p>f;f++){var m=o[f],v=s.pick(m,u);s.isEmptyObject(v)||(l[m.field]=v)}}else this[c]=r;this.model.set(this.name,{}),this.formModel=this.model.get(this.name),this.data=this.formModel.data,this.valid=new a(l,this.data),this.$el=i(this.template.html(this)).appendTo("body"),this.el=this.$el[0],this.$el.on("blur","[name]",i.proxy(this._validInput,this));for(var h=0,d=this.plugins.length;d>h;h++){var g=this.plugins[h],y=this.$el.find('[name="'+g.field+'"]'),x=this.compo[g.field]=new(t.require(g.type))(y,g),_=this.formModel.data[g.field];void 0!==_&&null!==_&&x.val(this.formModel.data[g.field]),this.formModel.on("change:"+g.field,function(e){return function(t,n){e.val(n)}}(x))}},t.prototype={model:null,name:"form",template:r,useIframe:!1,validator:"valid",url:"",enctype:"",method:"post",fields:[],reset:function(){for(var e in this.compo)this.compo[e].val("");this.el.reset()},submit:function(e,t){var n=this.valid.validate(),r=this;if(this.model.set(this.validator,n),n.success)if(this.useIframe||this.$el.has('[type="file"]').length){c++;var a,s="_submit_iframe"+c;i('<iframe style="top:-999px;left:-999px;position:absolute;display:none;" frameborder="0" width="0" height="0" name="'+s+'"></iframe>').appendTo(document.body).on("load",function(){var n=i.trim(this.contentWindow.document.body.innerHTML);if(!a||n!=a){a=n;try{e.call(r,JSON.parse(a))}catch(s){t&&t.call(r,s,a)}}});this.$el.attr("target",s).submit()}else i.ajax({url:this.url,type:"POST",dataType:"json",xhrFields:{withCredentials:!0},data:this.$el.serialize(),success:i.proxy(e,this),error:t&&i.proxy(t,this)});else sl.tip("请检查填写是否有误")},_validInput:function(e){var t=i(e.currentTarget),n=t.attr("name"),r=this.valid.validate(n);this.model.data[this.validator]||this.model.set(this.validator,{result:{}}),this.model.set(this.validator+".result."+n,r)},destory:function(){this.$el.on("off","[name]",this._validInput)}};var h={};t.define=function(e,t){h[e.toLowerCase()]=t},t.require=function(e){return h[e.toLowerCase()]};var d=function(e,t){var n=this;n.$input=e,n.id="UMEditor"+d.guid++;i('<script type="text/plain" id="'+n.id+'" style="width:'+(t.width||640)+'px;height:300px;"></script>').insertBefore(e);window.UMEDITOR_HOME_URL=seajs.resolve("components/umeditor/"),n.promise=o(),function(e){window.jQuery?e():seajs.use(["components/umeditor/third-party/jquery.min"],e)}(function(){seajs.use(["components/umeditor/umeditor.config","components/umeditor/umeditor","components/umeditor/themes/default/css/umeditor.css"],function(i){var r={};t.toolbar?r.toolbar=t.toolbar:t.simple&&(r.toolbar=["source | undo redo | bold italic underline strikethrough | removeformat | justifyleft justifycenter justifyright justifyjustify | link unlink | image"]);var s=UM.getEditor(n.id,r);s.addListener("blur",function(){var t=s.getContent(),n=e[0].value;e.val(t),n!==t&&e.trigger("change"),e.trigger("blur")}),n.editor=s,s.ready(function(){n.promise.resolve()})})})};d.prototype={val:function(e){var t=this;t.promise.then(function(){t.editor.setContent(e,!1)}),t.$input.val(e).trigger("change")}},d.guid=0,t.define("RichTextBox",d),t.define("TimePicker",l)});define("components/grid",["$","util","../core/view","./page"],function(e,t,n){var i=e("$"),r=e("util"),s=e("../core/view").prototype,o=e("./page"),l=r.ie&&6==r.osVersion,c=function(e,t,n){var i;return i="number"==typeof e?n?e-t:t-e:(e+"").localeCompare(t+"")*(n?1:-1)},u=l?function(e){e.css({height:0,marginTop:-1})}:function(){$el.hide()},h=l?function(e,t){e.css({height:t,marginTop:""})}:function(){el.show()},d=["url","beforeSend","success","error","type"],f=function(e,t){var n=this,r=e.grid.options;if(this.$el=i(this.el).css(i.extend({width:t.curWidth,height:t.height,"text-align":t.align||"","float":"auto"==t.curWidth?"none":""},t.style)),"center"==t.valign&&this.$el.addClass("grid_cell_vcenter"),this.options=t,this.el=this.$el[0],this.row=e,this.$body=0==t.index&&"tree"!=r.type&&r.children?i('<div class="grid_spread" data-rowindex="'+e.index+'"></div>').appendTo(this.$el):this.$el,0==t.index&&"tree"==r.type){for(var s=[],a=0;a<treeDeep;a++)s.push('<i class="grid_tree_space"></i>');this.$el.prepend(s.join(""));var o=e.data[r.subKey];o&&o.length?(i('<i class="grid_tree" data-treeid="'+e.treeId+'"></i>').appendTo(this.$el),e.$el.addClass("grid_tree_fold"),i.each(o,function(t,n){e.grid.append(n,e.treeDeep+1,e.treeId)})):i("<i class='grid_tree_nochild'></i>").appendTo(this.$el)}var l=e.data[t.bind]||t.defaultVal;if(t.render)t.render.call(n,e.data,e.grid._data);else if("textbox"==t.type){var c=i('<textarea class="grid_cell_textbox" data-row="'+e.index+'" data-cell="'+n.index+'"></textarea>').css({height:r.rowHeight}).val(l);n.$textbox=c,n.$body.append(c),n.on("change",function(e,t){this.$textbox.val(t),this.validate()}),n.validate=function(){var e=!1;return t.emptyAble===!1&&""==this.$textbox.val()?e=this.options.emptyText||this.options.text+"不可为空！":column.regex&&!column.regex.test(textbox.value)&&(e=this.options.regexText||this.options.text+"格式错误！"),e?this.$el.addClass("grid_cell_err").title=e:this.$el.removeClass("grid_cell_err").title="",!e}}else if("selector"==t.type){var u=i('<input class="grid_selector" data-row="'+e.index+'" type="'+(r.multiselect?"checkbox":"radio")+'" name="__gs_'+e.grid.cid+"'>").prop({checked:!1});n.$body.append(u),n.$selector=e.$selector=u}else this.$body=i('<div class="grid_cell_item'+("center"==t.valign?" grid_cell_vcenter":"")+'">'+l+"</div>").appendTo(this.$body);e.$el.append(n.$el)};f.prototype={trigger:s.trigger,on:s.on,el:'<li class="grid_cell"></li>',$:function(e){return this.$el.find(e)},append:function(e){return this.$body.append(e),this},html:function(e){return"undefined"==typeof e?this.$body.html():(this.$body.html(e),this)},val:function(e){return"undefined"==typeof a?this.value:("string"==typeof e&&/^\/Date\(\d+\)\/$/.test(e)&&(e=r.formatDate(e)),this.value=e,this.options.bind&&(row.data[this.options.bind]=e),this.$textbox?this.$textbox.val(e):this.options.render?options.render.call(self,row.data,row.grid._data):this.html(e),this.trigger("change",e),this)}};var p=function(e,t){this.grid=e,this.$el=i(this.el).css({height:t.height}).data("index",t.index),this.el=this.$el[0],this.data=t.data,this.index=t.index,this.cells=[]};p.prototype={el:'<ul class="grid_row"></ul>',data:null,selected:!1,select:function(){this.selected||(this.selected=!0,this.$el.addClass("grid_row_cur"),this.selector&&this.selector.prop({checked:!0}),this.grid.selectedRows.push(this),this.grid.selectedRow=this,this.grid.trigger("SelectRow",this))},cancelSelect:function(){if(this.selected){this.selected=!1,this.$el.removeClass("grid_row_cur"),this.selector&&this.selector.prop({checked:!1});for(var e=this.grid,t=e.selectedRows,n=0,i=t.length;i>n;n++)if(t[n]==this){t.splice(n,1);break}e.selectedRow==this&&(e.selectedRow=0!=t.length?t[t.length-1]:null)}},cell:function(e,t){return void 0===t?this.cells[e]:(this.cells[e]=new f(this,t),this)},append:function(e){return this.cells.push(new f(this,e)),this},spread:function(){this.$el.find(".grid_spread").removeClass("grid_spread").addClass("grid_fold"),this.childContainer.removeClass("grid_child_non").addClass("grid_child_con")},fold:function(){this.$el.find(".grid_fold").removeClass("grid_fold").addClass("grid_spread"),this.childContainer.removeClass("grid_child_con").addClass("grid_child_non")}};var m=function(e){var t=this;t.options=e=i.extend(!0,{type:"grid",pageEnabled:!1,pageSize:10,rowHeight:30,height:"auto",multiselect:!1,subKey:"children",data:[],columns:[],children:null,search:null,onSelectRow:r.noop},e),i.each(e.columns,function(t,n){e.columns[t]=i.extend({text:"",bind:"",render:null,width:10,align:"left",valign:"center",type:"normal",style:{},css:"",defaultVal:""},n)}),t.$el=i(t.el),t.el=t.$el[0],t.$header=t.$el.find(".grid_header"),t.$body=t.$el.find(".grid_body"),t.cid=r.guid(),t.listen(t.events),"tree"==e.type&&(t.treeDeepRecord=[]),t.rows=[],t.selectedRows=[],t.adjustWidth(),t.createHead(),t.createSearch(),e.pageEnabled&&(t.page=new o({id:i("<DIV class='page'>共0条数据</DIV>").appendTo(t.$el),page:1,pageSize:t.options.pageSize,total:0,onChange:function(e){t.ajaxSettings.data.page=e,t.load()}}))};m.prototype={events:{"click .grid_header .sortable":function(e){var t=this,n=i(e.currentTarget),r=t.ajaxSettings.data,s=n.data("bind");r.sort=s,t.currentSort!=e.currentTarget&&(n.removeClass("sort_desc sort_asc"),t.currentSort=e.currentTarget);var a=!n.hasClass("sort_asc");return a?n.removeClass("sort_desc").addClass("sort_asc"):n.removeClass("sort_asc").addClass("sort_desc"),r.asc=a,t.options.pageEnabled?(r.page=1,t.load()):(t._data.sort(function(e,t){return c(e[s],t[s],a)}),t.rows.sort(function(e,t){var n=c(e.data[s],t.data[s],a);return n>0?t.$el.insertBefore(e.$el):0>n&&e.$el.insertBefore(t.$el),n})),!1},"click .grid_header .grid_spread,.grid_fold":function(e){var t=i(e.currentTarget);return t.hasClass("grid_spread")?(t.removeClass("grid_spread").addClass("grid_fold"),i.each(this.rows,function(e,t){t.spread()})):(t.removeClass("grid_fold").addClass("grid_spread"),i.each(this.rows,function(e,t){t.fold()})),!1},"click .grid_body .grid_spread,.grid_fold":function(e){var t=i(e.currentTarget);return t.hasClass("grid_spread")?this.rows[t.data("rowindex")].spread():this.rows[t.data("rowindex")].fold(),!1},"click .js_grid_selector":function(e){i(e.currentTarget);this.$el.find("input[name='__gs_"+this.cid+"']").prop({checked:this.checked});var n=this.checked?"select":"cancelSelect";if(this.selectedRows.length=0,this.selectedRow=!1,i.each(this.rows,function(e,t){t[n]()}),0==this.selectedRows.length)this.selectedRow=null;else{var r=this.selectedRows[0];r!=this.selectedRow&&(this.selectedRow=r)}return!1},"click .grid_row":function(e){var t=this.rows[i(e.currentTarget).data("index")];this.options.multiselect?e.target.name!="__gs_"+this.cid&&t[t.selected?"cancelSelect":"select"]():this.selectedRow!=t&&(this.selectedRow&&this.selectedRow.cancelSelect(),t.select())},"click .grid_tree":function(e){var t=this,n=i(e.currentTarget).closest(".grid_row"),r=n.data("treeid"),s=this.$el.find("[parenttree^='"+r+"_']");return n.hasClass("grid_tree_fold")?(n.removeClass("grid_tree_fold").addClass("grid_tree_spread"),u(s)):(n.removeClass("grid_tree_spread").addClass("grid_tree_fold"),s.each(function(e,n){n=i(n),t.$body.find('[data-treeid="'+n.data("treeid").replace(/_\d+$/,"")+'"]').hasClass("grid_tree_fold")&&h(n,t.options.rowHeight)})),!1},"blur .grid_cell_textbox":function(e){var t=i(e.currentTarget);return this.cell(t.data("row"),t.data("cell")).validate(),!1},"click .grid_selector":function(e){if(this.options.multiselect){var t=e.currentTarget,n=this.rows[i(t).data("row")];t.checked?n.select():n.cancelSelect()}},"click .grid_search":"search"},on:s.on,trigger:s.trigger,listen:s.listen,cell:function(e,t){return this.rows[e].cells[t]},ajaxSettings:{},el:'<div class="grid_cont"><div class="grid"><div class="grid_border_r"><div class="grid_header_cont"><ol class="grid_header"></ol></div><div class="grid_body"></div></div></div></div>',load:function(){},adjustWidth:function(){var o,e=this.options,t=e.columns.length-1,n=0,s=0,a=0,c=[];i.each(e.columns,function(e,t){t.width=parseInt(t.width),t.hide||(a+=t.width)});for(var u=0;t>u;u++)o=e.columns[u],n=Math.round(100*o.width/a),c[u]=n,s+=n;c[t]=r.ie?"auto":100-s,this.columnWidths=c},createHead:function(){var e=this,t=e.options,n=e.columnWidths;i.each(t.columns,function(r,s){var l,a="number"==typeof n[r]?n[r]+"%":n[r],o=i("<li></li>");s.index=r,s.height=t.rowHeight,"selector"==s.type&&t.multiselect?(l=i('<input class="js_grid_selector" type="checkbox" data-cid="'+e.cid+'" />').prop({checked:!1}),s.align="center",a=50):(l=i("<a>"+s.text+"</a>"),0==r&&t.children&&(i("<div class='grid_spread'></div>").append(l).appendTo(cell),s.align="left"),(s.sortAble||s.sortable)&&s.bind&&l.addClass("sortable").attr("data-bind",s.bind)),s.curWidth=a,o.append(l).css({textAlign:s.align,width:a,"float":"auto"==a?"none":""}).appendTo(e.$header)})},msg:function(e){var t=this.$body[0].offsetHeight||100;this.$body.html('<div style="border-bottom: 1px solid #cdcdcd;height:'+t+"px;line-height:"+t+'px;text-align:center">'+e+"</div>")},data:function(e){var t=this;return void 0===e?t._data:(t._data=e,null!=e&&e.length?(t.$body.html(""),void i.each(e,function(e,n){t.append(n)})):void t.msg("暂无数据"))},append:function(e,t,n){var r=this,s=r.options,a=new p(r,{data:e,index:r.rows.length});if(r.rows.push(a),"tree"!=s.type&&s.children){var o,l=i('<div class="grid_child_non"></div>').appendTo(r.$body);a.childContainer=l,a.children=[],i.each(s.children,function(t,n){"function"==typeof n.render?a.children.push(n.render(l,e,a)):(s.subKey&&(n.data=e[s.subKey]),o=new m(i("<div></div>").appendTo(l),n),o.parentRow=a,a.children.push(o))})}else"tree"==s.type&&(t=t||0,r.treeDeepRecord[t]=r.treeDeepRecord[t]?r.treeDeepRecord[t]+1:1,a.treeDeep=t,n=n||0,a.parentTreeId=n,a.treeId=n+"_"+r.treeDeepRecord[t],a.$el.attr({"data-treeid":subtree}));i.each(s.columns,function(e,t){a.append(t)}),r.$body.append(a.$el)},load:function(){var e=this,t=e.ajaxSettings,n=t.data;return e.msg("正在载入..."),e.page&&e.page.clear(),t.beforeSend&&t.beforeSend.call(e,n),i.ajax({url:t.url,type:t.type||"POST",data:n,dataType:"json",cache:!1,success:function(i){i.success?(e.data(i.data),e.options.pageEnabled&&(e.page.change({page:n.page,pageSize:n.pageSize,total:i.total}),e.trigger("PageChange",n.page)),t.success&&t.success.call(e,i.data)):e.msg("string"==typeof i.msg?i.msg:JSON.stringify(i.msg))},error:function(n){t.error?t.error.call(e,n):e.msg(n.responseText)}}),e},search:function(e){var t=this,n=i.extend(!0,{},t.ajaxSettings,!e||e.target?{}:e);t.ajaxSettings=n;var r=n.data||(n.data={});return t.options.pageEnabled&&(r.page=1,r.pageSize=t.options.pageSize),t.controls&&i.each(t.controls,function(e,t){r[e]=t.$el.val()}),t.load()},createSearch:function(){var e=this,t=this.options.search;if(e.ajaxSettings.data={},t){i.extend(e.ajaxSettings,r.pick(t,d));var n={},s=t.data;if(s&&i.each(s,function(t,r){i.isPlainObject(r)?(n[t]=r,s[t]=""):e.ajaxSettings.data[t]=r}),n&&!i.isEmptyObject(n)){e.controls=n;var a=i('<div class="search"></div>'),o=!1;i.each(n,function(t,r){r=i.extend({label:"",name:t,className:"text",type:"text",value:"",render:null,width:null,options:null,newLine:!1},r),r.newLine&&a.append("<br>"),r.label?i("<i>"+r.label+"</i>").appendTo(a):a.append(" ");var s=r.name,l={name:s,type:r.type};if(i.isFunction(r.render)){var c=r.render.call(e,a);"string"==typeof c&&a.append(c),l.type="render",l.$el=a.find('[name="'+s+'"]')}else"calendar"==r.type?(c=i('<input name="'+s+'" class="'+r.className+'" type="text"/>'),seajs.use(["./components/datepicker"],function(){c.datePicker(i.extend(r.options,{clickInput:!0}))})):"select"==r.type?(c=i('<select name="'+s+'"></select>'),i.isArray(r.options)&&i.each(r.options,function(e,t){c.each(function(){this.options.add(new Option(t.text,t.value))})}),r.change&&c.on("change",r.change)):c=i('<input type="'+r.type+'" name="'+s+'" class="'+r.className+'"/>'),r.width&&c.css({width:width}),c.appendTo(a).val(r.value),l.$el=c;"hidden"!=l.type&&(o=!0),n[t]=l}),o?e.$searchBtn=i('<button class="grid_search button">搜索</button>').appendTo(a):a.hide(),e.$search=a,e.$el.prepend(a)}}}},n.exports=m});define("components/page",["$","util"],function(e,t,n){function o(e){this.options=i.extend({id:"",page:1,pageSize:10,total:0,onChange:function(e){},msg:"共<%=total%>条数据&nbsp;&nbsp;每页<%=pageSize%>&nbsp;&nbsp;当前第<%=page%>/<%=totalPages%>页"},e),this.container=i(e.id),this.draw()}var i=e("$"),r=e("util"),s=r.template,a=function(e,t){return t=t||e,'<a href="javascript:void(0);" page="'+e+'">'+t+"</a>"};o.prototype={draw:function(){var e=this.options,t=this.container,n=e.pageSize||10;e.pageSize=n;var r=e.totalPages=(e.total-(e.total%n||n))/n+1;if(r>0){t.html(s(e.msg,e)),t=i("<div></div>").appendTo(t);var o="",l=parseInt(e.page),n=(e.total,e.pageSize),u=e.onChange,h=i.proxy(this._serialButtons,this);o+=1==l?"<span>第一页</span><span>上一页</span>":a(1,"第一页")+a(l-1,"上一页"),7>=r?o+=h(1,r):(o+=5>l?h(1,5)+"&nbsp;...&nbsp;":h(1,2)+"&nbsp;...&nbsp;"+(l+3>=r?h(r-4,r-1):h(l-1,l+2)+"&nbsp;...&nbsp;"),o+=h(r,r)),o+=r==l?"<span>下一页</span><span>最后一页</span>":a(l+1,"下一页")+a(r,"最后一页"),t.html(o).find("a").click(function(){u(this.getAttribute("page"))})}else t.html("共0条数据")},change:function(e){"number"==typeof e?this.options.page=page:i.extend(this.options,e),this.draw()},clear:function(){this.container.html("&nbsp;")},_serialButtons:function(e,t){var n=this.options.page;html="";for(var i=e;t>=i;i++)html+=i==n?"<span>"+i+"</span>":a(i);return html}},n.exports=o});define("widget/tip",["$","util","core/promise"],function(e,t){var n=e("$"),r=(e("util"),e("core/promise")),s=n('<div class="tip" style="display:none"></div>').on(n.fx.transitionEnd,function(){s.hasClass("tip-hide")&&s.hide()}).appendTo(document.body);t.promise=r.resolve(),t.msec=2e3,t.show=function(){s.hasClass("tip-show")||s.removeClass("tip-hide").show().addClass("tip-show")},t.msg=function(e){var t=this;t.promise.then(function(){return s.html(e),t.show(),setTimeout(function(){t.hide(),t.promise.resolve()},t.msec),this})},t.hide=function(){s.removeClass("tip-show").addClass("tip-hide")},sl.tip=function(e){t.msg(e)}});define("widget/dialog",["$","util","./../core/base","./../core/view"],function(e,t,n){var i=e("$"),r=e("util"),s=e("./../core/view"),a=null,o=s.extend({events:{"tap .js_dialog_btn":"action","tap .js_close_dialog":function(){this.hide()},touchmove:function(e){e.preventDefault()}},className:"dialog",el:"<div></div>",template:r.template('<%if(isShowClose){%><div class="dialog-close js_close_dialog"></div><%}%><%if(isShowTitle){%><div class="dialog-title"><h3 class="js_title"><%=title%></h3></div><%}%><div class="dialog-content js_content"><%=content%></div><div class="dialog-btns"><%for(var i=0,len=buttons.length,button;i<len;i++){button=buttons[i];%><a class="dialog-btn js_dialog_btn<%=button.className?" "+button.className:" "%>"><%=button.text%></a><%}%></div>'),options:{isShowClose:!1,isShowTitle:!0,title:null,content:null,buttons:[]},title:function(e){return"undefined"==typeof e?this.$title.html():(this.$title.html(e),this)},initialize:function(){var e=this,t=r.pick(e.options,["top","isShowClose","isShowTitle","title","content","buttons"]);e.$el.html(e.template(t)),e.$title=e.$(".js_title"),e.$content=e.$(".js_content")},action:function(e){this.options.buttons[i(e.currentTarget).index()].click.call(this,e)},hide:function(){var e=this;e._visible&&(e._visible=!1,a.hide(),e.$el.css({"-webkit-transform":"scale(1)",opacity:1}).animate({opacity:0,scale:0},300,"ease-out",function(){e.$el.hide(),e.trigger("Hide")}))},show:function(){var e=this;e._visible||(e._visible=!0,a||(a=i('<div style="position:absolute;top:0px;bottom:0px;right:0px;width:100%;background: rgba(0,0,0,.5);z-index:2000;display:none"></div>').appendTo(document.body)),a.show(),null==e.el.parentNode&&e.$el.appendTo(document.body),e.$el.css({"-webkit-transform":"",display:"block",top:this.options.top||"50%"}),e.$el.css({marginTop:this.$el.height()/-2,"-webkit-transform":"scale(0)",opacity:0}).animate({opacity:1,scale:1},300,"ease-out",function(){e.trigger("Show")}))},content:function(e){return"undefined"==typeof e?this.$content:void this.$content.html(e)}}),l=null;sl.prompt=function(e,t,n){t||(t=e,e="请输入"),l?l.title(e):l=new o({title:e,content:'<input type="text" class="prompt-text" /><input type="password" class="prompt-text" />'}),l.$("input.prompt-text").val("").hide().filter('[type="'+(n||"text")+'"]').show(),l.options.onOk=function(){return t.call(this,this.$('input[type="'+(n||"text")+'"].prompt-text').val())},l.options.onCancel=function(){t.call(this)},l.show(),i(window).one("hashchange",function(){l.hide()})};var c=null;return sl.confirm=function(e,t,n,r){var s={};i.isPlainObject(e)?(r=n,n=t,i.extend(s,e)):i.isFunction(t)?(r=n,n=t,s.content=e,s.title="确认提示"):(s.title=e,s.content=t),c?(c.title(s.title),c.$(".dialog-content").html(s.content),c.$(".js_hide").html(s.cancelText||"取消"),c.$(".js_ok").html(s.okText||"确定")):c=new o(s),c.options.onOk=function(){n.call(this)},c.options.onCancel=function(){r&&r.call(this)},c.show(),i(window).one("hashchange",function(){c.hide()})},o});