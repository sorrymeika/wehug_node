!function(e,t){function a(e){return function(t){return{}.toString.call(t)=="[object "+e+"]"}}function u(){return d++}function b(e){return e.match(p)[0]}function _(e){for(e=e.replace(h,"/");e.match(v);)e=e.replace(v,"/");return e=e.replace(g,"$1/")}function y(e){var t=e.length-1,i=e.charAt(t);return"#"===i?e.substring(0,t):".js"===e.substring(t-2)||e.indexOf("?")>0||".css"===e.substring(t-3)||"/"===i?e:e+".js"}function x(e){var i,t=n.paths;return t&&(i=e.match(T))&&l(t[i[1]])&&(e=t[i[1]]+i[2]),e}function $(e){var t=n.vars;return t&&e.indexOf("{")>-1&&(e=e.replace(w,function(e,i){return l(t[i])?t[i]:e})),e}function L(e){var t=n.map,i=e;if(t)for(var a=0,s=t.length;s>a;a++){var l=t[a];if(i=o(l)?l(e)||e:e.replace(l[0],l[1]),i!==e)break}return i}function j(e,t){var i,a=e.charAt(0);if(M.test(e))i=e;else if("."===a)i=_((t?b(t):n.cwd)+e);else if("/"===a){var s=n.cwd.match(H);i=s?s[0]+e.substring(1):e}else i=n.base+e;return 0===i.indexOf("//")&&(i=location.protocol+i),i}function A(e,t){if(!e)return"";var i=n.alias&&n.alias[e];i&&l(i)&&(e=i),e=x(e),e=$(e),e=y(e);var a=j(e,t);return a=L(a),!i||W[a]||l(i)||(W[a]={exports:i,status:te.EXECUTED,exec:ie.prototype.exec}),a}function N(e){return e.hasAttribute?e.src:e.getAttribute("src",4)}function R(e,t,i,n){var a=U.test(e),s=k.createElement(a?"link":"script");i&&(s.charset=i),c(n)||s.setAttribute("crossorigin",n),a?t():B(s,t,a,e),a?(s.rel="stylesheet",s.href=e):(s.async=!0,s.src=e),V=s,C?I.insertBefore(s,C):I.appendChild(s),V=null}function B(e,t,i,a){function l(){e.onload=e.onerror=e.onreadystatechange=null,i||n.debug||I.removeChild(e),e=null,t()}var s="onload"in e;s?(e.onload=l,e.onerror=function(){f("error",{uri:a,node:e}),l()}):e.onreadystatechange=function(){/loaded|complete/.test(e.readyState)&&l()}}function z(){if(V)return V;if(O&&"interactive"===O.readyState)return O;for(var e=I.getElementsByTagName("script"),t=e.length-1;t>=0;t--){var i=e[t];if("interactive"===i.readyState)return O=i}}function K(e){var t=[];return e.replace(F,"").replace(P,function(e,i,n){n&&t.push(n)}),t}function ie(e,t){this.uri=e,this.dependencies=t||[],this.exports=null,this.status=0,this._waitings={},this._remain=0}if(!e.seajs){var i=e.seajs={version:"2.2.3"},n=i.data={},s=a("Object"),l=a("String"),r=Array.isArray||a("Array"),o=a("Function"),c=a("Undefined"),d=0,m=n.events={};i.on=function(e,t){var n=m[e]||(m[e]=[]);return n.push(t),i},i.off=function(e,t){if(!e&&!t)return m=n.events={},i;var a=m[e];if(a)if(t)for(var s=a.length-1;s>=0;s--)a[s]===t&&a.splice(s,1);else delete m[e];return i};var f=i.emit=function(e,t){var a,n=m[e];if(n)for(n=n.slice();a=n.shift();)a(t);return i},p=/[^?#]*\//,h=/\/\.\//g,v=/\/[^/]+\/\.\.\//,g=/([^:/])\/\//g,T=/^([^/:]+)(\/.+)$/,w=/{([^{]+)}/g,M=/^\/\/.|:\//,H=/^.*?\/\/.*?\//,k=document,D=b(k.URL),E=k.scripts,q=k.getElementById("seajsnode")||E[E.length-1],S=b(N(q)||D);i.resolve=A;{var V,O,I=k.head||k.getElementsByTagName("head")[0]||k.documentElement,C=I.getElementsByTagName("base")[0],U=/\.css(?:\?|$)/i;+navigator.userAgent.replace(/.*(?:AppleWebKit|AndroidWebKit)\/(\d+).*/,"$1")<536}i.request=R;var J,P=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,F=/\\\\/g,W=i.cache={},Y={},Z={},ee={},te=ie.STATUS={FETCHING:1,SAVED:2,LOADING:3,LOADED:4,EXECUTING:5,EXECUTED:6};ie.prototype.resolve=function(){for(var e=this,t=e.dependencies,i=[],n=0,a=t.length;a>n;n++)i[n]=ie.resolve(t[n],e.uri);return i},ie.prototype.load=function(){var e=this;if(!(e.status>=te.LOADING)){e.status=te.LOADING;var t=e.resolve();f("load",t);for(var n,i=e._remain=t.length,a=0;i>a;a++)n=ie.get(t[a]),n.status<te.LOADED?n._waitings[e.uri]=(n._waitings[e.uri]||0)+1:e._remain--;if(0===e._remain)return void e.onload();var s={};for(a=0;i>a;a++)n=W[t[a]],n.status<te.FETCHING?n.fetch(s):n.status===te.SAVED&&n.load();for(var l in s)s.hasOwnProperty(l)&&s[l]()}},ie.prototype.onload=function(){var e=this;e.status=te.LOADED,e.callback&&e.callback();var i,n,t=e._waitings;for(i in t)t.hasOwnProperty(i)&&(n=W[i],n._remain-=t[i],0===n._remain&&n.onload());delete e._waitings,delete e._remain},ie.prototype.fetch=function(e){function r(){i.request(s.requestUri,s.onRequest,s.charset,s.crossorigin)}function c(){delete Y[l],Z[l]=!0,J&&(ie.save(a,J),J=null);var e,t=ee[l];for(delete ee[l];e=t.shift();)e.load()}var t=this,a=t.uri;t.status=te.FETCHING;var s={uri:a};f("fetch",s);var l=s.requestUri||a;return!l||Z[l]?void t.load():Y[l]?void ee[l].push(t):(Y[l]=!0,ee[l]=[t],f("request",s={uri:a,requestUri:l,onRequest:c,charset:o(n.charset)?n.charset(l):n.charset,crossorigin:o(n.crossorigin)?n.crossorigin(l):n.crossorigin}),void(s.requested||(e?e[s.requestUri]=r:r())))},ie.prototype.exec=function(){function n(e){return ie.get(n.resolve(e)).exec()}var e=this;if(e.status>=te.EXECUTING)return e.exports;e.status=te.EXECUTING;var i=e.uri;n.resolve=function(e){return ie.resolve(e,i)},n.async=function(e,t){return ie.use(e,t,i+"_async_"+u()),n};var a=e.factory,s=o(a)?a(n,e.exports={},e):a;return s===t&&(s=e.exports),delete e.factory,e.exports=s,e.status=te.EXECUTED,f("exec",e),s},ie.resolve=function(e,t){var n={id:e,refUri:t};return f("resolve",n),n.uri||i.resolve(n.id,t)},ie.define=function(e,i,n){var a=arguments.length;1===a?(n=e,e=t):2===a&&(n=i,r(e)?(i=e,e=t):i=t),!r(i)&&o(n)&&(i=K(n.toString()));var s={id:e,uri:ie.resolve(e),deps:i,factory:n};if(!s.uri&&k.attachEvent){var l=z();l&&(s.uri=l.src.replace(/\?.*/g,""))}f("define",s),s.uri?ie.save(s.uri,s):J=s},ie.save=function(e,t){var i=ie.get(e);i.status<te.SAVED&&(i.id=t.id||e,i.dependencies=t.deps||[],i.factory=t.factory,i.status=te.SAVED)},ie.get=function(e,t){return W[e]||(W[e]=new ie(e,t))},ie.use=function(t,i,n){var a=ie.get(n,r(t)?t:[t]);a.callback=function(){for(var t=[],n=a.resolve(),s=0,l=n.length;l>s;s++)t[s]=W[n[s]].exec();i&&i.apply(e,t),delete a.callback},a.load()},ie.preload=function(e){var t=n.preload,i=t.length;i?ie.use(t,function(){t.splice(0,i),ie.preload(e)},n.cwd+"_preload_"+u()):e()},i.use=function(e,t){return ie.preload(function(){ie.use(e,t,n.cwd+"_use_"+u())}),i},ie.define.cmd={},e.define=ie.define,i.Module=ie,n.fetchedList=Z,n.cid=u,i.require=function(e){var t=ie.get(ie.resolve(e));return t.status<te.EXECUTING&&(t.onload(),t.exec()),t.exports};var ne=/^(.+?\/)(\?\?)?(seajs\/)+/;n.base=(S.match(ne)||["",S])[1],n.dir=S,n.cwd=D,n.charset="utf-8",n.preload=function(){var e=[],t=location.search.replace(/(seajs-\w+)(&|$)/g,"$1=1$2");return t+=" "+k.cookie,t.replace(/(seajs-\w+)=1/g,function(t,i){e.push(i)}),e}(),i.config=function(e){for(var t in e){var a=e[t],l=n[t];if(l&&s(l))for(var o in a)l[o]=a[o];else r(l)?a=l.concat(a):"base"===t&&("/"!==a.slice(-1)&&(a+="/"),a=j(a)),n[t]=a}return f("config",e),i}}}(this);var Zepto=function(){function N(e){return null==e?String(e):T[j.call(e)]||"object"}function H(e){return"function"==N(e)}function D(e){return null!=e&&e==e.window}function C(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function k(e){return"object"==N(e)}function O(e){return k(e)&&!D(e)&&Object.getPrototypeOf(e)==Object.prototype}function q(e){return"number"==typeof e.length}function P(e){return a.call(e,function(e){return null!=e})}function I(e){return e.length>0?n.fn.concat.apply([],e):e}function R(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function U(e){return e in c?c[e]:c[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function V(e,t){return"number"!=typeof t||u[R(e)]?t:t+"px"}function Z(e){var t,n;return l[e]||(t=s.createElement(e),s.body.appendChild(t),n=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==n&&(n="block"),l[e]=n),l[e]}function z(e){return"children"in e?o.call(e.children):n.map(e.childNodes,function(e){return 1==e.nodeType?e:void 0})}function F(n,i,r){for(t in i)r&&(O(i[t])||A(i[t]))?(O(i[t])&&!O(n[t])&&(n[t]={}),A(i[t])&&!A(n[t])&&(n[t]=[]),F(n[t],i[t],r)):i[t]!==e&&(n[t]=i[t])}function B(e,t){return null==t?n(e):n(e).filter(t)}function X(e,t,n,i){return H(t)?t.call(e,n,i):t}function G(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function J(t,n){var i=t.className,r=i&&i.baseVal!==e;return n===e?r?i.baseVal:i:void(r?i.baseVal=n:t.className=n)}function W(e){var t;try{return e?"true"==e||("false"==e?!1:"null"==e?null:/^0/.test(e)||isNaN(t=Number(e))?/^[\[\{]/.test(e)?n.parseJSON(e):e:t):e}catch(i){return e}}function Y(e,t){t(e);for(var n in e.childNodes)Y(e.childNodes[n],t)}var e,t,n,i,$,L,r=[],o=r.slice,a=r.filter,s=window.document,l={},c={},u={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},d=/^\s*<(\w+|!)[^>]*>/,f=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,h=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,p=/^(?:body|html)$/i,m=/([A-Z])/g,v=["val","css","html","text","data","width","height","offset"],g=["after","prepend","before","append"],y=s.createElement("table"),b=s.createElement("tr"),_={tr:s.createElement("tbody"),tbody:y,thead:y,tfoot:y,td:b,th:b,"*":s.createElement("div")},x=/complete|loaded|interactive/,w=/^[\w-]*$/,T={},j=T.toString,E={},S=s.createElement("div"),M={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},A=Array.isArray||function(e){return e instanceof Array};return E.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var i,r=e.parentNode,o=!r;return o&&(r=S).appendChild(e),i=~E.qsa(r,t).indexOf(e),o&&S.removeChild(e),i},$=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},L=function(e){return a.call(e,function(t,n){return e.indexOf(t)==n})},E.fragment=function(t,i,r){var a,l,c;return f.test(t)&&(a=n(s.createElement(RegExp.$1))),a||(t.replace&&(t=t.replace(h,"<$1></$2>")),i===e&&(i=d.test(t)&&RegExp.$1),i in _||(i="*"),c=_[i],c.innerHTML=""+t,a=n.each(o.call(c.childNodes),function(){c.removeChild(this)})),O(r)&&(l=n(a),n.each(r,function(e,t){v.indexOf(e)>-1?l[e](t):l.attr(e,t)})),a},E.Z=function(e,t){return e=e||[],e.__proto__=n.fn,e.selector=t||"",e},E.isZ=function(e){return e instanceof E.Z},E.init=function(t,i){var r;if(!t)return E.Z();if("string"==typeof t)if(t=t.trim(),"<"==t[0]&&d.test(t))r=E.fragment(t,RegExp.$1,i),t=null;else{if(i!==e)return n(i).find(t);r=E.qsa(s,t)}else{if(H(t))return n(s).ready(t);if(E.isZ(t))return t;if(A(t))r=P(t);else if(k(t))r=[t],t=null;else if(d.test(t))r=E.fragment(t.trim(),RegExp.$1,i),t=null;else{if(i!==e)return n(i).find(t);r=E.qsa(s,t)}}return E.Z(r,t)},n=function(e,t){return E.init(e,t)},n.extend=function(e){var t,n=o.call(arguments,1);return"boolean"==typeof e&&(t=e,e=n.shift()),n.forEach(function(n){F(e,n,t)}),e},E.qsa=function(e,t){var n,i="#"==t[0],r=!i&&"."==t[0],a=i||r?t.slice(1):t,s=w.test(a);return C(e)&&s&&i?(n=e.getElementById(a))?[n]:[]:1!==e.nodeType&&9!==e.nodeType?[]:o.call(s&&!i?r?e.getElementsByClassName(a):e.getElementsByTagName(t):e.querySelectorAll(t))},n.contains=function(e,t){return e!==t&&e.contains(t)},n.type=N,n.isFunction=H,n.isWindow=D,n.isArray=A,n.isPlainObject=O,n.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},n.inArray=function(e,t,n){return r.indexOf.call(t,e,n)},n.camelCase=$,n.trim=function(e){return null==e?"":String.prototype.trim.call(e)},n.uuid=0,n.support={},n.expr={},n.map=function(e,t){var n,r,o,i=[];if(q(e))for(r=0;r<e.length;r++)n=t(e[r],r),null!=n&&i.push(n);else for(o in e)n=t(e[o],o),null!=n&&i.push(n);return I(i)},n.each=function(e,t){var n,i;if(q(e)){for(n=0;n<e.length;n++)if(t.call(e[n],n,e[n])===!1)return e}else for(i in e)if(t.call(e[i],i,e[i])===!1)return e;return e},n.grep=function(e,t){return a.call(e,t)},window.JSON&&(n.parseJSON=JSON.parse),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){T["[object "+t+"]"]=t.toLowerCase()}),n.fn={forEach:r.forEach,reduce:r.reduce,push:r.push,sort:r.sort,indexOf:r.indexOf,concat:r.concat,map:function(e){return n(n.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return n(o.apply(this,arguments))},ready:function(e){return x.test(s.readyState)&&s.body?e(n):s.addEventListener("DOMContentLoaded",function(){e(n)},!1),this},get:function(t){return t===e?o.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return r.every.call(this,function(t,n){return e.call(t,n,t)!==!1}),this},filter:function(e){return H(e)?this.not(this.not(e)):n(a.call(this,function(t){return E.matches(t,e)}))},add:function(e,t){return n(L(this.concat(n(e,t))))},is:function(e){return this.length>0&&E.matches(this[0],e)},not:function(t){var i=[];if(H(t)&&t.call!==e)this.each(function(e){t.call(this,e)||i.push(this)});else{var r="string"==typeof t?this.filter(t):q(t)&&H(t.item)?o.call(t):n(t);this.forEach(function(e){r.indexOf(e)<0&&i.push(e)})}return n(i)},has:function(e){return this.filter(function(){return k(e)?n.contains(this,e):n(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!k(e)?e:n(e)},last:function(){var e=this[this.length-1];return e&&!k(e)?e:n(e)},find:function(e){var t,i=this;return t="object"==typeof e?n(e).filter(function(){var e=this;return r.some.call(i,function(t){return n.contains(t,e)})}):1==this.length?n(E.qsa(this[0],e)):this.map(function(){return E.qsa(this,e)})},closest:function(e,t){var i=this[0],r=!1;for("object"==typeof e&&(r=n(e));i&&!(r?r.indexOf(i)>=0:E.matches(i,e));)i=i!==t&&!C(i)&&i.parentNode;return n(i)},parents:function(e){for(var t=[],i=this;i.length>0;)i=n.map(i,function(e){return(e=e.parentNode)&&!C(e)&&t.indexOf(e)<0?(t.push(e),e):void 0});return B(t,e)},parent:function(e){return B(L(this.pluck("parentNode")),e)},children:function(e){return B(this.map(function(){return z(this)}),e)},contents:function(){return this.map(function(){return o.call(this.childNodes)})},siblings:function(e){return B(this.map(function(e,t){return a.call(z(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return n.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=Z(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var t=H(e);if(this[0]&&!t)var i=n(e).get(0),r=i.parentNode||this.length>1;return this.each(function(o){n(this).wrapAll(t?e.call(this,o):r?i.cloneNode(!0):i)})},wrapAll:function(e){if(this[0]){n(this[0]).before(e=n(e));for(var t;(t=e.children()).length;)e=t.first();n(e).append(this)}return this},wrapInner:function(e){var t=H(e);return this.each(function(i){var r=n(this),o=r.contents(),a=t?e.call(this,i):e;o.length?o.wrapAll(a):r.append(a)})},unwrap:function(){return this.parent().each(function(){n(this).replaceWith(n(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var i=n(this);(t===e?"none"==i.css("display"):t)?i.show():i.hide()})},prev:function(e){return n(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return n(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0===arguments.length?this.length>0?this[0].innerHTML:null:this.each(function(t){var i=this.innerHTML;n(this).empty().append(X(this,e,t,i))})},text:function(t){return 0===arguments.length?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=t===e?"":""+t})},attr:function(n,i){var r;return"string"==typeof n&&i===e?0==this.length||1!==this[0].nodeType?e:"value"==n&&"INPUT"==this[0].nodeName?this.val():!(r=this[0].getAttribute(n))&&n in this[0]?this[0][n]:r:this.each(function(e){if(1===this.nodeType)if(k(n))for(t in n)G(this,t,n[t]);else G(this,n,X(this,i,e,this.getAttribute(n)))})},removeAttr:function(e){return this.each(function(){1===this.nodeType&&G(this,e)})},prop:function(t,n){return t=M[t]||t,n===e?this[0]&&this[0][t]:this.each(function(e){this[t]=X(this,n,e,this[t])})},data:function(t,n){t="data-"+t.replace(m,"-$1").toLowerCase();var i=this[0];if(i._data_cache||(i._data_cache={}),n===e){var r=i._data_cache[t]||(i._data_cache[t]=W(i.getAttribute(t)));return r}return i._data_cache[t]=n,H(n)||E.isZ(n)?this:this.attr(t,n)},val:function(e){return 0===arguments.length?this[0]&&(this[0].multiple?n(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(t){this.value=X(this,e,t,this.value)})},offset:function(e){if(e)return this.each(function(t){var i=n(this),r=X(this,e,t,i.offset()),o=i.offsetParent().offset(),a={top:r.top-o.top,left:r.left-o.left};"static"==i.css("position")&&(a.position="relative"),i.css(a)});if(0==this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(e,i){if(arguments.length<2){var r=this[0],o=getComputedStyle(r,"");if(!r)return;if("string"==typeof e)return r.style[$(e)]||o.getPropertyValue(e);if(A(e)){var a={};return n.each(A(e)?e:[e],function(e,t){a[t]=r.style[$(t)]||o.getPropertyValue(t)}),a}}var s="";if("string"==N(e))i||0===i?s=R(e)+":"+V(e,i):this.each(function(){this.style.removeProperty(R(e))});else for(t in e)e[t]||0===e[t]?s+=R(t)+":"+V(t,e[t])+";":this.each(function(){this.style.removeProperty(R(t))});return this.each(function(){this.style.cssText+=";"+s})},index:function(e){return e?this.indexOf(n(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return e?r.some.call(this,function(e){return this.test(J(e))},U(e)):!1},addClass:function(e){return e?this.each(function(t){i=[];var r=J(this),o=X(this,e,t,r);o.split(/\s+/g).forEach(function(e){n(this).hasClass(e)||i.push(e)},this),i.length&&J(this,r+(r?" ":"")+i.join(" "))}):this},removeClass:function(t){return this.each(function(n){return t===e?J(this,""):(i=J(this),X(this,t,n,i).split(/\s+/g).forEach(function(e){i=i.replace(U(e)," ")}),void J(this,i.trim()))})},toggleClass:function(t,i){return t?this.each(function(r){var o=n(this),a=X(this,t,r,J(this));a.split(/\s+/g).forEach(function(t){(i===e?!o.hasClass(t):i)?o.addClass(t):o.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var n="scrollTop"in this[0];return t===e?n?this[0].scrollTop:this[0].pageYOffset:this.each(n?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var n="scrollLeft"in this[0];return t===e?n?this[0].scrollLeft:this[0].pageXOffset:this.each(n?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),i=this.offset(),r=p.test(t[0].nodeName)?{top:0,left:0}:t.offset();return i.top-=parseFloat(n(e).css("margin-top"))||0,i.left-=parseFloat(n(e).css("margin-left"))||0,r.top+=parseFloat(n(t[0]).css("border-top-width"))||0,r.left+=parseFloat(n(t[0]).css("border-left-width"))||0,{top:i.top-r.top,left:i.left-r.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||s.body;e&&!p.test(e.nodeName)&&"static"==n(e).css("position");)e=e.offsetParent;return e})}},n.fn.detach=n.fn.remove,["width","height"].forEach(function(t){var i=t.replace(/./,function(e){return e[0].toUpperCase()});n.fn[t]=function(r){var o,a=this[0];return r===e?D(a)?a["inner"+i]:C(a)?a.documentElement["scroll"+i]:(o=this.offset())&&o[t]:this.each(function(e){a=n(this),a.css(t,X(this,r,e,a[t]()))})}}),g.forEach(function(e,t){var i=t%2;n.fn[e]=function(){var e,o,r=n.map(arguments,function(t){return e=N(t),"object"==e||"array"==e||null==t?t:E.fragment(t)}),a=this.length>1;return r.length<1?this:this.each(function(e,s){o=i?s:s.parentNode,s=0==t?s.nextSibling:1==t?s.firstChild:2==t?s:null,r.forEach(function(e){if(a)e=e.cloneNode(!0);else if(!o)return n(e).remove();Y(o.insertBefore(e,s),function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)})})})},n.fn[i?e+"To":"insert"+(t?"Before":"After")]=function(t){return n(t)[e](this),this}}),E.Z.prototype=n.fn,E.uniq=L,E.deserializeValue=W,n.zepto=E,n}();window.Zepto=Zepto,void 0===window.$&&(window.$=Zepto),function(e){function d(e){return e._zid||(e._zid=t++)}function f(e,t,n,i){if(t=h(t),t.ns)var r=p(t.ns);return(a[d(e)]||[]).filter(function(e){return!(!e||t.e&&e.e!=t.e||t.ns&&!r.test(e.ns)||n&&d(e.fn)!==d(n)||i&&e.sel!=i)})}function h(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function p(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function m(e,t){return e.del&&!l&&e.e in c||!!t}function v(e){return u[e]||l&&c[e]||e}function g(t,i,r,o,s,l,c){var f=d(t),p=a[f]||(a[f]=[]);i.split(/\s/).forEach(function(i){if("ready"==i)return e(document).ready(r);var a=h(i);a.fn=r,a.sel=s,a.e in u&&(r=function(t){var n=t.relatedTarget;return!n||n!==this&&!e.contains(this,n)?a.fn.apply(this,arguments):void 0}),a.del=l;var d=l||r;a.proxy=function(e){if(e=T(e),!e.isImmediatePropagationStopped()){e.data=o;var i=d.apply(t,e._args==n?[e]:[e].concat(e._args));return i===!1&&(e.preventDefault(),e.stopPropagation()),i}},a.i=p.length,p.push(a),"addEventListener"in t&&t.addEventListener(v(a.e),a.proxy,m(a,c))})}function y(e,t,n,i,r){var o=d(e);(t||"").split(/\s/).forEach(function(t){f(e,t,n,i).forEach(function(t){delete a[o][t.i],"removeEventListener"in e&&e.removeEventListener(v(t.e),t.proxy,m(t,r))})})}function T(t,i){return(i||!t.isDefaultPrevented)&&(i||(i=t),e.each(w,function(e,n){var r=i[e];t[e]=function(){return this[n]=b,r&&r.apply(i,arguments)},t[n]=_}),(i.defaultPrevented!==n?i.defaultPrevented:"returnValue"in i?i.returnValue===!1:i.getPreventDefault&&i.getPreventDefault())&&(t.isDefaultPrevented=b)),t}function j(e){var t,i={originalEvent:e};for(t in e)x.test(t)||e[t]===n||(i[t]=e[t]);return T(i,e)}var n,t=1,i=Array.prototype.slice,r=e.isFunction,o=function(e){return"string"==typeof e},a={},s={},l="onfocusin"in window,c={focus:"focusin",blur:"focusout"},u={mouseenter:"mouseover",mouseleave:"mouseout"};s.click=s.mousedown=s.mouseup=s.mousemove="MouseEvents",e.event={add:g,remove:y},e.proxy=function(t,n){if(r(t)){var i=function(){return t.apply(n,arguments)};return i._zid=d(t),i}if(o(n))return e.proxy(t[n],t);throw new TypeError("expected function")},e.fn.bind=function(e,t,n){return this.on(e,t,n)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,n,i){return this.on(e,t,n,i,1)};var b=function(){return!0},_=function(){return!1},x=/^([A-Z]|returnValue$|layer[XY]$)/,w={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(e,t,n){return this.on(t,e,n)},e.fn.undelegate=function(e,t,n){return this.off(t,e,n)},e.fn.live=function(t,n){return e(document.body).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(document.body).undelegate(this.selector,t,n),this},e.fn.on=function(t,a,s,l,c){var u,d,f=this;return t&&!o(t)?(e.each(t,function(e,t){f.on(e,a,s,t,c)}),f):(o(a)||r(l)||l===!1||(l=s,s=a,a=n),(r(s)||s===!1)&&(l=s,s=n),l===!1&&(l=_),f.each(function(n,r){c&&(u=function(e){return y(r,e.type,l),l.apply(this,arguments)}),a&&(d=function(t){var n,o=e(t.target).closest(a,r).get(0);return o&&o!==r?(n=e.extend(j(t),{currentTarget:o,liveFired:r}),(u||l).apply(o,[n].concat(i.call(arguments,1)))):void 0}),g(r,t,l,s,a,d||u)}))},e.fn.off=function(t,i,a){var s=this;return t&&!o(t)?(e.each(t,function(e,t){s.off(e,i,t)}),s):(o(i)||r(a)||a===!1||(a=i,i=n),a===!1&&(a=_),s.each(function(){y(this,t,a,i)}))},e.fn.trigger=function(t,n){return t=o(t)||e.isPlainObject(t)?e.Event(t):T(t),t._args=n,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,n)})},e.fn.triggerHandler=function(t,n){var i,r;return this.each(function(a,s){i=j(o(t)?e.Event(t):t),i._args=n,i.target=s,e.each(f(s,t.type||t),function(e,t){return r=t.proxy(i),i.isImmediatePropagationStopped()?!1:void 0})}),r},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.trigger(t)}}),["focus","blur"].forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.each(function(){try{this[t]()}catch(e){}}),this}}),e.Event=function(e,t){o(e)||(t=e,e=t.type);var n=document.createEvent(s[e]||"Events"),i=!0;if(t)for(var r in t)"bubbles"==r?i=!!t[r]:n[r]=t[r];return n.initEvent(e,i,!0),T(n)}}(Zepto),function(e){function d(t,n,i){var r=e.Event(n);return e(t).trigger(r,i),!r.isDefaultPrevented()}function f(e,t,i,r){return e.global?d(t||n,i,r):void 0}function h(t){t.global&&0===e.active++&&f(t,null,"ajaxStart")}function p(t){t.global&&!--e.active&&f(t,null,"ajaxStop")}function m(e,t){var n=t.context;return t.beforeSend.call(n,e,t)===!1||f(t,n,"ajaxBeforeSend",[e,t])===!1?!1:void f(t,n,"ajaxSend",[e,t])}function v(e,t,n,i){var r=n.context,o="success";n.success.call(r,e,o,t),i&&i.resolveWith(r,[e,o,t]),f(n,r,"ajaxSuccess",[t,n,e]),y(o,t,n)}function g(e,t,n,i,r){var o=i.context;i.error.call(o,n,t,e),r&&r.rejectWith(o,[n,t,e]),f(i,o,"ajaxError",[n,i,e||t]),y(t,n,i)}function y(e,t,n){var i=n.context;n.complete.call(i,t,e),f(n,i,"ajaxComplete",[t,n]),p(n)}function b(){}function _(e){return e&&(e=e.split(";",2)[0]),e&&(e==c?"html":e==l?"json":a.test(e)?"script":s.test(e)&&"xml")||"text"}function x(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function w(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=x(t.url,t.data),t.data=void 0)}function T(t,n,i,r){return e.isFunction(n)&&(r=i,i=n,n=void 0),e.isFunction(i)||(r=i,i=void 0),{url:t,data:n,success:i,dataType:r}}function E(t,n,i,r){var o,a=e.isArray(n),s=e.isPlainObject(n);e.each(n,function(n,l){o=e.type(l),r&&(n=i?r:r+"["+(s||"object"==o||"array"==o?n:"")+"]"),!r&&a?t.add(l.name,l.value):"array"==o||!i&&"object"==o?E(t,l,i,n):t.add(n,l)})}var i,r,t=0,n=window.document,o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,a=/^(?:text|application)\/javascript/i,s=/^(?:text|application)\/xml/i,l="application/json",c="text/html",u=/^\s*$/;e.active=0,e.ajaxJSONP=function(i,r){if(!("type"in i))return e.ajax(i);var c,f,o=i.jsonpCallback,a=(e.isFunction(o)?o():o)||"jsonp"+ ++t,s=n.createElement("script"),l=window[a],u=function(t){e(s).triggerHandler("error",t||"abort")},d={abort:u};return r&&r.promise(d),e(s).on("load error",function(t,n){clearTimeout(f),e(s).off().remove(),"error"!=t.type&&c?v(c[0],d,i,r):g(null,n||"error",d,i,r),window[a]=l,c&&e.isFunction(l)&&l(c[0]),l=c=void 0}),m(d,i)===!1?(u("abort"),d):(window[a]=function(){c=arguments},s.src=i.url.replace(/\?(.+)=\?/,"?$1="+a),n.head.appendChild(s),i.timeout>0&&(f=setTimeout(function(){u("timeout")},i.timeout)),d)},e.ajaxSettings={type:"GET",beforeSend:b,success:b,error:b,complete:b,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:l,xml:"application/xml, text/xml",html:c,text:"text/plain"},crossDomain:!0,timeout:0,processData:!0,cache:!0},e.ajax=function(t){var n=e.extend({},t||{}),o=e.Deferred&&e.Deferred();for(i in e.ajaxSettings)void 0===n[i]&&(n[i]=e.ajaxSettings[i]);h(n),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host),n.url||(n.url=window.location.toString()),w(n),n.cache===!1&&(n.url=x(n.url,"_="+Date.now()));var a=n.dataType,s=/\?.+=\?/.test(n.url);if("jsonp"==a||s)return s||(n.url=x(n.url,n.jsonp?n.jsonp+"=?":n.jsonp===!1?"":"callback=?")),e.ajaxJSONP(n,o);var T,l=n.accepts[a],c={},d=function(e,t){c[e.toLowerCase()]=[e,t]},f=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,p=n.xhr(),y=p.setRequestHeader;if(o&&o.promise(p),n.crossDomain||d("X-Requested-With","XMLHttpRequest"),d("Accept",l||"*/*"),(l=n.mimeType||l)&&(l.indexOf(",")>-1&&(l=l.split(",",2)[0]),p.overrideMimeType&&p.overrideMimeType(l)),(n.contentType||n.contentType!==!1&&n.data&&"GET"!=n.type.toUpperCase())&&d("Content-Type",n.contentType||"application/x-www-form-urlencoded"),n.headers)for(r in n.headers)d(r,n.headers[r]);if(p.setRequestHeader=d,p.onreadystatechange=function(){if(4==p.readyState){p.onreadystatechange=b,clearTimeout(T);var t,i=!1;if(p.status>=200&&p.status<300||304==p.status||0==p.status&&"file:"==f){a=a||_(n.mimeType||p.getResponseHeader("content-type")),t=p.responseText;try{"script"==a?(1,eval)(t):"xml"==a?t=p.responseXML:"json"==a&&(t=u.test(t)?null:e.parseJSON(t))}catch(r){i=r}i?g(i,"parsererror",p,n,o):v(t,p,n,o)}else g(p.statusText||null,p.status?"error":"abort",p,n,o)}},m(p,n)===!1)return p.abort(),g(null,"abort",p,n,o),p;if(n.xhrFields)for(r in n.xhrFields)p[r]=n.xhrFields[r];var j="async"in n?n.async:!0;p.open(n.type,n.url,j,n.username,n.password);for(r in c)y.apply(p,c[r]);return n.timeout>0&&(T=setTimeout(function(){p.onreadystatechange=b,p.abort(),g(null,"timeout",p,n,o)},n.timeout)),p.send(n.data?n.data:null),p},e.get=function(){return e.ajax(T.apply(null,arguments))},e.post=function(){var t=T.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=T.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,n,i){if(!this.length)return this;var s,r=this,a=t.split(/\s/),l=T(t,n,i),c=l.success;return a.length>1&&(l.url=a[0],s=a[1]),l.success=function(t){r.html(s?e("<div>").html(t.replace(o,"")).find(s):t),c&&c.apply(r,arguments)},e.ajax(l),this};var j=encodeURIComponent;e.param=function(e,t){var n=[];return n.add=function(e,t){this.push(j(e)+"="+j(null===t||void 0===t?"":t))},E(n,e,t),n.join("&").replace(/%20/g,"+")}}(Zepto),function(e){e.fn.serializeArray=function(){var n,t=[];return e([].slice.call(this.get(0).elements)).each(function(){n=e(this);var i=n.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&("radio"!=i&&"checkbox"!=i||this.checked)&&t.push({name:n.attr("name"),value:n.val()})}),t},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(t)this.bind("submit",t);else if(this.length){var n=e.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),function(e){"__proto__"in{}||e.extend(e.zepto,{Z:function(t,n){return t=t||[],e.extend(t,e.fn),t.selector=n||"",t.__Z=!0,t},isZ:function(t){return"array"===e.type(t)&&"__Z"in t}});try{getComputedStyle(void 0)}catch(t){var n=getComputedStyle;window.getComputedStyle=function(e){try{return n(e)}catch(t){return null}}}}(Zepto),define&&define("zepto",[],function(){return Zepto});!function(t,e){function _(t){return t.replace(/([a-z])([A-Z])/,"$1-$2").toLowerCase()}function x(t){return i?i+t:t.toLowerCase()}var i,u,d,f,h,p,m,v,g,y,n="",a={Webkit:"webkit",Moz:"",O:"o"},s=window.document,l=s.createElement("div"),c=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,b={};t.each(a,function(t,r){return l.style[t+"TransitionProperty"]!==e?(n="-"+t.toLowerCase()+"-",i=r,!1):void 0}),u=n+"transform",b[d=n+"transition-property"]=b[f=n+"transition-duration"]=b[p=n+"transition-delay"]=b[h=n+"transition-timing-function"]=b[m=n+"animation-name"]=b[v=n+"animation-duration"]=b[y=n+"animation-delay"]=b[g=n+"animation-timing-function"]="",t.fx={off:i===e&&l.style.transitionProperty===e,speeds:{_default:400,fast:200,slow:600},cssPrefix:n,transitionEnd:x("TransitionEnd"),animationEnd:x("AnimationEnd")},t.fn.animate=function(n,i,r,o,a){return t.isFunction(i)&&(o=i,r=e,i=e),t.isFunction(r)&&(o=r,r=e),t.isPlainObject(i)&&(r=i.easing,o=i.complete,a=i.delay,i=i.duration),i&&(i=("number"==typeof i?i:t.fx.speeds[i]||t.fx.speeds._default)/1e3),a&&(a=parseFloat(a)/1e3),this.anim(n,i,r,o,a)},t.fn.anim=function(n,i,r,o,a){var s,x,E,l={},w="",T=this,j=t.fx.transitionEnd,$=!1;if(i===e&&(i=t.fx.speeds._default/1e3),a===e&&(a=0),t.fx.off&&(i=0),"string"==typeof n)l[m]=n,l[v]=i+"s",l[y]=a+"s",l[g]=r||"linear",j=t.fx.animationEnd;else{x=[];for(s in n)c.test(s)?w+=s+"("+n[s]+") ":(l[s]=n[s],x.push(_(s)));w&&(l[u]=w,x.push(u)),i>0&&"object"==typeof n&&(l[d]=x.join(", "),l[f]=i+"s",l[p]=a+"s",l[h]=r||"linear")}return E=function(e){if("undefined"!=typeof e){if(e.target!==e.currentTarget)return;t(e.target).unbind(j,E)}else t(this).unbind(j,E);$=!0,t(this).css(b),o&&o.call(this)},i>0&&(this.bind(j,E),setTimeout(function(){$||E.call(T)},1e3*i+25)),this.size()&&this.get(0).clientLeft,this.css(l),0>=i&&setTimeout(function(){T.each(function(){E.call(this)})},0),this},l=null}(Zepto);define("util",[],function(){var c,e=Array.prototype,t=e.slice,n=e.concat,i=navigator.userAgent,r=i.match(/(iPhone|iPad|iPod).*OS\s([\d_]+)/i),o=i.match(/MSIE (\d+)/i),a=i.match(/(Android);?[\s\/]+([\d.]+)?/),s=!!a,l=0;r?c=r[2].split("_"):a?c=a[2].split("."):o&&(c=o[1].split("."));var u=function(e,t){var n="0000000000000000"+e;return n.substr(n.length-(t||2))},f={isInApp:/SLApp/.test(i),ios:!!r,ie:!!o,android:s,osVersion:c?parseFloat(c[0]+"."+c[1]):0,isInWechat:/micromessenger/i.test(navigator.userAgent),guid:function(){return++l},isFalse:function(e){return!e||$.isArray(e)&&!e||"object"==typeof e&&f.isEmptyObject(e)},isTrue:function(e){return!this.isFalse(e)},isEmptyObject:function(e){for(var t in e)return!1;return!0},extend:function(e){var t=this,n=function(){t.apply(this,arguments)},i=function(){this.constructor=n};i.prototype=t.prototype,n.prototype=new i;for(var r in e)n.prototype[r]=e[r];for(var r in t)n[r]=t[r];return n},random:function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},log:function(e){this.$log||(this.$log=$('<div style="height:40px;position:fixed;top:0;left:0;right:0;z-index:100000;background:#fff;overflow:auto"></div>').appendTo("body")),this.$log.html(e+"|"+this.$log.html())},indexOf:function(e,t){for(var n="function"==typeof t,i=e.length,r=0;i>r;r++)if(n?t(e[r],r):e[r]==t)return r;return-1},lastIndexOf:function(e,t){for(var n="function"==typeof t,i=e.length-1;i>=0;i--)if(n?t(e[i],i):e[i]==t)return i;return-1},first:function(e,t){for(var n,i=0,r=e.length;r>i;i++)if(n=e[i],t(n,i))return n;return null},find:function(e,t){for(var i,n=[],r=0,o=e.length;o>r;r++)i=e[r],t(i,r)&&n.push(i);return n},select:function(e,t){for(var n=[],i=e.length,r=0;i>r;r++)n.push(t(e[r],r));return n},pick:function(e,i){var o,r={};if(null==e)return r;if("function"==typeof i)for(o in e){var a=e[o];i(a,o,e)&&(r[o]=a)}else for(var s=n.apply([],t.call(arguments,1)),l=0,c=s.length;c>l;l++)o=s[l],o in e&&(r[o]=e[o]);return r},pad:u,formatMoney:function(e){return(e+"").replace(/(\d{3})+(\.|$)/,function(e,t){return e.replace(/\d{3}/g,function(e){return","+e})}).replace(/^,/,"")},deepValue:function(e,t){"string"==typeof t&&(t=t.split("."));for(var n=0,i=t.length;i>n;n++)e=e[t[n]];return e},format:function(e,t){var n=arguments;return e.replace(/\{(\d+)\}/g,function(e,t){return n[parseInt(t)+1]})},formatDate:function(e,t){if("string"==typeof e&&/^\/Date\(\d+\)\/$/.test(e))e=new Function("return new "+e.replace(/\//g,""))();else if("number"==typeof e)e=new Date(e);else if(!e)return"";var n=e.getFullYear()+"",i=e.getMonth()+1,r=e.getDate(),o=e.getHours(),a=e.getMinutes(),s=e.getSeconds(),l=e.getMilliseconds()+"0000";return(t||"yyyy-MM-dd HH:mm:ss").replace(/\y{4}/,n).replace(/y{2}/,n.substr(2,2)).replace(/M{2}/,u(i)).replace(/M/,i).replace(/d{2,}/,u(r)).replace(/d/,e).replace(/H{2,}/i,u(o)).replace(/H/i,o).replace(/m{2,}/,u(a)).replace(/m/,a).replace(/s{2,}/,u(s)).replace(/s/,s).replace(/f+/,function(e){return l.substr(0,e.length)})},style:function(e){var t=document,n=t.getElementsByTagName("head")[0],i=t.createElement("style");i.type="text/css";try{i.appendChild(t.createTextNode(e))}catch(r){i.styleSheet.cssText=e}return n.appendChild(i),i},currency:function(e,t){return(void 0===t||null===t?"ï¿¥":t)+Math.round(100*parseFloat(e))/100},template:function(e,t){var n="var __p=[];var $data=obj||{};with($data){__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/<%=([\s\S]+?)%>/g,function(e,t){return"',"+t.replace(/\\'/,"'")+",'"}).replace(/<%([\s\S]+?)%>/g,function(e,t){return"');"+t.replace(/\\'/,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+'\');}return __p.join("");',i=new Function("obj",n);return t?i(t):i},encodeHTML:function(e){return(""+e).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&#34;").split("'").join("&#39;")},getPath:function(e){return e.replace(/^http\:\/\/[^\/]+|\?.*$/g,"").toLowerCase()},cookie:function(e,t,n,i){if("undefined"==typeof t){var r=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=r?unescape(r[2]):null}if(null===typeof t){if(t=this.cookie(name),null==t)return;n=-1}if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),n=";expires="+o.toGMTString()}document.cookie=e+"="+escape(t)+(n||"")+";path="+(i||"/")},store:window.localStorage?function(e,t){return"undefined"==typeof t?JSON.parse(localStorage.getItem(e)):void(null===t?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(t)))}:function(){return"undefined"==typeof value?JSON.parse(this.cookie(key)):void(null===value?this.cookie(key,null):this.cookie(key,JSON.stringify(value)))},noop:function(){},circlePoint:function(e,t,n,i){return{x:e+n*Math.cos(i*Math.PI/180),y:t+n*Math.sin(i*Math.PI/180)}},validateEmail:function(e){return/^[-_a-zA-Z0-9\.]+@([-_a-zA-Z0-9]+\.)+[a-zA-Z0-9]{2,3}$/.test(e)},validateMobile:function(e){return/^1[0-9]{10}$/.test(e)}};return f});define("bridge",["$","util"],function(t,e,n){var i=t("$"),r=t("util"),o=navigator.userAgent,a=r.ios,s=r.android,u=(Array.prototype.slice,i(window)),f=i('meta[name="api-base-url"]').attr("content"),d={};window.hybridFunctions=d,window.trigger=function(){i.fn.trigger.apply(u,arguments)},window.callJS=function(t){u.trigger(t.method,t.params)};var h=0,m=function(t,e,n){var i,r;"object"==typeof t?n=i.callback:("function"==typeof e&&(n=e,e=null),i={method:t,params:e}),"function"==typeof n&&(r="hybridCallback"+ ++h,i.callback=r,d[r]=function(){n.apply(null,arguments),delete d[r]}),alert("slapp://"+JSON.stringify(i))},g={isInApp:/SLApp/.test(o),isAndroid:s,android:s,ios:a,versionName:"1.0",exec:m,tip:function(t){m("tip",t+"")},openInApp:function(t){m("openInApp",t+"")},open:function(t){m("open",t+"")},pickImage:function(t){m("pickImage",t)},takePhoto:function(t){setTimeout(function(){m("takePhoto",t)},0)},queryThumbnailList:function(t){m("queryThumbnailList",t)},pickColor:function(t){m("pickColor",t)},getDeviceToken:function(t){m("getDeviceToken",t)},getLocation:function(t){m("getLocation",t)},pay:function(t,e){m("pay",t,e)},share:function(){m("share")},isDevelopment:"Win32"==navigator.platform||"Win64"==navigator.platform,url:function(t){return/^http\:\/\//.test(t)?t:f+t},post:function(t,e,n,i){i="function"==typeof n?n:i,n="function"==typeof n?null:n,m("post",{url:this.url(t),files:n,data:e},i)},exit:function(){m("exit")},update:function(t,e,n){s?m("updateApp",{downloadUrl:t,versionName:e},n):this.open(t)}};return g.hasStatusBar=g.isInApp&&r.ios&&r.osVersion>=7,g});define("graphics/matrix2d",[],function(){function t(t,e,n,i,r,o){this.setValues(t,e,n,i,r,o)}var e=t.prototype;return t.DEG_TO_RAD=Math.PI/180,t.identity=null,e.setValues=function(t,e,n,i,r,o){return this.a=null==t?1:t,this.b=e||0,this.c=n||0,this.d=null==i?1:i,this.tx=r||0,this.ty=o||0,this},e.append=function(t,e,n,i,r,o){var a=this.a,s=this.b,l=this.c,c=this.d;return(1!=t||0!=e||0!=n||1!=i)&&(this.a=a*t+l*e,this.b=s*t+c*e,this.c=a*n+l*i,this.d=s*n+c*i),this.tx=a*r+l*o+this.tx,this.ty=s*r+c*o+this.ty,this},e.prepend=function(t,e,n,i,r,o){var a=this.a,s=this.c,l=this.tx;return this.a=t*a+n*this.b,this.b=e*a+i*this.b,this.c=t*s+n*this.d,this.d=e*s+i*this.d,this.tx=t*l+n*this.ty+r,this.ty=e*l+i*this.ty+o,this},e.appendMatrix=function(t){return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.prependMatrix=function(t){return this.prepend(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.appendTransform=function(e,n,i,r,o,a,s,l,c){if(o%360)var u=o*t.DEG_TO_RAD,f=Math.cos(u),d=Math.sin(u);else f=1,d=0;return a||s?(a*=t.DEG_TO_RAD,s*=t.DEG_TO_RAD,this.append(Math.cos(s),Math.sin(s),-Math.sin(a),Math.cos(a),e,n),this.append(f*i,d*i,-d*r,f*r,0,0)):this.append(f*i,d*i,-d*r,f*r,e,n),(l||c)&&(this.tx-=l*this.a+c*this.c,this.ty-=l*this.b+c*this.d),this},e.prependTransform=function(e,n,i,r,o,a,s,l,c){if(o%360)var u=o*t.DEG_TO_RAD,f=Math.cos(u),d=Math.sin(u);else f=1,d=0;return(l||c)&&(this.tx-=l,this.ty-=c),a||s?(a*=t.DEG_TO_RAD,s*=t.DEG_TO_RAD,this.prepend(f*i,d*i,-d*r,f*r,0,0),this.prepend(Math.cos(s),Math.sin(s),-Math.sin(a),Math.cos(a),e,n)):this.prepend(f*i,d*i,-d*r,f*r,e,n),this},e.rotate=function(e){e*=t.DEG_TO_RAD;var n=Math.cos(e),i=Math.sin(e),r=this.a,o=this.b;return this.a=r*n+this.c*i,this.b=o*n+this.d*i,this.c=-r*i+this.c*n,this.d=-o*i+this.d*n,this},e.skew=function(e,n){return e*=t.DEG_TO_RAD,n*=t.DEG_TO_RAD,this.append(Math.cos(n),Math.sin(n),-Math.sin(e),Math.cos(e),0,0),this},e.scale=function(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this},e.translate=function(t,e){return this.tx+=this.a*t+this.c*e,this.ty+=this.b*t+this.d*e,this},e.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},e.invert=function(){var t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,o=t*i-e*n;return this.a=i/o,this.b=-e/o,this.c=-n/o,this.d=t/o,this.tx=(n*this.ty-i*r)/o,this.ty=-(t*this.ty-e*r)/o,this},e.isIdentity=function(){return 0===this.tx&&0===this.ty&&1===this.a&&0===this.b&&0===this.c&&1===this.d},e.equals=function(t){return this.tx===t.tx&&this.ty===t.ty&&this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d},e.transformPoint=function(t,e,n){return n=n||{},n.x=t*this.a+e*this.c+this.tx,n.y=t*this.b+e*this.d+this.ty,n},e.decompose=function(e){null==e&&(e={}),e.x=this.tx,e.y=this.ty,e.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),e.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var n=Math.atan2(-this.c,this.d),i=Math.atan2(this.b,this.a),r=Math.abs(1-n/i);return 1e-5>r?(e.rotation=i/t.DEG_TO_RAD,this.a<0&&this.d>=0&&(e.rotation+=e.rotation<=0?180:-180),e.skewX=e.skewY=0):(e.skewX=n/t.DEG_TO_RAD,e.skewY=i/t.DEG_TO_RAD),e},e.copy=function(t){return this.setValues(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.clone=function(){return new t(this.a,this.b,this.c,this.d,this.tx,this.ty)},e.toString=function(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty+")"},t});define("graphics/tween",[],function(t,e,n){n.exports={linear:function(t,e,n,i){return n*t/i+e},ease:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e},easeIn:function(t,e,n,i){return n*(t/=i)*t+e},easeOut:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,i){return n*(t/=i)*t*t+e},easeOutCubic:function(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,i){return n*(t/=i)*t*t*t+e},easeOutQuart:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},easeOutQuint:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,i){return n*Math.sin(t/i*(Math.PI/2))+e},easeInOutSine:function(t,e,n,i){return-n/2*(Math.cos(Math.PI*t/i)-1)+e},easeInExpo:function(t,e,n,i){return 0==t?e:n*Math.pow(2,10*(t/i-1))+e},easeOutExpo:function(t,e,n,i){return t==i?e+n:n*(-Math.pow(2,-10*t/i)+1)+e},easeInOutExpo:function(t,e,n,i){return 0==t?e:t==i?e+n:(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(-Math.pow(2,-10*--t)+2)+e},easeInCirc:function(t,e,n,i){return-n*(Math.sqrt(1-(t/=i)*t)-1)+e},easeOutCirc:function(t,e,n,i){return n*Math.sqrt(1-(t=t/i-1)*t)+e},easeInOutCirc:function(t,e,n,i){return(t/=i/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,i,r,a){if(0==t)return e;if(1==(t/=i))return e+n;if(a||(a=.3*i),!r||r<Math.abs(n)){r=n;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(n/r);return-(r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-o)*Math.PI/a))+e},easeOutElastic:function(t,e,n,i,r,a){if(0==t)return e;if(1==(t/=i))return e+n;if(a||(a=.3*i),!r||r<Math.abs(n)){r=n;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(n/r);return r*Math.pow(2,-10*t)*Math.sin(2*(t*i-o)*Math.PI/a)+n+e},easeInOutElastic:function(t,e,n,i,r,a){if(0==t)return e;if(2==(t/=i/2))return e+n;if(a||(a=.3*i*1.5),!r||r<Math.abs(n)){r=n;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(n/r);return 1>t?-.5*r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-o)*Math.PI/a)+e:r*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*i-o)*Math.PI/a)*.5+n+e},easeInBack:function(t,e,n,i,r){return void 0==r&&(r=1.70158),n*(t/=i)*t*((r+1)*t-r)+e},easeOutBack:function(t,e,n,i,r){return void 0==r&&(r=1.70158),n*((t=t/i-1)*t*((r+1)*t+r)+1)+e},easeInOutBack:function(t,e,n,i,r){return void 0==r&&(r=1.70158),(t/=i/2)<1?n/2*t*t*(((r*=1.525)+1)*t-r)+e:n/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+e},easeInBounce:function(t,e,n,i){return n-Tween.Bounce.easeOut(i-t,0,n,i)+e},easeOutBounce:function(t,e,n,i){return(t/=i)<1/2.75?7.5625*n*t*t+e:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,n,i){return i/2>t?.5*Tween.easeInOutBounce(2*t,0,n,i)+e:.5*Tween.easeInOutBounce(2*t-i,0,n,i)+.5*n+e}}});define("core/base",[],function(t,e,n){Object.create||(Object.create=function(t){var e=function(){};return e.prototype=t,new e}),Date.now||(Date.now=function(){return+new Date});var i=function(){var t=this,e=Array.prototype.slice.call(arguments),n=e.shift();if(n)for(var i in n)t.options[i]=n[i];t.initialize.apply(t,e),t.options.initialize&&t.options.initialize.apply(t,e)};i.prototype={options:{},initialize:function(){}},i.extend=function(t,e){var r,n=this;"function"!=typeof t&&(e=t,t=function(){n.apply(this,arguments)});var o=function(){this.constructor=t};if(o.prototype=n.prototype,t.prototype=new o,r=e.options,"undefined"!=typeof r){for(var a in r)t.prototype.options[a]=r[a];delete e.options}for(var a in e)t.prototype[a]=e[a];return t.__super__=n.prototype,t.extend=i.extend,t},window.sl=window.slan={},n.exports=i});define("core/promise",["./linklist"],function(t,e,n){var i=t("./linklist"),r=Array.prototype.slice,o=/^\$(\d+)$/,a=function(t,e,n){for(var s,i=[],r=0,a=t.length;a>r;r++)s=t[r],i.push("string"==typeof s?o.test(s)?e[parseInt(s.match(o)[1])]:s.replace(/^\$\$/,"$"):s);return i.push(n),i},s=function(t,e,n){if(!(this instanceof s))return new s(t,e,n);var r=this;this.queue=new i,this.state=2,this.resolveSelf=function(){r.resolve.apply(r,arguments)},e||"number"!=typeof t?t&&(this.state=0,this.then(t,e,n)):(this.state=0,this.start(t))};s.prototype={reject:function(t){this.resolve(t||"unknow error",null)},resolve:function(){var i,o,a,t=this,e=r.call(arguments),n=t.queue.shift();if(n)if(t.state=1,i=n[0],o=n[1],i instanceof s)i.then(t.resolveSelf);else if("function"==typeof i)a=i.apply(o,e),a instanceof s?a!==t&&a.then(t.resolveSelf):t.resolve(null,a);else if(i instanceof Array)for(var u=[],l=[],c=0,f=0,d=i.length;d>f;f++)!function(n,i,r){"function"==typeof n&&(n=n.apply(o,e)),n instanceof s?n.then(function(e,n){e&&(u[i]=e),c++,l[i]=n,c>=r&&t.resolve(u,l)}):(c++,l[i]=n,c>=r&&t.resolve(null,l))}(i[f],f,d);else t.resolve(null,e);else t.state=0;return t},when:function(t,e){return t instanceof Array||(t=[t]),this.queue.append([t,e||this]),1!=this.state&&this.resolve(),this},map:function(t,e,n){var i=this,r=function(){var n=arguments;return i._count=t.length,i.result=[],i.errors=[],t.forEach(function(t,r){t instanceof Array||(t=[t]),e.apply(this,a(t,n,function(t,e){i.next(r,t,e)}))}),i};return i.queue.append([r,n||this]),i},each:function(t,e,n){var i=this,r=function(){return i._count=t.length,i.result=[],i.errors=[],t.forEach(function(t,n){e.apply(this,[n,t])}),i};return i.queue.append([r,n||this]),i},start:function(t){var e=this,n=function(){return e._count=t,e.result=[],e.errors=[],e};return e.queue.append([n,this]),e},next:function(t,e,n){this._count--,e&&(this.errors[t]=e),this.result[t]=n,this._count<=0&&this.resolve(this.errors.length?this.errors:null,this.result)},bind:function(t){var e=this;return function(){e.then(r.call(arguments),t,this)}},then:function(t,e,n){var r,i=this;return t instanceof Array?(r=e,e=function(){return r.apply(this,a(t,arguments,i.resolveSelf)),i}):(n=e,e=t,t=null),i.queue.append([e,n||this]),i.state||i.resolve(),i}},s.resolve=function(){return(new s).resolve()},n.exports=s});define("core/linklist",[],function(t,e,n){var i=function(){this._idlePrev=this,this._idleNext=this},r=function(t){return t._idlePrev==t?null:t._idlePrev},o=function(t){t._idleNext&&(t._idleNext._idlePrev=t._idlePrev),t._idlePrev&&(t._idlePrev._idleNext=t._idleNext),t._idleNext=null,t._idlePrev=null};i.prototype={length:0,init:function(t){t={data:t},this.list=t,this.length=1,t._idleNext=t,t._idlePrev=t},get:function(t){var e=null;return this.each(function(n){return t(n)===!0?(e=n,!1):void 0}),e},find:function(t){var e=[];return this.each(function(n){t(n)===!0&&e.push(n)}),e},first:function(){return this._idlePrev!=this?this._idlePrev.data:null},peek:function(){return this._idlePrev==this?null:this._idlePrev},each:function(t){for(var n,e=this._idlePrev;e!=this&&(n=e._idlePrev,t.call(e,e.data)!==!1);)e=n},next:r,append:function(t,e){return e||(t={data:t}),t._idleNext=this._idleNext,this._idleNext._idlePrev=t,t._idlePrev=this,this._idleNext=t,this.length++,t},contains:function(t){var e=!1;return this.each(function(n){return t===n?(e=!0,!1):void 0}),e},shift:function(){var t=this._idlePrev;return t!=this?(this._remove(t),t.data):null},_remove:function(t){0!=this.length&&(this.length--,o(t))},remove:function(t){var e=this;e.each(function(n){return n===t?(e._remove(this),!1):void 0})},isEmpty:function(){return this._idlePrev==this}},n.exports=i});define("core/event",["$","./base"],function(t,e,n){function l(t,e,n){(t||"").split(s).forEach(function(t){n(t,e)})}function c(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function f(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function d(t,e,n,i){var r,o;return o=f(e),o.ns&&(r=c(o.ns)),t.filter(function(t){return!(!t||o.e&&t.e!==o.e||o.ns&&!r.test(t.ns)||n&&t.cb!==n&&t.cb._cb!==n||i&&t.ctx!==i)})}function h(t,e){return this instanceof h?(e&&i.extend(this,e),this.type=t,this):new h(t,e)}var i=t("$"),r=t("./base"),o=[].slice,s=/\s+/,a=function(){return!1},u=function(){return!0};return h.prototype={isDefaultPrevented:a,isPropagationStopped:a,preventDefault:function(){this.isDefaultPrevented=u},stopPropagation:function(){this.isPropagationStopped=u}},r.event={createEvent:h,on:function(t,e,n){var r,i=this;return e?(r=this._events||(this._events=[]),l(t,e,function(t,e){var o=f(t);o.cb=e,o.ctx=n,o.ctx2=n||i,o.id=r.length,r.push(o)}),this):this},one:function(t,e,n){var i=this;return e?(l(t,e,function(t,e){var r=function(){return i.off(t,r),e.apply(n||i,arguments)};r._cb=e,i.on(t,r,n)}),this):this},off:function(t,e,n){var i=this._events;return i?t||e||n?(l(t,e,function(t,e){d(i,t,e,n).forEach(function(t){delete i[t.id]})}),this):(this._events=[],this):this},trigger:function(t){var n,i,r,s,a,e=-1;if(!this._events||!t)return this;if("string"==typeof t&&(t=new h(t)),n=o.call(arguments,1),t.args=n,n.unshift(t),i=d(this._events,t.type))for(s=i.length;++e<s;)if((r=t.isPropagationStopped())||!1===(a=i[e]).cb.apply(a.ctx2,n)){r||(t.stopPropagation(),t.preventDefault());break}return this}},r.Event=h,r.event});define("core/view",["$","util","./base","./event"],function(t,e,n){var i=t("$"),r=t("util"),s=t("./base"),o=t("./event"),a=Array.prototype.slice,u=function(){var e,t=this,n=a.call(arguments),s=n.shift();t._bindListenTo=[],i.isPlainObject(s)?(e=s,s=null):e=n.shift(),t.options=i.extend({},t.options,e),t.options.className&&(t.className=t.options.className),t.options.el&&(t.el=t.options.el),t.cid=r.guid(),t.setElement(s||t.el),t.initialize.apply(t,n),t.options.initialize&&t.options.initialize.apply(t,n),t.on("Destroy",t.onDestroy)};u.prototype=Object.create(o),i.extend(u.prototype,{options:{},initialize:r.noop,setElement:function(t,e){return t&&(this.$el&&this.undelegateEvents(),this.$el=i(t),this.el=this.$el[0],this.className&&this.$el.addClass(this.className),e!==!1&&this.delegateEvents()),this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},delegateEvents:function(){return this.listen(this.events),this.listen(this.options.events),this},listen:function(t,e){var n=this;if(e){var s=t.split(" "),o=s.shift().replace(/,/g,".delegateEvents"+n.cid+" ");e=i.proxy(i.isFunction(e)?e:n[e],n),s.length>0&&""!==s[0]?n.$el.on(o,s.join(" "),e):n.$el.on(o,e)}else for(var r in t)n.listen(r,t[r]);return n},listenTo:function(t){var e=a.apply(arguments),n=e[e.length-1];return"function"!=typeof t.on&&(t=i(t)),e[0]=t,e[e.length-1]=i.proxy(n,this),this._bindListenTo.push(a.apply(e)),e.shift().on.apply(t,e),this},$:function(t){return this.$el.find(t)},onDestroy:r.noop,destroy:function(){var n,e=(this.$el,this);i.each(this._bindListenTo,function(t,e){n=e.shift(),n.off.apply(n,e)}),e.undelegateEvents(),e.$el.remove(),e.trigger("Destroy")}}),u.extend=function(){var r,t=this,e=a.call(arguments),n=e[0];return"function"!=typeof n?(n=null,e.unshift({})):e[0]={},r=i.extend.apply(i,e),n=s.extend.apply(t,n?[n,r]:[r]),n.prototype.events=i.extend({},n.__super__.events,n.prototype.events),n.extend=arguments.callee,n},n.exports=u});define("core/model",["$","util","./base","./event"],function(t,e,n){var i=t("$"),r=t("util"),a=(t("./base"),t("./event")),o=Array.prototype.slice,l={date:r.formatDate,isFalse:function(t,e,n){return 1==arguments.length?r.isFalse(t):r.isFalse(t)?e:n},isTrue:function(t,e,n){return 1==arguments.length?r.isTrue(t):r.isTrue(t)?e:n},json:function(t){return JSON.stringify(t instanceof x||t instanceof A?t.data:t)},length:function(t){return t instanceof A?t.data.length:t&&t.length||0},join:function(t,e){return t instanceof A?t.data.join(e):t.join(e)},replace:function(t,e,n){return t.replace(e,n)},is:function(t,e){switch(e){case"array":return i.isArray(t);case"object":return i.isPlainObject(t);default:return typeof t==e}},equal:function(t,e,n,i){return 2==arguments.length?t==e:t==e?n:i},eval:function(t,e){for(var n={},i=this._evalCache||(this._evalCache={}),r=i[e]||(i[e]=new Function("$args","with($args){ return "+e+"}")),s=0,a=0,o=arguments.length;o>s;s++)1!=s&&(n["$"+a]=arguments[s],a++);return r.call(this,n)},lt:function(t,e){return e>t},lte:function(t,e){return e>=t},gt:function(t,e){return t>e},gte:function(t,e){return t>=e},choose:function(t,e,n){return t?e:n},or:function(t,e){return t||e},and:function(t,e){return t&&e},not:function(t){return!t},lowercase:function(t){return t.toLowerCase()},uppercase:function(t){return t.toUpperCase()},currency:function(t,e){return(e||"")+Math.round(100*parseFloat(t))/100},concat:function(){return o.call(arguments).join("")},round:function(t){return Math.round(t)},max:Math.max,min:Math.min,mul:function(t,e){return parseFloat(t)*parseFloat(e)},plus:function(t,e){return parseFloat(t)+parseFloat(e)},minus:function(t,e){return parseFloat(t)-parseFloat(e)},format:function(t){var e,n=arguments[1];return 2==arguments.length&&"object"==typeof t?e=t:(e=o.call(arguments),e.splice(1,1)),n.replace(/\{([_a-zA-Z0-9]+)\}/g,function(t,n){return e[n]})},"case":function(t){for(var e=o.call(arguments,1),n=0,i=e.length;i>n;n+=2)if(t==e[n])return e[n+1];return i%2==0?void 0:e[i-1]},listen:function(t,e,n,i,r,s,a){var o;if(i&&(o="_bind_filter"+r.prop+("number"==typeof i?i:"")+"_"+a,!e[o]&&(e[o]=!0)||!i[o]&&(i[o]=!0))){s=s.split(".");var u=s.pop(),c=s.length<=0?t:t.get(s.join("."))||t.set(s.join("."),{}).get(s);c.on("change"+(u?":"+u:""),function(){e._elAttr(i,r.prop,r.filter(l,e,e.data[n]))})}}},u=/\s*\|\s*([a-zA-Z_0-9]+)((?:\s*(?:\:|;)\s*\({0,1}\s*([a-zA-Z_0-9\.-]+|'(?:\\'|[^'])*')\){0,1})*)/g,c=/\s*\:\s*([a-zA-Z_0-9\.-]+|'(?:\\'|[^'])*')/g,h=/^((-)*\d+|true|false|undefined|null|'(?:\\'|[^'])*')$/,f=function(t,e){var a,o,l,n="",i="var S=this;",r=0,s=0;return t.replace(u,function(t,u,f){n+="V=F."+u+"(V",f.replace(c,function(t,u){var c;h.test(u)?c=u:(a=u.split("."),o=a.shift(),!e||o!=e.alias&&!(l=e.modelAlias[o])?(c="M.root.data."+u,i+='if(E)F.listen(M.root,M,K,E,S,"'+u+'",'+r++ +");"):u==e.alias?(c="M.data",i+="if(E)F.listen(M.parent,M,K,E,S,M._key,"+r++ +");"):(o==e.alias&&(l=e.collectionName),u=a.join("."),c="A"+s++,i+="var "+c+';var P=M;while(P){if(P.key=="'+l+'^child"){if(E)F.listen(P,M,K,E,S,"'+u+'",'+r++ +");"+c+"=P.data."+u+";break;}P=P.parent.parent;}")),n+=","+c}),n+=");"}),n+="return V;",new Function("F","M","V","K","E",i+n)},d=function(t,e){return t.filter(e).add(t.find(e))},p=function(t,e){var n=e.split("."),i=n.shift();if(i==t.alias)return{collection:t.collectionName,variable:n.join(".")};var r=t.modelAlias[i];return r?{collection:r,variable:n.join(".")}:void 0},m=function(t){var e={isExp:"="==t[0],args:[]};return e.isExp?e.args.push(t.substr(1)):t.replace(c,function(t,n){e.args.push(n)}),e},v=/([a-zA-Z_0-9]+)(?:\s*,(\s*[a-zA-Z_0-9]+)){0,1}\s+in\s+([a-zA-Z_0-9]+(?:\.[a-zA-Z_0-9]+){0,})((?:\s*\|\s*filter\s*\:\s*.+?){0,1})(?:\s*\|\s*orderBy\:(.+)){0,1}(\s|$)/g,g=/\b([a-zA-Z_0-9-\.]+)\s*\:\s*([a-zA-Z_0-9]+)((?:\.[a-zA-Z_0-9]+)*)((?:\s*\|\s*[a-zA-Z_0-9]+(?:\s*\:\s*\({0,1}\s*(?:[a-zA-Z_0-9\.-]+|'(?:\\'|[^'])*')\){0,1})*)*)(\s|,|$)/g,y=/\b([a-zA-Z\s]+)\s*\:\s*([a-zA-Z_0-9]+)((?:\.[a-zA-Z_0-9]+)*)((?:\s*\:\s*(?:[a-zA-Z_0-9\.]+|'(?:\\'|[^'])*'))*|\s*=\s*(?:[a-zA-Z_0-9\.]+|'(?:\\'|[^'])*'))(\s|,|$)/g,b=function(t){this.count=0,this.repeats={},this.bindings={},this.events=[],this.eventNames=[],this.eventid=0,this.scan(t)};b.prototype.scan=function(t){{var o,n=this.repeats,r=this.bindings,s=this.events,a=this.eventNames,l=this.count,u=this.eventid;d(t,"[sn-repeat]").each(function(){var t=i(this),e=this,r=this.getAttribute("sn-repeat"),s=t.parents("[sn-repeat-alias]"),a={},l={};s.each(function(){var t=this.getAttribute("sn-repeat-name");a[this.getAttribute("sn-repeat-alias")]=t;var e=this.snIndexAlias;e&&(l[e]=t)}),r.replace(v,function(t,i,r,s,u,c){var d,h=s.split("."),f=h.length;1!==f&&(d=a[h[0]],d&&(h[0]=d+"^child",s=h.join("."))),e.setAttribute("sn-repeat-alias",i),e.setAttribute("sn-repeat-name",s),r&&(e.snIndexAlias=r,l[r]=s);var p=document.createElement("script");p.setAttribute("type","text/placeholder");var m,v={loopIndexAlias:l,collectionName:s,alias:i,modelAlias:a,template:e};u&&(v.filter=u),c&&(v.orderBy=c),-1==s.indexOf(".")&&(v.placeHolder=p),o=n[s],o?m=s+"_"+o.push(v):(n[s]=[v],m=s+"_1"),v.placeHolderName=m,p.setAttribute("sn-placeholder",m),e.parentNode.insertBefore(p,e)})}).remove()}for(var h in n)for(var b=n[h],_=0,x=b.length;x>_;_++){var w=b[_],T=i(w.template);d(T,"[sn-binding],[sn-model],[sn-on]").each(function(){var t=this,e=this.getAttribute("sn-binding"),n=this.getAttribute("sn-model"),o=this.getAttribute("sn-on");if(t.setAttribute("sn-id",++l),n&&(n=p(w,n),n&&(this.setAttribute("sn-collection",n.collection),this.setAttribute("sn-model",n.variable))),o){this.setAttribute("sn-on",u);var d=s[u];o.replace(y,function(t,e,n,r,o){-1==a.indexOf(e)&&(a[a.length]=e),d||(d=s[u]={});var l=n+r;d[e]=i.extend(m(o),{name:p(w,l)||l,repeat:w})}),u++}e&&e.replace(g,function(t,e,n,i,s){var a;n==w.alias?n=w.collectionName+"^child"+i:w.loopIndexAlias&&w.loopIndexAlias[n]?n=w.loopIndexAlias[n]+"^child.^"+n:(a=w.modelAlias[n])&&(n=a+"^child"+i),(r[n]||(r[n]=[])).push({el:l,prop:s?{prop:e,filter:f(s,w)}:e})})})}d(t,"[sn-binding],[sn-on]").each(function(){var t=this.getAttribute("sn-binding"),e=this.getAttribute("sn-on"),n=this;if(t&&t.replace(g,function(t,e,i,s,a){i+=s,(r[i]||(r[i]=[])).push({el:n,prop:a?{prop:e,filter:f(a)}:e})}),e){this.setAttribute("sn-on",u);var o=s[u];e.replace(y,function(t,e,n,r,l){-1==a.indexOf(e)&&(a[a.length]=e),o||(o=s[u]={}),o[e]=i.extend(m(l),{name:n+r})}),u++}})};var _=function(t,e,n){if(0==e.indexOf("style."))t.style[e.substr(6)]=n;else switch(e){case"text":t.innerHTML=r.encodeHTML(n);break;case"html":t.innerHTML=n;break;case"display":t.style.display=r.isFalse(n)?"none":"block"==n||"inline"==n||"inline-block"==n||"none"==n||"-webkit-box"==n?n:"";break;case"value":t.value!=n&&(t.value=n);break;case"style":i(t).css(n);break;case"class":"undefined"==typeof t.initClassName&&(t.initClassName=t.className||""),t.className=t.initClassName+" "+("string"!=typeof n&&n?l.join(n," "):n);break;default:null===n||void 0===n?t.removeAttribute(e):t.setAttribute(e,n)}},x=function(t,e,n,i){if(4==arguments.length&&!this.created){var r={};if(this.$el=i,this.model=r,this._key=e,this.data={},n instanceof x)this.parent=n,this.key=n.key?n.key+"."+e:e,this.root=n.root;else{if(!(n instanceof A))throw new Error("Model's parent mast be Collection or Model");this.parent=n,this.key=n.key+"^child",this.root=n.root}t&&this.set(t),n.data[e]=this.data,this.created=!0}};x.prototype=Object.create(a),i.extend(x.prototype,{constructor:x,_redraw:function(){var t;for(var e in this.model)t=this.model[e],t instanceof x||t instanceof A?t._redraw():this._syncView(e,t)},_syncView:function(t,e,n){var r,s,a,o,i=this.root.finder.bindings[t&&this.key?this.key+"."+t:this.key||t];if(i)for(var u=0,c=i.length;c>u;u++)r=i[u],s=r.el,a=r.prop,"string"!=typeof a?(o=a.filter(l,this,e,t,s),a=a.prop):o=e,this._elAttr(s,a,o,n);return this},_syncOwnView:function(){return this.root!=this&&(this._syncView("",this.data),this.created&&this.parent instanceof x&&this.parent.trigger("change:"+this._key,this.data),this.parent.shouldUpdateView&&this.parent._syncOwnView()),this},_elAttr:function(t,e,n,i){"number"==typeof t?d(i||this.$el,'[sn-id="'+t+'"]').each(function(){_(this,e,n)}):_(t,e,n)},get:function(t){if("string"==typeof t&&-1!=t.indexOf(".")&&(t=t.split(".")),i.isArray(t)){for(var e=this,n=0,r=t.length;r>n;n++)if(e instanceof x)e=e.model[t[n]];else{if(!(e instanceof A))return null;e=e.models[t[n]]}return e}return this.model[t]},dirty:function(){var t,e={};for(var n in this.data)t=this.data[n],this.originalData[n]!=t&&(e[n]=t);return e},set:function(t,e){var r,s,a,n=this,o=this.model;if(n.shouldUpdateView=!1,i.isPlainObject(t))a=t;else{if("undefined"==typeof e)return e=t,t="",console.log(this,t,e),this.parent&&this.parent instanceof A&&(this.parent.data[this.parent.models.indexOf(this)]=e),this.data=e,void this._syncOwnView();(a={})[t]=e}this.originalData||(this.originalData=a);var c,l=[],u=[],s=!1,h=[];for(var f in a)this.data[f]=a[f];for(var f in a)if(r=o[f],c=a[f],r!==c){var d=f.split(".");if(d.length>1){t=d.pop(),o=this;for(var v,p=0,m=d.length;m>p;p++)if(f=d[p],v=o,o instanceof x)o=o.model[f],o||(o=v.model[f]=new x(null,f,v,v.$el),v.data[f]=o.data);else if(o instanceof A&&(o=o.models[f],!o))throw new Error("[Collection index is bigger than length!]");o.set(t,c)}else if(r instanceof x)null===c||void 0===c?r.clear():r.set(c);else if(r instanceof A){if(!i.isArray(c)){if(null!=c)throw new Error("[Array to "+typeof c+" error]ä¸å¯æ¹å"+f+"çæ°æ®ç±»å");c=[]}r.set(c)}else i.isPlainObject(c)?u.push(o[f]=new x(null,f,this,this.$el),c):i.isArray(c)?(o[f]=new A,l.push(f)):(this.data[f]=c,o[f]=c,this.created&&(this.trigger("change:"+f,c),this!=this.root&&this.root.trigger("change:"+(this.key?this.key+"."+f:f),this,f,c)));h.push(f,c),s||(s=!0)}for(var p=0,m=u.length;m>p;p+=2)u[p].set(u[p+1]);for(var p=0,m=l.length;m>p;p++)t=l[p],o[t].constructor(this.data[t],t,this);if(s){this.root!=this&&this._syncOwnView();for(var p=0,m=h.length;m>p;p+=2)this._syncView(h[p],h[p+1])}return n.shouldUpdateView=!0,this},clear:function(){var t={};for(var e in this.data)t[e]=null;this.set(t)},toJSON:function(){return i.extend(!0,{},this.data)}});var w={contains:function(t,e){return-1!=t.indexOf(e)}},T=function(t,e){var n=this;if(this.list=[],this.collection=t,i.extend(this,e),this.selector='[sn-placeholder="'+this.placeHolderName+'"]',!this.placeHolder&&this.collection.parent.$el&&(this.placeHolder=this.collection.parent.$el.find(this.selector)[0]),this.isInCollection=!i.contains(document.body,this.placeHolder),this.filter){var r="{";for(var s in this.modelAlias){var a=this.modelAlias[s];r+=s+":model.parent.parent";for(var o=t.parent;o&&o.key!=a+"^child";)o=o.parent,r+=".parent";r+=".data,"}r+=this.alias+":model.data}";var l="var self=this,collection=this.collection;with($.extend({},collection.root.data,"+r+",filter)){",u=this.filter.replace(/^\s*\|\s*filter\s*\:/,"");l+="return "+u,l+="}",this.filter=new Function("filter","model",l);for(var c=u.split(/[\=\>\<\?\s\:\(\),]+/g),f=0,d=c.length;d>f;f++)if(!h.test(c[f])){var o,p=c[f].split("."),m=p[0];if(!m||w[m])continue;if(m==this.alias)p[0]=t.key+"^child";else{var a=this.modelAlias[m];a&&(p[0]=a+"^child")}t.root.on("change:"+p.join("."),function(){n.update()})}}};T.prototype={update:function(){var t=document.createDocumentFragment(),e=0,n=this.list,r=this.orderBy;r&&n.sort(function(t,e){return t=t.model.data[r],e=e.model.data[r],t>e?1:e>t?-1:0});for(var s=0,a=n.length;a>s;s++){var o=n[s];if(!this.filter||this.filter(w,o.model)){t.appendChild(o.el);var l=this.template.snIndexAlias;l&&o.model._syncView("^"+l,e,i(o.el).attr("sn-index-"+l,e)),e++}else o.el.parentNode&&o.el.parentNode.removeChild(o.el)}this.appendChild(t)},get:function(t){for(var e=this.list.length-1;e>=0;e--)if(this.list[e].model==t)return this.list[e]},add:function(t,e){this.list.push({model:t,el:e})},appendChild:function(t){this.isInCollection?this.collection.parent.$el.find(this.selector).add(this.placeHolder).before(t):this.placeHolder.parentNode.insertBefore(t,this.placeHolder)},clear:function(){for(var t=this.list.length-1;t>=0;t--)this.list[t].el.parentNode.removeChild(this.list[t].el);this.list.length=0},remove:function(t){for(var e=this.list.length-1;e>=0;e--)if(this.list[e].model==t){this.list[e].el.parentNode.removeChild(this.list[e].el),this.list.splice(e,1);break}}};var A=function(t,e,n){if(3==arguments.length){this.models=[],this.data=[],this.key=e,this._key=e,this.repeats=[],this.parent=n,n.key&&(this.key=n.key+"."+this.key),this.root=n.root;var i=this.root.finder.repeats[this.key];if(i)for(var s=0,a=i.length;a>s;s++)this.repeats.push(new T(this,i[s]));t&&this.set(t)}};A.prototype={constructor:A,model:x,forEach:function(t){for(var e,i=0,r=this.models.length;r>i;i++)e=this.models[i],t.call(this,e,i)},_redraw:function(){for(var t=0,e=this.models.length;e>t;t++){model=this.models[t];for(var n,t=0,e=this.repeats.length;e>t;t++)if(n=this.repeats[t],!n.get(model)){{var r=item.template.cloneNode(!0);i(r)}r.snModel=model,n.add(model,r),model.$el.push(r),n.update()}model._redraw()}},add:function(t){var e,n;this.shouldUpdateView=!1,i.isArray(t)||(t=[t]);for(var s=0,a=t.length;a>s;s++){var o=null,l=t[s];e=new this.model,n=this.data.length,this.models[n]=e,this.data[n]=l;for(var u=0,c=this.repeats.length;c>u;u++){var h=this.repeats[u],f=h.template.cloneNode(!0),d=i(f);f.snModel=e,h.add(e,f),o=o?o.add(d):d}e.constructor(l,n,this,o)}for(var s=0,c=this.repeats.length;c>s;s++)this.repeats[s].update();this._syncOwnView(),this.shouldUpdateView=!0},_syncOwnView:function(){return this.parent._syncView(this._key,this.data),this.created&&this.parent.trigger("change:"+this._key,this.data),this.parent.shouldUpdateView&&this.parent._syncOwnView(),this},set:function(t){this.data.length=0;for(var e=0,n=this.repeats.length;n>e;e++)this.repeats[e].clear();return this.add(t),this},get:function(t){return this.models[t]},remove:function(t){var e,n;"number"!=typeof t&&(t=this.models.indexOf(t));for(var i=0,r=this.repeats.length;r>i;i++)e=this.repeats[i],n=e.list[t].el,n.parentNode.removeChild(n),e.list.splice(t,1);this.models.splice(t,1),this.data.splice(t,1),this._syncOwnView()}},A.prototype.append=A.prototype.add;var M=function(t,e){return(t.getAttribute("sn-repeat-name")==e?t:i(t).closest('[sn-repeat-name="'+e+'"]')[0]).snModel},E=function(t,e){this.root=this,t&&(this.created||(this.data={},this.events=[],this.model={},this.key="",this.load(t),this.set(e),this.created=!0))};E.prototype=Object.create(x.prototype),i.extend(E.prototype,{constructor:E,load:function(t){return this.finder=new b(t),this.$el=t.on("input change","[sn-model]",i.proxy(this._inputChange,this)),this.bindEvents(),this},handleEvent:function(t){var l,u,c,f,e=t.currentTarget,n=i(e),r=t.type,s=e.getAttribute("sn-on"),a=this.finder.events[s],o=a[r],d=[t];if(o){l=o.name;for(var p=0;p<o.args.length;p++){var m=o.args[p],v=this;if(h.test(m))d.push(window.eval(m));else{if(o.repeat){var b,g=m.split("."),y=g.shift();if(o.repeat.alias==y)v=M(e,o.repeat.collectionName),m=g;else if(o.repeat.modelAlias[y])v=M(e,o.repeat.modelAlias[y]),m=g;else if(b=n.closest("[sn-index-"+m+"]")){d.push(b.attr("sn-index-"+m));continue}}d.push(v.get(m))}}"string"==typeof l?(f=l,u=this):(u=M(e,l.collection),f=l.variable),o.isExp?u.set(f,d[1]):(l=u.get(f),c=f.lastIndexOf("."),l&&l.apply(-1==c?u:u.get(f.substr(0,c)),d))}},bindEvents:function(){for(var e=0,n=this.finder.eventNames.length;n>e;e++){var r=this.finder.eventNames[e];-1==this.events.indexOf(r)&&(this.$el.on(r,"[sn-on]",i.proxy(this.handleEvent,this)),this.events[this.events.length]=r)}},scan:function(t){this.finder.scan(t),this._redraw(),this.bindEvents()},append:function(t,e){e?t=this.$el.find(t):(e=t,t=this.$el),t.append(e),this.scan(e)},prepend:function(t,e){e?t=this.$el.find(t):(e=t,t=this.$el),t.prepend(e),this.scan(e)},before:function(t,e){this.$el.find(t).before(e),this.scan(e)},after:function(t,e){this.$el.find(t).after(e),this.scan(e)},_inputChange:function(t){var e=t.currentTarget,n=e.getAttribute("sn-model"),i=e.getAttribute("sn-collection");i?M(e,i).set(n,e.value):this.set(n,e.value)},destory:function(){this.$el.off("input change","[sn-model]",this._inputChange)}}),E.extend=x.extend=A.extend=r.extend,e.ViewModel=E,e.filter=e.Filter=l});define("core/model2",["$","util","./base","./event"],function(t,e,n){var i=t("$"),r=t("util"),a=(t("./base"),t("./event")),c=/^((-)*\d+|true|false|undefined|null|'(?:\\'|[^'])*')$/,u=/([a-zA-Z_0-9]+)(?:\s*,(\s*[a-zA-Z_0-9]+)){0,1}\s+in\s+([a-zA-Z_0-9]+(?:\.[a-zA-Z_0-9]+){0,})(?:\s*\|\s*filter\s*\:\s*(.+?)){0,1}(?:\s*\|\s*orderBy\:(.+)){0,1}(\s|$)/,h=/\{\{(.+?)\}\}/g,f=/(^|[\=\>\<\?\s\:\(\),\%\+\-\*\/\[\]]+)([a-zA-Z_0-9]+(?:\.[a-zA-Z_0-9]+)*(?![a-zA-Z_0-9]*\()|'(?:\\'|[^'])*')/g,d=/\/(?:\\\/|[^\/])*\/[img]+|"(?:\\"|[^"])*"/g,p=function(t){for(var e=t.split("."),n=[],i=0;i<e.length;i++)n[i]=(0==i?"$data":n[i-1])+"."+e[i];for(var i=0;i<n.length;i++)n[i]=n[i]+"!=null&&"+n[i]+"!=undefined";return"("+n.join("&&")+"?"+t+':"")'},m=function(t,e){for(var n=t.length?t:[t],i=0,r=n.length;r>i;i++){var s=n[i];e(s,i,n),1==s.nodeType&&s.childNodes.length&&m(s.childNodes,e)}},v={contains:function(t,e){return-1!=t.indexOf(e)},util:r,closestRepeatModel:function(t){for(var e=t.parentNode;null!=e;e=e.parentNode)if(e.repeat)return e.repeat.parentModel.data}},g=function(t,e,n,i){if(t instanceof g)this.key=t.key?t.key+"."+e:e;else{if(!(t instanceof _))throw new Error("Model's parent mast be Collection or Model");this.key=t.key+"^child"}if(this._key=e,this.model={},this.parent=t,this.root=t.root,this.data=n,i)for(var r=0,s=i.length;s>r;r++)i[r].add(this);this.set(n)};g.prototype=Object.create(a),g.prototype.get=function(t){if("string"==typeof t&&-1!=t.indexOf(".")&&(t=t.split(".")),i.isArray(t)){for(var e=this,n=0,r=t.length;r>n;n++)if(e instanceof g)e=e.model[t[n]];else{if(!(e instanceof _))return null;e=e.models[t[n]]}return e}return this.model[t]},g.prototype.cover=function(t,e){return this.set(!0,t,e)},g.prototype.set=function(t,e,n){var s,o,r=this,l=r.model;if(t!==!0&&(n=e,e=t,t=!1),i.isPlainObject(e))o=e;else{if("undefined"==typeof n)return n=e,e="",this.parent instanceof _&&(this.parent.data[this.parent.models.indexOf(this)]=n),void(this.data=n);(o={})[e]=n}if(t)for(var c in this.data)void 0===o[c]&&(o[c]=null);!this.root.init&&i.extend(this.data,o);for(var c in o)if(s=l[c],value=o[c],s!==value){var u=c.split(".");if(u.length>1){e=u.pop(),l=this;for(var d,h=0,f=u.length;f>h;h++)if(c=u[h],d=l,l instanceof g)l=l.model[c],l||(l=d.model[c]=new g(d,c,null),d.data[c]=l.data);else if(l instanceof _&&(l=l.models[c],!l))throw new Error("[Collection index is bigger than length!]");l.set(e,value)}else if(s instanceof g)null===value||void 0===value?s.clear():s.set(value);else if(s instanceof _){if(!i.isArray(value)){if(null!=value)throw new Error("[Array to "+typeof value+" error]ä¸å¯æ¹å"+c+"çæ°æ®ç±»å");value=[]}s.set(value)}else i.isPlainObject(value)?l[c]=new g(this,c,value):i.isArray(value)?l[c]=new _(this,c,value):(l[c]=value,this.root.init||(this.trigger("change:"+c,value),this.root.trigger("sync:"+(this.key?this.key+"."+c:c).replace(/\./g,"/"),this,c,value)))}return r},g.prototype.clear=function(){var t={};for(var e in this.data)t[e]=null;this.set(t)},g.prototype.closest=function(t){for(var e=this.parent;null!=e;e=e.parent)if(e.key==t)return e},g.prototype.contains=function(t){for(var e=t.parent;null!=e;e=e.parent)if(e==this)return!0;return!1};var y=function(t){i.extend(this,t);for(var e=this,n=this.collectionName.split("."),r=this.parent;r;){if(r.alias==n[0]){n[0]=r.collectionName+"^child",this.collectionName=n.join("."),this.isChild=!0;break}r=r.parent}var s=document.createComment(this.collectionName);if(s.repeat=this,this.replacement=s,this.el.parentNode.insertBefore(s,this.el),this.el.parentNode.removeChild(this.el),this.collectionRepeats=[],this.filters){var a=this.viewModel.compileExpression("{{"+this.filters+"}}",this,function(t,n){for(var i=0;i<e.collectionRepeats.length;i++){var r=e.collectionRepeats[i];(n.parent==r.collection||n.contains(r.collection))&&r.update()}});this.filter=this.viewModel.fns.length+this.viewModel._fns.length,this.viewModel._fns.push(a)}},b=function(t,e,n){var i=this;if(this.collection=t,this.repeat=e,this.children=[],this.parentModel=n,e.collectionRepeats[e.collectionRepeats.length]=this,e.parent)if(e.isChild||n)this.type="children",this.findReplacement(n||t.parent);else{this.type="in_other_repeat";for(var r=0;r<e.parent.collectionRepeats.length;r++){var s=e.parent.collectionRepeats[r];s.collection.on("add",function(n,r){for(var s=new b(t,e,r),a=0;a<t.models.length;a++)s.add(t.models[a]);i.children.push(s),s.update()}).each(function(n){i.children.push(new b(t,e,n))}),s.children.push(this)}}else this.type="normal",this.replacement=e.replacement;this.el=this.cloneNode(e.el),this.elements=[]};b.prototype.findReplacement=function(t){for(var e=t;null!=e&&e!=t.root;e=e.parent)if(e instanceof g&&e.replacement)for(var n=0;n<e.replacement.length;n++)if(e.replacement[n].repeat==this.repeat){this.replacement=e.replacement[n];break}},b.prototype.update=function(){if("in_other_repeat"!=this.type){var n=document.createDocumentFragment(),i=0,r=this.elements,s=this.repeat,a=s.orderBy;a&&r.sort(function(t,e){return t=t.model.data[a],e=e.model.data[a],t>e?1:e>t?-1:0});for(var t=0,e=r.length;e>t;t++){var o=r[t];void 0===s.filter||this.collection.root.fns[s.filter](v,o.model)?(n.appendChild(o),o.setAttribute("sn-index",i),s.indexAlias&&(o.setAttribute("sn-index-alias",s.indexAlias),this.collection.root.trigger("sync:"+s.collectionName+"/"+s.alias+"/"+s.indexAlias,o.model)),i++):o.parentNode&&o.parentNode.removeChild(o)}this.replacement.parentNode.insertBefore(n,this.replacement)}else for(var t=0,e=this.children.length;e>t;t++)this.children[t].update()},b.prototype.cloneNode=function(t,e,n){var r,i=t.cloneNode(!1);if(t==this.el&&(i.repeat=this,i.model=e),n&&n.appendChild(i),8==t.nodeType&&t.repeat)i.repeat=t.repeat,e&&(e.replacement||(e.replacement=[])).push(i);else if(t.bindings&&(i.bindings=t.bindings,e?(i.model=e,t._origin._elements.push(i),e.root.setElementAttribute(i)):i._origin=t),1==t.nodeType&&(r=t.childNodes.length))for(var s=0;r>s;s++)this.cloneNode(t.childNodes[s],e,i);return i},b.prototype.each=function(t){for(var e=0;e<this.children.length;e++)t.call(this,this.children[e]);return this},b.prototype.remove=function(t,e){if("in_other_repeat"==this.type)for(var n=0,r=this.children.length;r>n;n++)this.children[n].remove(t,e);else this.elements.splice(t,e||1).forEach(function(t){i(t).remove()})},b.prototype.add=function(t){if("in_other_repeat"==this.type)for(var e=0,n=this.children.length;n>e;e++)this.children[e].add(t);else this.elements[this.elements.length]=this.cloneNode(this.el,t)},b.prototype.clear=function(){if("in_other_repeat"==this.type)for(var t=0,e=this.children.length;e>t;t++)this.children[t].clear();else{for(var t=this.elements.length-1;t>=0;t--)this.elements[t].parentNode.removeChild(this.elements[t]);this.elements.length=0}};var _=function(t,e,n){var i;if(this.models=[],this.parent=t,this.key=t.key?t.key+"."+e:e,this._key=e,this.root=t.root,this.repeats=[],i=t.root.repeats[this.key])for(var r=0;r<i.length;r++)this.repeats[this.repeats.length]=new b(this,i[r]);this.data=[],this.add(n),this.data=n};_.prototype=Object.create(a),_.prototype.each=function(t){for(var e=0;e<this.models.length;e++)t.call(this,this.models[e]);return this},_.prototype.add=function(t){var e,n;i.isArray(t)||(t=[t]);for(var r=0,s=t.length;s>r;r++){var a=t[r];n=this.data.length,e=new g(this,n,a,this.repeats),this.models[n]=e,this.data[n]=a,this.trigger("add",e)}for(var r=0,o=this.repeats.length;o>r;r++)this.repeats[r].update();var l=this.key.replace(/\./g,"/");this.root.trigger("sync:"+l,this.parent,this._key,this.data).trigger("sync:"+l+"/length",this.parent,this._key,this.data)},_.prototype.remove=function(t,e){this.models.splice(t,e||1),this.data.splice(t,e||1);for(var n=0,i=this.repeats.length;i>n;n++)this.repeats[n].remove(t,e)},_.prototype.clear=function(t){this.models.length=this.data.length=0;for(var e=0,n=this.repeats.length;n>e;e++)this.repeats[e].clear()},_.prototype.set=function(t){if(0==t.length)this.clear();else{console.log(t.length,this.data.length),t.length<this.data.length&&this.remove(t.length,this.data.length-t.length);var e=0;for(this.each(function(n){n.set(!0,t[e]),e++});e<t.length;e++)this.add(t[e])}return this},_.prototype.get=function(t){return this.models[t]};var x=["tap","click","change","focus","blur"],w=function(t,e){this.data=i.extend(!0,{},e),this.model={},this.repeats={},this._fns=[],this.fns=[],this.scan(t),this.init=!0,this.set(e),this.init=!1};w.prototype=Object.create(g.prototype),w.prototype.key="",w.prototype.compileExpression=function(t,e,n){var i=this,r="function(Filters,model,el){var $el=$(el);var $data=$.extend({},Filters,model.root.data";if(e){r+=",{";for(var s=e.parent,a=e;null!=s;a=s,s=s.parent)r+=s.alias+":"+(a.isChild?"model.closest('"+s.collectionName+"^child').data":'Filters.closestRepeatModel(el,"'+s.alias+'")')+",",s.indexAlias&&(r+=s.indexAlias+":$el.closest('[sn-index-alias=\""+s.indexAlias+'"]\').attr("sn-index"),');r+=e.alias+":model.data",e.indexAlias&&(r+=","+e.indexAlias+":$el.closest('[sn-index-alias=\""+e.indexAlias+'"]\').attr("sn-index")'),r+="}"}var o=[];return r+=");with($data){return '"+t.replace(d,function(t){return o[o.length]=t,"``"+(o.length-1)+"~~"}).replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(h,function(t,r){return"'+("+r.replace(/\\\\/g,"\\").replace(/\\'/g,"'").replace(f,function(t,r,s){var a=s.split("."),o=a[0];if("Math"==o||"$"==o||c.test(s)||!o||v[o])return r+s;var l;if(e)if(o==e.alias)a[0]=e.collectionName+"^child";else if(o==e.indexAlias)l=e;else for(var u=e.parent;null!=u;u=u.parent)u.alias==o?a[0]=u.collectionName+"^child":o==u.indexAlias&&(l=u);return l?i.on("sync:"+l.collectionName+"/"+l.alias+"/"+l.indexAlias,n):i.on("sync:"+a.join("/"),n),r+p(s)})+")+'"}).replace(/``(\d+)~~/g,function(t,e){return o[e]}),r+="';}}",r.replace("return ''+","return ").replace(/\+\'\'/g,"")},w.prototype.setElementAttribute=function(t,e){var n=this;if(t.bindings){{e?[e]:t.bindings}for(var e in t.bindings){var s=n.fns[t.bindings[e]](v,t.model||n,t);"textContent"==e?t.textContent!=s&&(t.textContent=s):"value"!=e||"INPUT"!=t.tagName&&"SELECT"!=t.tagName&&"TEXTAREA"!=t.tagName?"html"==e||"sn-html"==e?t.innerHTML=s:"display"==e||"sn-display"==e?t.style.display=r.isFalse(s)?"none":"block"==s||"inline"==s||"inline-block"==s?s:"":t.getAttribute(e)!=s&&t.setAttribute(e,s):t.value!=s&&(t.value=s)}}},w.prototype.bindAttr=function(t,e,n,i){var r=this;if(r.root=this,h.test(n)){var s=function(n,s){if(i)for(var a=0;a<t._elements.length;a++){var o=t._elements[a];(s==s.root||o.model==s||s.contains(o.model))&&r.setElementAttribute(o,e)}else r.setElementAttribute(t,e)};(t.bindings||(t._elements=[],t.bindings={}))[e]=r.fns.length+r._fns.length;var a=this.compileExpression(n,i,s);r._fns.push(a)}},w.prototype.getModel=function(t,e,n){for(var s,a,o,i=e.split("."),r=i[0],l=t;null!=l&&l!=document.body;l=l.parent)if(l.model&&!s&&(s=l.model),l.repeat&&l.repeat.repeat.alias==r){o=l.repeat.repeat.collectionName+"^child",a=l.model,i.shift();break}return a||(a=this),n&&n(a,i.join("."),s),a},w.prototype.scan=function(t){for(var e=this,n=[],r=i(t).on("input change","[sn-model]",function(t){if(1!=t._stopModelEvent){var n=t.currentTarget,i=n.getAttribute("sn-model");e.getModel(n,i,function(t,e){t.set(e,n.value)}),t._stopModelEvent=!0}}),s=0;s<x.length;s++)r.on(x[s],"[sn-"+x[s]+"]",function(t){if(1!=t._stopModelEvent){var n=t.currentTarget,i=n.getAttribute("sn-"+t.type);e.getModel(n,i,function(e,n,i){t.model=i,e.get(n).call(e,t)}),t._stopModelEvent=!0}});m(t,function(t,i,r){if(1==t.nodeType){var s=t.getAttribute("sn-repeat");if(null!=s){var a=s.match(u);s=new y({viewModel:e,parent:r.repeat,alias:a[1],indexAlias:a[2],collectionName:a[3],filters:a[4],orderBy:a[5],el:t}),(e.repeats[s.collectionName]||(e.repeats[s.collectionName]=[])).push(s)}else s=r.repeat;s&&(t.childNodes.repeat=s);for(var o=0;o<t.attributes.length;o++){var l=t.attributes[o].name,c=t.attributes[o].value;"sn-error"==l?l="onerror":"sn-src"==l&&(l="src"),("sn-display"==l||0!=l.indexOf("sn-"))&&e.bindAttr(t,l,c,s)}!s&&t.bindings&&(n[n.length]=t)}else 3==t.nodeType&&(e.bindAttr(t,"textContent",t.textContent,r.repeat),!r.repeat&&t.bindings&&(n[n.length]=t))}),[].push.apply(this.fns,window.eval("["+this._fns.join(",")+"]")),this._fns.length=0;for(var s=0,a=n.length;a>s;s++)e.setElementAttribute(n[s])},e.ViewModel=w,e.Filters=v});define("core/page",["../widget/tip","$","util","./base","./view","./promise","../widget/dialog"],function(t,e,n){t("../widget/tip");var i=t("$"),r=t("util"),a=(t("./base"),t("./view")),o=t("./promise"),c=(t("../widget/dialog"),r.noop),f=(r.indexOf,Array.prototype.slice,r.getPath),d=a.extend({options:{route:null},application:null,el:'<div class="view"></div>',_setRoute:function(t){this.route=t,this.hash=t.hash,this.url=t.url,this.path=t.path,this._queries=this.queries,this.queries=i.extend({},t.queries)},loadTemplate:function(){var t=this,e=1,n=function(){e--,0==e&&(t.$el.html(t.razor.html(t.data)).appendTo(t.application.$el),t.trigger("Create"),t._promise.resolve())};return t.route.api&&(e++,i.ajax({url:t.route.api,type:"GET",dataType:"json",success:function(e){t.data=e,n(e)},error:function(t){n({success:!1,content:t.responseText})}})),seajs.use(t.route.template,function(e){t.razor=e,n()}),t._promise},initialize:function(){var t=this,e=o.resolve();t._promise=e,t.className=t.el.className,t._setRoute(t.options.route),t.application=t.options.application,t.on("Start",t.onStart).on("Resume",t.onResume).on("Show",t.onShow).on("Show",t._statusChange).on("Pause",t.onPause).on("Pause",t._statusChange).on("QueryChange",t.onQueryChange).on("QueryChange",t.checkQuery),t.$el.data("path")||(t.$el.data("url",t.url).data("path",t.path),e.then(t.loadTemplate,t)),e.then(t.onCreate,t).then(function(){t.trigger("Start"),t.checkQuery()})},onCreate:c,onStart:c,onResume:c,onShow:c,onStop:c,onRestart:c,onPause:c,_statusChange:function(t){"Pause"==this._status&&this.trigger("Resume"),this._status=t.type},onQueryChange:c,then:function(t){return this._promise.then(t,this),this},queryString:function(t,e){if("undefined"==typeof e)return this.route.queries[t];null===e||e===!1||""===e?delete this.route.queries[t]:this.route.queries[t]=e||"";var n=i.param(this.route.queries);location.hash=this.route.path+(n?"?"+n:"")},_queryActions:{},checkQuery:function(){var r,t=this,e=t.queries,n=t._queries;i.each(t._queryActions,function(t,i){if(r=e[t]||"",r&&!n||n&&r!=n[t]){var s=i.map[r];s.exec?s.exec=!1:s.fn.apply(i.ctx)}})},bindQueryAction:function(t,e,n){var r=this,a={},o={ctx:e,map:a};return i.each(n,function(i,s){var s=n[i],o=e[s],l={fn:o,exec:!1};a[i]=l,e[s]=function(){o.apply(e,arguments),r.queryString(t)!=i&&(l.exec=!0,r.queryString(t,i))}}),this._queryActions[t]=o,this},onResult:function(t,e){return this.listenTo(this.application,t,e)},setResult:function(){return this.application.trigger.apply(this.application,arguments),this},compareUrl:function(t){return f(t)===this.route.path.toLowerCase()},back:function(t){this.application.to(t)},forward:function(t){this.application.to(t)}});sl.Page=d,n.exports=d});define("core/navigation",["$","util","./base","./view","./route","./master","./promise"],function(t,e,n){var i=t("$"),r=t("util"),a=(t("./base"),t("./view")),o=t("./route"),l=t("./master"),c=t("./promise"),d=(r.noop,Array.prototype.slice,r.getPath,o.standardizeHash),p=l.checkQueryString,m=a.extend(l,{events:{"click a[href]:not(.js-link-default)":function(t){var n=i(t.currentTarget);if(!/^(http\:|https\:|javascript\:|mailto\:|tel\:)/.test(n.attr("href"))&&"_blank"!=n.attr("target")){t.preventDefault();var r=n.attr("href");return/^#/.test(r)||(r="#"+r),location.hash=r,!1}n.addClass("js-link-default")}},el:'<div class="screen" style="position:fixed;top:0px;bottom:0px;right:0px;width:100%;background:rgba(0,0,0,0);z-index:2000;display:none"></div><div class="viewport"></div>',initialize:function(){var t=this;t.$mask=i(t.$el[0]).on("click",!1),t.el=t.$el[1],t.promise=c.resolve()},start:function(){var e,t=this,n=i(window),r=i(document.body),s=r.find(".view");t.$el.appendTo(r),t.$el=i(t.el),s.length&&t.$el.append(s.hide()),location.hash||(location.hash="/"),t.hash=e=d(location.hash),t.promise.then(function(){return t.get(e,function(e){e.$el.show().appendTo(t.el),t._currentActivity=e,e.then(function(){e.trigger("Resume").trigger("Show"),t.trigger("start"),t.promise.resolve()})}),n.on("hashchange",function(){e=t.hash=d(location.hash),0==t.skip?t.to(e):t.skip>0?t.skip--:t.skip=0}),t.promise})},navigate:function(t){t=d(t),this.skip++,location.hash=t},to:function(t){t=d(t);var e=this,n=e.promise;n.then(function(){var i=e._currentActivity,r=e.route.match(t);return 0==n.queue.length&&t!=d(location.hash)&&e.navigate(t),i.path==r.path?(p(i,r),void n.resolve()):(e.get(r,function(t){t.path==i.path?p(t,r):(e._currentActivity=t,null===t.el.parentNode&&t.$el.appendTo(i.application.el),t.$el.show().siblings(".view").hide(),t.then(function(){t.trigger("Resume").trigger("Show")})),n.resolve()}),n)})}});sl.Navigation=m,n.exports=m});define("core/route",[],function(t,e,n){var i=function(t){return(t.replace(/^#+|\/$/,"")||"/").toLowerCase()},r=function(t,e){var i,r,s,o,a,l,n=[];for(var c in t){if(i=t[c],r=[],l="^(?:/{0,1})"+c.replace(/(\/|^|\?)\{((?:.+?\{[^\}]+\}){0,}[^\}]*)\}/g,function(t,e,n){return a=n.split(":"),a.length>1&&(r.push(a.shift()),n=a.join(":")),e+"("+n+")"})+"$","string"==typeof i)throw new Error("Route options error");s=i.root||"/",o="/"!=s?s.replace(/^\//,"")+"/":"",n.push({regex:new RegExp(l),parts:r,template:o+i.template,view:o+i.controller,api:i.api,root:s})}this.isDebug=e!==!1,this.routes=n};r.prototype.match=function(t){var o,l,c,e=null,n={},r=t=i(t),s=t.indexOf("?"),a=this.routes;-1!=s?(o=t.substr(s+1),t=t.substr(0,s),o.replace(/(?:^|&)([^=&]+)=([^&]*)/g,function(t,e,i){return n[e]=decodeURIComponent(i),""})):o="";for(var u=0,h=a.length;h>u;u++)if(l=a[u],c=l.regex?t.match(l.regex):null){e={path:c[0],url:r,hash:"#"+r,root:l.root,template:l.template,"package":this.isDebug?!1:"/"==l.root?"controller":l.root.replace(/^\//,"")+"/controller",view:l.view,data:{},queryString:o,query:n,queries:n};for(var f=0,d=l.parts.length;d>f;f++)e.data[l.parts[f]]=c[f+1];l.api&&(e.api=l.api.replace(/\{([^\}]+?)\}/g,function(t,n){return e.data[n]}));break}return e},r.standardizeHash=i,n.exports=r});define("core/animation",["$","./linklist","graphics/matrix2d","graphics/tween","util"],function(t,e){for(var n=t("$"),i=t("./linklist"),r=t("graphics/matrix2d"),s=t("graphics/tween"),o=(t("util"),["webkit"]),l=0;l<o.length&&!window.requestAnimationFrame;++l)window.requestAnimationFrame=window[o[l]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[o[l]+"CancelAnimationFrame"]||window[o[l]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){return setTimeout(t,16.7)},window.cancelAnimationFrame=function(t){clearTimeout(t)});var u=new i,c=!0,h=n.fx.cssPrefix+"transform",f={opacity:1},p=/(\d+\.\d+|\d+)\%/g,m=/translate\((\-{0,1}\d+(?:\.\d+){0,1}(?:\%|px){0,1})\s*\,\s*(\-{0,1}\d+(?:\.\d+){0,1}(?:\%|px){0,1})\)/,v=/matrix\((\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\,\s*(\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\,\s*(\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\,\s*(\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\,\s*(\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\,\s*(\-{0,1}\d+\.\d+|\-{0,1}\d+)\s*\)/,g=/(translate|skew|rotate|scale|matrix)\(([^\)]+)\)/g,y=/matrix\([^\)]+\)\s*$/,b=function(t){if(t){t instanceof Array||(t=[t]);for(var e=0,n=t.length;n>e;e++)"string"==typeof t[e]&&(t[e]=s[t[e].replace(/\-([a-z])/g,function(t,e){return e.toUpperCase()})])}else t=[s.easeOut];return t},_=function(t){var e=[];return n.each(t,function(t,n){e.push(isNaN(parseFloat(n))?0:parseFloat(n))}),e},x=function(t,e,n){return parseFloat(t)+(parseFloat(e)-parseFloat(t))*n},w=function(t){var e=new r;return t.replace(g,function(t,n,i){e["matrix"==n?"append":n].apply(e,_(i.split(",")))}),e},T=function(t){var i,s,e={};return n.each(t,function(t,n){/matrix|translate|skew|rotate|scale|invert/.test(t)?("translate"===t?n=(e[h]||"")+" "+t+"("+n+")":(s||(s=new r),i=e[h]||"",n=s["matrix"==t?"append":t].apply(s,_(n.split(","))).toString(),n=y.test(i)?i.replace(y,n):i+" "+n),t=h):"transform"===t&&(t=h,s=null),e[t]=n}),{css:e,matrix:s}};e.transform=T,n.fn.transform=function(t){return this.css(T(t).css),this},n.fn.matrix=function(t){return t instanceof r?(this.css(h,t.toString()),this):w(getComputedStyle(this[0],null)[h])};var A=function(){if(u.length){c=!1;for(var t,e,n,a,s=(+new Date,u._idlePrev);s!=u;){if(a=s._idlePrev,first=s.data,t=Date.now()-first.startTime,n=[],e=first.ease,t<=first.duration){for(var o=0,l=e.length;l>o;o++)n.push(e[o](t,first.from,first.to-first.from,first.duration)/100);first.step.apply(first,n)}else{for(var h=first.to/100,o=0,l=e.length;l>o;o++)n.push(h);first.step.apply(first,n),u._remove(s),first.finish&&first.finish(h)}s=a}requestAnimationFrame(A)}else c=!0},M=function(t){return t.startTime=Date.now(),t.ease=b(t.ease),t.stop=function(){u.remove(t)},void 0===t.from&&(t.from=0),void 0===t.to&&(t.to=100),t.duration||(t.duration=300),t},E=function(t){for(var e=0,n=t.length;n>e;e++)u.append(M(t[e]));c&&A()},$=function(t){var e,i,r,s,a;this.el.each(function(){if(e=this._animationStyle,i=this._originStyle,0==t)a=i;else if(1>t){a={};for(var o in e)if(s=e[o],r=i[o],o==h){var l=r.match(v)||["",1,0,0,1,0,0],c=w(s);c.a=x(l[1],c.a,t),c.b=x(l[2],c.b,t),c.c=x(l[3],c.c,t),c.d=x(l[4],c.d,t),c.tx=x(l[5],c.tx,t),c.ty=x(l[6],c.ty,t),a[o]=c.toString()}else isNaN(parseFloat(s))?a[o]=s:(r=isNaN(parseFloat(r))?f[o]||0:parseFloat(r),a[o]=x(r,s,t))}else a=e;n(this).css(a)}),this._step&&this._step(t)},k=function(t){1==t&&this.el.css(this.css),this._finish&&this._finish(t)},N=function(t){for(var e,i,s,l=0,u=t.length;u>l;l++)e=t[l],e.css&&(s=T(e.css),e.matrix=s.matrix,e.css=s.css,i=e.el=n(e.el),"object"==typeof e.start&&i.transform(e.start),i.each(function(){var t=this,i={},r={},s=getComputedStyle(t,null);n.each(e.css,function(e,n){"string"==typeof n&&(e==h?n=n.replace(m,function(e,n,i){return"translate("+(-1!==n.indexOf("%")?t.offsetWidth*parseFloat(n)/100:parseFloat(n))+"px,"+(-1!==i.indexOf("%")?t.offsetHeight*parseFloat(i)/100:parseFloat(i))+"px)"}):/^(top|margin(-t|T)op)$/.test(e)?n=n.replace(p,function(e){return t.parentNode.offsetHeight*parseFloat(e)/100+"px"}):/^(left|margin(-l|L)eft|padding(-l|L)eft|padding(-t|T)op)$/.test(e)&&(n=n.replace(p,function(e){return t.parentNode.offsetWidth*parseFloat(e)/100+"px"}))),r[e]=s[e],i[e]=n}),t._animationStyle=i,t._originStyle=r}),e._step=e.step,e.step=$,e._finish=e.finish,e.finish=k);return t},j=function(t){n.isArray(t)||(t=[t]),N(t),this.list=t};j.prototype.step=function(t){for(var e,n=this.list,i=0,r=n.length;r>i;i++)e=n[i],e.from=t,e.step(t/100);return this},j.prototype.animate=function(t,e,n){for(var i,r=this.list,s=0,a=r.length;a>s;s++)i=r[s],i.duration=t,i.to=e,i.finish=i.start=void 0;return i.finish=n,E(r),this},e.Animation=j,e.parallel=function(t){E(N(t))},e.animate=function(){var t=arguments,e={},n=0,i=t[n++];return"function"==typeof i?e.step=i:(e.el=i,e.css=t[n++]),e.duration=t[n++],e.ease=t[n++],e.finish=t[n],E([e]),e};var S={step:function(t){for(var i,e=0,n=this.momentums.length;n>e;e++)i=this.momentums[e],i.current=i.start+(i.result-i.start)*t;this.momentumStep.apply(this.ctx,this.momentums)},finish:function(){this.bounce()},bounce:function(){for(var e,n,s,t=0,i=0,r=this.momentums.length;r>i;i++)s=this.momentums[i],n=s.current<s.min?s.min:s.current>s.max?s.max:s.current,n!=s.current?(s.start=s.current,s.result=n,t++):s.divisor&&n%s.divisor!=0&&(e=s.divisor,s.start=s.current,s.result=e/2>n%e?n-n%e:n-n%e+e,t++);0==t?this.end.call(this.ctx):(this.duration=400,E([this]))}},O=function(t,e,n,i,r,s,a){var m,v,o=e-t,l=r-e,u=e-i,c=6e-4,h=Math.abs(o)/n,f=h*h/(2*c),d=0,p=0;return s=a||s,o>0&&f>l?(p=s/(6/(f/h*c))/2,l+=p,h=h*l/f,f=l):0>o&&f>u&&(p=s/(6/(f/h*c))/2,u+=p,h=h*u/f,f=u),f*=0>o?-1:1,p*=0>o?-1:1,d=h/c,v=e+f,0!=p&&(m=.15/(p/f),m>1&&(f-=p,p/=m,f+=p,v=e+f)),i>e&&i>v||e>r&&v>r?(f=0,d=0,outside=0,v=e):(a&&0==p&&(v=v%a==0?v:a/2>v%a?v-v%a:v-v%a+a,v=v>r?r:i>v?i:v,300>d&&(d=300),f=v-e),a&&d>400&&(d=400)),{dist:f,time:Math.round(d),outside:p,result:v,current:e,start:e,max:r,min:i,divisor:a}};e.step=x,e.momentum=function(t,e,i,r,s,a){var o=[],l={},u=0;if("number"==typeof t[0])t=[t];else if(!t.length)return void s.call(a);for(var f,c=0,h=t.length;h>c;c++)f=O.apply(this,t[c]),0!=f.dist&&(u=Math.max(u,f.time)),o.push(f);for(var f,c=0,h=o.length;h>c;c++)f=o[c],0!=f.outside&&(f.result=f.result-f.outside+400*f.outside/u);return n.extend(l,S,{ctx:a||l,momentums:o,momentumStep:i,duration:u,ease:r,end:s}),0!=u?(e&&l.duration>e&&(l.duration=e),E([l])):l.bounce(),l}});define("core/master",["$","util","./route"],function(t,e,n){var r=(t("$"),t("util")),s=t("./route"),a=r.getPath,o={checkQueryString:function(t,e){t.route.url!=e.url&&(t._setRoute(e),t.trigger("QueryChange"))},mapRoute:function(t,e){return this.route=new s(t,e),this},skip:0,_currentActivity:null,_activities:{},set:function(t,e){this._activities[a(t)]=e},get:function(t,e){var n=this,i="string"==typeof t?n.route.match(t):t;if(i){var r=a(i.path),s=this._activities[r];null==s?!function(t){i["package"]?seajs.use(i["package"]+".js?v"+sl.buildVersion,t):t()}(function(){seajs.use(i.view,function(t){var o,a={application:n,route:i};null!=t?(o=n.$el.find('[data-path="'+i.path+'"]'),o.length&&(a.el=o),s=new t(a),n.set(r,s),s.then(function(){e.call(n,s,i)})):(n.skip++,location.hash=n._currentActivity.url)})}):e.call(n,s,i)}},remove:function(t){this._activities[a(t)]=void 0}};n.exports=o});define("common/page",["$","util","core/page"],function(t,e,n){var i=t("$"),s=(t("util"),t("core/page"));return s.extend({initialize:function(){var t=this;s.prototype.initialize.call(this,arguments),i.get("/api/manage/islogin",function(e){e.success||t.forward("/login")},"json")}})});define("common/menu.tpl",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<div class="menu"> <div class="menu_hd"> èå </div> <div class="menu_sub_hd"><a href="/login">éåºç³»ç»</a></div> <div class="menu_bd"> <dl sn-repeat="item in data"> <dt sn-binding="class:item.current|case:true:\'curr\':\'\'"> <a sn-binding="html:item.title,href:item.url"></a> </dt> <dd sn-repeat="child in item.children" sn-binding="class:child.current|case:true:\'curr\':\'\'"> <a sn-binding="html:child.title,href:child.url"></a> </dd> </dl> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("common/menu",["$","util","./menu.tpl","core/model"],function(t,e,n){var i=t("$"),r=t("util"),s=t("./menu.tpl"),a=t("core/model");n.exports=e=function(){this.$el=i(s.html()),this.model=new a.ViewModel(this.$el,{area:r.store("global_area")||1,data:[{url:"/settings/ad_list",title:"å¹¿åä½ç®¡ç",children:[{title:"æ·»å å¹¿åä½",url:"/settings/add_ad"}]}]})};var o=null;e.get=function(t){!o&&(o=new e),o.current&&o.current.set({current:!1});for(var i,n=0;n<o.model.data.data.length;n++){i=o.model.data.data[n];var r=i.children;if(i.url==t||i.id==t){o.current=o.model.get("data").get(n).set({current:!0});break}if(r)for(var s=0;s<r.length;s++)if(r[s].url==t||r[s].id==t){o.current=o.model.get("data."+n+".children."+s).set({current:!0});break}}return o.$el.show(),o}});define("components/timepicker",["$","util"],function(t,e,n){var i=t("$"),r=t("util"),s=20;r.style('.calendar.curr{z-index:5001;}.calendar{height:22px;padding:1px;zoom:1;display:inline-block;*display:inline;position:relative;overflow:visible;z-index:0;color:#000;}\r\n        .calendar span {cursor:pointer;border:0;margin:0;padding:0 2px;height:20px;line-height:20px;display:inline-block;position:relative;color:#000;background-color:#f1f1f1;}\r\n        .calendar span.calendar-year {}\r\n        .calendar-icon{margin: -4px 0 0 -2px;_margin-top: 0px;display: inline-block;vertical-align: middle;position: relative;font-size: 12px;width: 10px;height: 4px;overflow: hidden;line-height: 12px;font-family: "SimSun";}\r\n        .calendar-icon em {display: inline-block;height: 19px;overflow: hidden;font-family: "SimSun";position: absolute;top: -7px;left: 0px;}\r\n        .calendar-up .calendar-icon em {top: 0px;left: 0px;}\r\n        .calendar-up,.calendar-down {cursor:pointer;}\r\n        .calendar-bd {display:none;position:absolute;border:1px solid #cdcdcd;background:#fff;width:35px;text-align:center;top:0;left:0;}\r\n        .calendar-bd i { display: block; height: '+s+"px;font-style:normal; }\r\n        .calendar-bd i.curr { background:#ddd; }");var a='<%for(var i=0,len=$data.length,item;i<len;i++){item=$data[i];%><div class="calendar-bd <%=item.css%>"><div class="calendar-up"><em class="calendar-icon"><em>â</em></em></div><div class="calendar-con"><%=item.content%></div><i class="js_calendar_now"><%=item.text%></i><div class="calendar-down"><em class="calendar-icon"><em>â</em></em></div></div><%}%>',o='<div class="calendar"><span class="calendar-year" style="z-index:10;"><em data-val="<%=year%>"><%=yyyy%></em></span>/<span style="z-index:9;"><em data-val="<%=month%>"><%=MM%></em></span>/<span style="z-index:8;"><em data-val="<%=day%>"><%=dd%></em></span> <span style="z-index:7;"><em data-val="<%=hour%>"><%=hh%></em></span>:<span style="z-index:6;"><em data-val="<%=minutes%>"><%=mm%></em></span>:<span style="z-index:5;"><em data-val="<%=seconds%>"><%=ss%></em></span></div>',l=function(t,e,n){for(var i="",s=t;e>=s;s++)i+='<i data-val="'+r.pad(s,n)+'">'+r.pad(s,n)+"</i>";return e-t>=10?'<div style="height:200px;overflow:hidden;">'+i+"</div>":i},c=function(t,e){var n=new Date,c=this;e=i.extend({yearFrom:n.getFullYear()-30,yearTo:n.getFullYear()+5},e),this.$input=t;var u=i(r.template(o,{yyyy:"----",MM:"--",dd:"--",hh:"--",mm:"--",ss:"--",year:n.getFullYear(),day:n.getDate(),month:n.getMonth()+1,hour:n.getHours(),minutes:n.getMinutes(),seconds:n.getSeconds()})).insertBefore(t),h=u.find("span em"),d=i(r.template(a,[{css:"js_calendar_year",content:l(e.yearFrom,e.yearTo,4),text:"ä»å¤©"},{css:"js_calendar_month",content:l(1,12),text:"ä»å¤©"},{css:"js_calendar_day",text:"ä»å¤©"},{css:"js_calendar_hours",content:l(0,23),text:"ç°å¨"},{css:"js_calendar_minutes",content:l(0,59),text:"ç°å¨"},{css:"js_calendar_seconds",content:l(0,59),text:"ç°å¨"}])),f=[0,0,0,0,0,0],p=[31,28,31,30,31,30,31,31,30,31,30,31];this.timeStore=f,t.on("timeChange",function(){var t=this.value;if(!t)return h.html("--"),h.eq(0).html("----"),void d.eq(2).find(".calendar-con").html("");i.each(t.split(/\s|\:|-|\//),function(t,e){e=parseInt(e.replace(/^0+/,""))||0,f[t]=e,h.eq(t).text(e||0===e?r.pad(e,0==t?4:2):"--")});var n,e=f[0];n=e%4!=0||e%100==0&&e%400!=0?p[1]=28:p[1]=29,e=f[1],n=p[e-1],f[2]>n&&(f[2]=n,h.eq(2).text(r.pad(n))),d.eq(2).find(".calendar-con").html(l(1,n,2)),c._update()}),u.children("span").each(function(e){var n=i(this),a=n.find("em"),o=d.eq(e);n.click(function(t){var e=a.text();"-"==e[0]&&(e=a.data("val"));var r=o.find(".calendar-con i"),l=r.eq(0),c=r.filter('[data-val="'+e+'"]'),h=c.index();if(r.filter(".curr").removeClass("curr"),-1!=h){c.addClass("curr");var d=(5-h)*s;d=Math.max(d,(r.length-10)*s*-1),d=Math.min(d,0),l.css({"margin-top":d}),o.css({"margin-top":Math.max(-1*n.offset().top,-1*h*s-d-20)})}else o.css({"margin-top":Math.max(-1*n.offset().top,-5*s-20)});return o.show(),u.addClass("curr"),i(document.body).on("mouseup",function(t){0==o.has(t.target).length&&(o.hide(),u.removeClass("curr"),i(this).off("mouseup",arguments.callee))}),t.preventDefault(),!1}).append(o),o.delegate(".calendar-con i","click",function(n){var u,s=i(this).attr("data-val");return o.hide(),a.text(s),s=parseInt(s.replace(/^0+/,""))||0,f[e]=s,o.hasClass("js_calendar_year")?(u=s%4!=0||s%100==0&&s%400!=0?p[1]=28:p[1]=29,2==f[1]&&f[2]>u&&(f[2]=u,h.eq(2).text(r.pad(u)))):o.hasClass("js_calendar_month")&&(u=p[s-1],f[2]>u&&(f[2]=u,h.eq(2).text(r.pad(u))),d.eq(2).find(".calendar-con").html(l(1,u,2))),c._update(),t.trigger("onTimeChange"),n.preventDefault(),!1}),o.find(".calendar-down").click(function(t){var e=o.find(".calendar-con i"),n=e.eq(0),i=parseInt(n.css("margin-top"));return i-=10*s,n.css({"margin-top":Math.max(i,(e.length-10)*s*-1)}),!1}),o.find(".calendar-up").click(function(t){var e=o.find(".calendar-con i"),n=e.eq(0),i=parseInt(n.css("margin-top"));return i+=10*s,n.css({"margin-top":Math.min(i,0)}),!1})}),u.find(".js_calendar_now").click(function(t){var e=new Date;return f[0]=e.getFullYear(),f[1]=e.getMonth()+1,f[2]=e.getDate(),"ç°å¨"==i(this).text()&&(f[3]=e.getHours(),f[4]=e.getMinutes(),f[5]=e.getSeconds()),c._update(),u.find(".calendar-bd").hide(),!1}),""!=t.val()&&t.trigger("timeChange")};c.prototype={_update:function(){var t=this.timeStore;this.$input.val(r.pad(t[0],4)+"-"+r.pad(t[1])+"-"+r.pad(t[2])+" "+r.pad(t[3])+":"+r.pad(t[4])+":"+r.pad(t[5])).trigger("change")},val:function(t){this.$input.val(t).trigger("timeChange")}},n.exports=c});define("components/validator",["$"],function(t,e,n){var i=t("$"),r=function(t){i.extend(this,t)};r.prototype={emptyAble:!0,emptyText:"ä¸å¯ä¸ºç©º",regex:null,regexText:null,compare:null,compareText:"",validate:null,validateText:null,success:""},n.exports=e=function(t,e){var n;this.options={},this.data=e;for(var i in t)n=t[i],this.options[i]=new r(n)},e.prototype.set=function(t){this.data=t},e.prototype.set=function(t){this.data=t},e.prototype.valid=function(t,e){return t?""!==e&&null!=e||t.emptyAble!==!1&&(!i.isFunction(t.emptyAble)||t.emptyAble())?""==e||null==e||null===t.regex||t.regex.test(e)?t.compare&&this.data[t.compare]!=e?{success:!1,msg:t.compareText}:t.validate&&!t.validate.call(this,e)?{success:!1,msg:t.validateText}:{success:!0,msg:"function"==typeof t.success?t.success.call(this,e):t.success}:{success:!1,msg:t.regexText}:{success:!1,msg:t.emptyText}:{success:!0}},e.prototype.validate=function(t){if(t)return this.valid(this.options[t],this.data[t]);var r,i={success:!0,result:{}};for(var t in this.options)r=this.valid(this.options[t],this.data[t]),i.result[t]=r,i.success&&(i.success&=r.success);return i}});define("components/form.tpl",["util"],function(require){var util=require("util"),T={html:function($data){var __="";with($data||{}){__+='<form action="'+util.encodeHTML(url)+'" method="'+util.encodeHTML(method)+'" enctype="'+util.encodeHTML(enctype||"multipart/form-data")+'" class="form"> ';for(var i=0,len=hiddens.length;len>i;i++){var field=hiddens[i];__+='<input type="hidden" name="'+util.encodeHTML(field.field)+'" sn-model="'+util.encodeHTML(name)+"."+util.encodeHTML(field.field)+'" sn-binding="value:'+util.encodeHTML(name)+"."+util.encodeHTML(field.field)+'" />'}__+=' <table width="100%"> <tbody> ';for(var i=0,len=fields.length;len>i;i++){var field,items=fields[i];__+="<tr> ",items.length||(items=[items]),__+=" ";for(var j=0,length=items.length;length>j;j++){field=items[j];var attr='style="'+(field.width?"width:"+field.width+"px;":"")+(field.height?"height:"+field.height+"px;":"")+'" name="'+field.field+'" sn-model="'+name+"."+field.field+'" sn-binding="value:'+name+"."+field.field+'"';if(__+="<th "+(field.vAlign?'style="vertical-align:'+field.vAlign+'"':"")+">"+util.encodeHTML(field.label)+" ",field.emptyAble===!1&&(__+="<i>*</i>"),__+='</th> <td colspan="'+util.encodeHTML(field.colSpan||1)+'"> ',"text"!=field.type&&field.type)if("textarea"==field.type)__+='<textarea class="'+util.encodeHTML(field.className||"text")+'"'+attr+"></textarea>";else if("select"==field.type){__+='<select class="'+util.encodeHTML(field.className||"text")+'"'+attr+"> ";for(var ii=0,len1=field.options.data.length;len1>ii;ii++){var option=field.options.data[ii];__+='<option value="'+util.encodeHTML(option[field.options.value||"value"])+'">'+util.encodeHTML(option[field.options.text||"text"])+"</option>"}__+=" </select>"}else"number"==field.type?__+='<input class="'+util.encodeHTML(field.className||"text_normal")+'" type="text"'+attr+"/>":"password"==field.type?__+='<input class="'+util.encodeHTML(field.className||"text")+'" type="password"'+attr+"/>":"captcha"==field.type?__+='<input class="'+util.encodeHTML(field.className||"text_normal")+'" type="text"'+attr+'/> <img class="captcha" src="'+util.encodeHTML(field.captcha)+"?v="+util.encodeHTML(Date.now())+'" onclick="this.src=\''+util.encodeHTML(field.captcha)+"?v='+Date.now()\" sn-binding=\"src:captcha|or:'"+util.encodeHTML(field.captcha)+"'\"/>":"file"==field.type?__+='<input type="file" name="'+util.encodeHTML(field.field)+'" sn-model="'+util.encodeHTML(name)+"."+util.encodeHTML(field.field)+'"/>':"radio"==field.type||"checkbox"==field.type?__+='<input type="'+util.encodeHTML(field.type)+'" name="'+util.encodeHTML(field.field)+'" sn-model="'+util.encodeHTML(name)+"."+util.encodeHTML(field.field)+'" sn-binding="checked:'+util.encodeHTML(name)+"."+util.encodeHTML(field.field)+'|or:undefined"/>':($data.plugins.push(field),__+='<input type="hidden"'+attr+">");else __+='<input class="'+util.encodeHTML(field.className||"text")+'" type="text"'+attr+"/>";__+=' <span sn-binding="class:'+util.encodeHTML(validator)+".result."+util.encodeHTML(field.field)+".success|case:-1:'msg_tip':true:'right_tip':false:'error_tip':'hide',html:"+util.encodeHTML(validator)+".result."+util.encodeHTML(field.field)+'.msg"></span> </td>'}__+=" </tr>"}__+=" </tbody> </table> </form> "}return __},helpers:{}};return T.template=T.html,T});define("components/form",["$","./form.tpl","util","./validator","core/promise","./timepicker"],function(t,e,n){var i=t("$"),r=t("./form.tpl"),s=t("util"),a=t("./validator"),o=t("core/promise"),l=t("./timepicker"),c=["emptyAble","emptyText","regex","regexText","compare","compareText","validate","validateText","success"],u=0;n.exports=e=function(t){var r,o;this.hiddens=[],this.fields=[],this.plugins=[],this.compo={};var l={};for(var u in t)if(r=t[u],"fields"==u)for(var d=0,h=r.length;h>d;d++)if(o=r[d],"hidden"===o.type)this.hiddens.push(o);else{o.length||(o=[o]),this.fields.push(o);for(var f=0,p=o.length;p>f;f++){var m=o[f],v=s.pick(m,c);s.isEmptyObject(v)||(l[m.field]=v)}}else this[u]=r;this.model.set(this.name,{}),this.formModel=this.model.get(this.name),this.data=this.formModel.data,this.valid=new a(l,this.data),this.$el=i(this.template.html(this)).appendTo("body"),this.el=this.$el[0],this.$el.on("blur","[name]",i.proxy(this._validInput,this));for(var d=0,h=this.plugins.length;h>d;d++){var g=this.plugins[d],y=this.$el.find('[name="'+g.field+'"]'),b=this.compo[g.field]=new(e.require(g.type))(y,g),_=this.formModel.data[g.field];_&&b.val(this.formModel.data[g.field]),this.formModel.on("change:"+g.field,function(t){return function(e,n){t.val(n)}}(b))}},e.prototype={model:null,name:"form",template:r,useIframe:!1,validator:"valid",url:"",enctype:"",method:"post",fields:[],reset:function(){for(var t in this.compo)this.compo[t].val("");this.el.reset()},submit:function(t,e){var n=this.valid.validate(),r=this;if(this.model.set(this.validator,n),n.success)if(this.useIframe||this.$el.has('[type="file"]').length){u++;{var a,s="_submit_iframe"+u;i('<iframe style="top:-999px;left:-999px;position:absolute;display:none;" frameborder="0" width="0" height="0" name="'+s+'"></iframe>').appendTo(document.body).on("load",function(){var n=i.trim(this.contentWindow.document.body.innerHTML);if(!a||n!=a){a=n;try{t.call(r,JSON.parse(a))}catch(s){e&&e.call(r,s,a)}}})}this.$el.attr("target",s).submit()}else i.ajax({url:this.url,type:"POST",dataType:"json",data:this.$el.serialize(),success:i.proxy(t,this),error:e&&i.proxy(e,this)});else sl.tip("è¯·æ£æ¥å¡«åæ¯å¦æè¯¯")},_validInput:function(t){var e=i(t.currentTarget),n=e.attr("name"),r=this.valid.validate(n);this.model.data[this.validator]||this.model.set(this.validator,{result:{}}),this.model.set(this.validator+".result."+n,r)},destory:function(){this.$el.on("off","[name]",this._validInput)}};var d={};e.define=function(t,e){d[t.toLowerCase()]=e},e.require=function(t){return d[t.toLowerCase()]};var h=function(t,e){var n=this;n.$input=t,n.id="UMEditor"+h.guid++;i('<script type="text/plain" id="'+n.id+'" style="width:'+(e.width||640)+'px;height:300px;"></script>').insertBefore(t);window.UMEDITOR_HOME_URL=seajs.resolve("components/umeditor/"),n.promise=o(),function(t){window.jQuery?t():seajs.use(["components/umeditor/third-party/jquery.min"],t)}(function(){seajs.use(["components/umeditor/umeditor.config","components/umeditor/umeditor","components/umeditor/themes/default/css/umeditor.css"],function(i){var r={};e.toolbar?r.toolbar=e.toolbar:e.simple&&(r.toolbar=["source | undo redo | bold italic underline strikethrough | removeformat | justifyleft justifycenter justifyright justifyjustify | link unlink | image"]);var s=UM.getEditor(n.id,r);s.addListener("blur",function(){var e=s.getContent(),n=t[0].value;t.val(e),n!==e&&t.trigger("change"),t.trigger("blur")}),n.editor=s,s.ready(function(){n.promise.resolve()})})})};h.prototype={val:function(t){var e=this;e.promise.then(function(){e.editor.setContent(t,!1)}),e.$input.val(t).trigger("change")}},h.guid=0,e.define("RichTextBox",h),e.define("TimePicker",l)});define("components/grid",["$","util","../core/view","./page"],function(t,e,n){var i=t("$"),r=t("util"),s=t("../core/view").prototype,o=t("./page"),l=r.ie&&6==r.osVersion,c=function(t,e,n){var i;return i="number"==typeof t?n?t-e:e-t:(t+"").localeCompare(e+"")*(n?1:-1)},u=l?function(t){t.css({height:0,marginTop:-1})}:function(){$el.hide()},d=l?function(t,e){t.css({height:e,marginTop:""})}:function(){el.show()},h=["url","beforeSend","success","error","type"],f=function(t,e){var n=this,r=t.grid.options;if(this.$el=i(this.el).css(i.extend({width:e.curWidth,height:e.height,"text-align":e.align||"","float":"auto"==e.curWidth?"none":""},e.style)),"center"==e.valign&&this.$el.addClass("grid_cell_vcenter"),this.options=e,this.el=this.$el[0],this.row=t,this.$body=0==e.index&&"tree"!=r.type&&r.children?i('<div class="grid_spread" data-rowindex="'+t.index+'"></div>').appendTo(this.$el):this.$el,0==e.index&&"tree"==r.type){for(var s=[],a=0;a<treeDeep;a++)s.push('<i class="grid_tree_space"></i>');this.$el.prepend(s.join(""));var o=t.data[r.subKey];o&&o.length?(i('<i class="grid_tree" data-treeid="'+t.treeId+'"></i>').appendTo(this.$el),t.$el.addClass("grid_tree_fold"),i.each(o,function(e,n){t.grid.append(n,t.treeDeep+1,t.treeId)})):i("<i class='grid_tree_nochild'></i>").appendTo(this.$el)}var l=t.data[e.bind]||e.defaultVal;if(e.render)e.render.call(n,t.data,t.grid._data);else if("textbox"==e.type){var c=i('<textarea class="grid_cell_textbox" data-row="'+t.index+'" data-cell="'+n.index+'"></textarea>').css({height:r.rowHeight}).val(l);n.$textbox=c,n.$body.append(c),n.on("change",function(t,e){this.$textbox.val(e),this.validate()}),n.validate=function(){var t=!1;return e.emptyAble===!1&&""==this.$textbox.val()?t=this.options.emptyText||this.options.text+"ä¸å¯ä¸ºç©ºï¼":column.regex&&!column.regex.test(textbox.value)&&(t=this.options.regexText||this.options.text+"æ ¼å¼éè¯¯ï¼"),t?this.$el.addClass("grid_cell_err").title=t:this.$el.removeClass("grid_cell_err").title="",!t}}else if("selector"==e.type){var u=i('<input class="grid_selector" data-row="'+t.index+'" type="'+(r.multiselect?"checkbox":"radio")+'" name="__gs_'+t.grid.cid+"'>").prop({checked:!1});n.$body.append(u),n.$selector=t.$selector=u}else this.$body=i('<div class="grid_cell_item'+("center"==e.valign?" grid_cell_vcenter":"")+'">'+l+"</div>").appendTo(this.$body);t.$el.append(n.$el)};f.prototype={trigger:s.trigger,on:s.on,el:'<li class="grid_cell"></li>',$:function(t){return this.$el.find(t)},append:function(t){return this.$body.append(t),this},html:function(t){return"undefined"==typeof t?this.$body.html():(this.$body.html(t),this)},val:function(t){return"undefined"==typeof a?this.value:("string"==typeof t&&/^\/Date\(\d+\)\/$/.test(t)&&(t=r.formatDate(t)),this.value=t,this.options.bind&&(row.data[this.options.bind]=t),this.$textbox?this.$textbox.val(t):this.options.render?options.render.call(self,row.data,row.grid._data):this.html(t),this.trigger("change",t),this)}};var p=function(t,e){this.grid=t,this.$el=i(this.el).css({height:e.height}).data("index",e.index),this.el=this.$el[0],this.data=e.data,this.index=e.index,this.cells=[]};p.prototype={el:'<ul class="grid_row"></ul>',data:null,selected:!1,select:function(){this.selected||(this.selected=!0,this.$el.addClass("grid_row_cur"),this.selector&&this.selector.prop({checked:!0}),this.grid.selectedRows.push(this),this.grid.selectedRow=this,this.grid.trigger("SelectRow",this))},cancelSelect:function(){if(this.selected){this.selected=!1,this.$el.removeClass("grid_row_cur"),this.selector&&this.selector.prop({checked:!1});for(var t=this.grid,e=t.selectedRows,n=0,i=e.length;i>n;n++)if(e[n]==this){e.splice(n,1);break}t.selectedRow==this&&(t.selectedRow=0!=e.length?e[e.length-1]:null)}},cell:function(t,e){return void 0===e?this.cells[t]:(this.cells[t]=new f(this,e),this)},append:function(t){return this.cells.push(new f(this,t)),this},spread:function(){this.$el.find(".grid_spread").removeClass("grid_spread").addClass("grid_fold"),this.childContainer.removeClass("grid_child_non").addClass("grid_child_con")},fold:function(){this.$el.find(".grid_fold").removeClass("grid_fold").addClass("grid_spread"),this.childContainer.removeClass("grid_child_con").addClass("grid_child_non")}};var m=function(t){var e=this;e.options=t=i.extend(!0,{type:"grid",pageEnabled:!1,pageSize:10,rowHeight:30,height:"auto",multiselect:!1,subKey:"children",data:[],columns:[],children:null,search:null,onSelectRow:r.noop},t),i.each(t.columns,function(e,n){t.columns[e]=i.extend({text:"",bind:"",render:null,width:10,align:"left",valign:"center",type:"normal",style:{},css:"",defaultVal:""},n)}),e.$el=i(e.el),e.el=e.$el[0],e.$header=e.$el.find(".grid_header"),e.$body=e.$el.find(".grid_body"),e.cid=r.guid(),e.listen(e.events),"tree"==t.type&&(e.treeDeepRecord=[]),e.rows=[],e.selectedRows=[],e.adjustWidth(),e.createHead(),e.createSearch(),t.pageEnabled&&(e.page=new o({id:i("<DIV class='page'>å±0æ¡æ°æ®</DIV>").appendTo(e.$el),page:1,pageSize:e.options.pageSize,total:0,onChange:function(t){e.ajaxSettings.data.page=t,e.load()}}))};m.prototype={events:{"click .grid_header .sortable":function(t){var e=this,n=i(t.currentTarget),r=e.ajaxSettings.data,s=n.data("bind");r.sort=s,e.currentSort!=t.currentTarget&&(n.removeClass("sort_desc sort_asc"),e.currentSort=t.currentTarget);var a=!n.hasClass("sort_asc");return a?n.removeClass("sort_desc").addClass("sort_asc"):n.removeClass("sort_asc").addClass("sort_desc"),r.asc=a,e.options.pageEnabled?(r.page=1,e.load()):(e._data.sort(function(t,e){return c(t[s],e[s],a)}),e.rows.sort(function(t,e){var n=c(t.data[s],e.data[s],a);return n>0?e.$el.insertBefore(t.$el):0>n&&t.$el.insertBefore(e.$el),n})),!1},"click .grid_header .grid_spread,.grid_fold":function(t){var e=i(t.currentTarget);return e.hasClass("grid_spread")?(e.removeClass("grid_spread").addClass("grid_fold"),i.each(this.rows,function(t,e){e.spread()})):(e.removeClass("grid_fold").addClass("grid_spread"),i.each(this.rows,function(t,e){e.fold()})),!1},"click .grid_body .grid_spread,.grid_fold":function(t){var e=i(t.currentTarget);return e.hasClass("grid_spread")?this.rows[e.data("rowindex")].spread():this.rows[e.data("rowindex")].fold(),!1},"click .js_grid_selector":function(t){i(t.currentTarget);this.$el.find("input[name='__gs_"+this.cid+"']").prop({checked:this.checked});var n=this.checked?"select":"cancelSelect";if(this.selectedRows.length=0,this.selectedRow=!1,i.each(this.rows,function(t,e){e[n]()}),0==this.selectedRows.length)this.selectedRow=null;else{var r=this.selectedRows[0];r!=this.selectedRow&&(this.selectedRow=r)}return!1},"click .grid_row":function(t){var e=this.rows[i(t.currentTarget).data("index")];this.options.multiselect?t.target.name!="__gs_"+this.cid&&e[e.selected?"cancelSelect":"select"]():this.selectedRow!=e&&(this.selectedRow&&this.selectedRow.cancelSelect(),e.select())},"click .grid_tree":function(t){var e=this,n=i(t.currentTarget).closest(".grid_row"),r=n.data("treeid"),s=this.$el.find("[parenttree^='"+r+"_']");return n.hasClass("grid_tree_fold")?(n.removeClass("grid_tree_fold").addClass("grid_tree_spread"),u(s)):(n.removeClass("grid_tree_spread").addClass("grid_tree_fold"),s.each(function(t,n){n=i(n),e.$body.find('[data-treeid="'+n.data("treeid").replace(/_\d+$/,"")+'"]').hasClass("grid_tree_fold")&&d(n,e.options.rowHeight)})),!1},"blur .grid_cell_textbox":function(t){var e=i(t.currentTarget);return this.cell(e.data("row"),e.data("cell")).validate(),!1},"click .grid_selector":function(t){if(this.options.multiselect){var e=t.currentTarget,n=this.rows[i(e).data("row")];e.checked?n.select():n.cancelSelect()}},"click .grid_search":"search"},on:s.on,trigger:s.trigger,listen:s.listen,cell:function(t,e){return this.rows[t].cells[e]},ajaxSettings:{},el:'<div class="grid_cont"><div class="grid"><div class="grid_border_r"><div class="grid_header_cont"><ol class="grid_header"></ol></div><div class="grid_body"></div></div></div></div>',load:function(){},adjustWidth:function(){var o,t=this.options,e=t.columns.length-1,n=0,s=0,a=0,c=[];i.each(t.columns,function(t,e){e.width=parseInt(e.width),e.hide||(a+=e.width)});for(var u=0;e>u;u++)o=t.columns[u],n=Math.round(100*o.width/a),c[u]=n,s+=n;c[e]=r.ie?"auto":100-s,this.columnWidths=c},createHead:function(){var t=this,e=t.options,n=t.columnWidths;i.each(e.columns,function(r,s){var l,a="number"==typeof n[r]?n[r]+"%":n[r],o=i("<li></li>");s.index=r,s.height=e.rowHeight,"selector"==s.type&&e.multiselect?(l=i('<input class="js_grid_selector" type="checkbox" data-cid="'+t.cid+'" />').prop({checked:!1}),s.align="center",a=50):(l=i("<a>"+s.text+"</a>"),0==r&&e.children&&(i("<div class='grid_spread'></div>").append(l).appendTo(cell),s.align="left"),(s.sortAble||s.sortable)&&s.bind&&l.addClass("sortable").attr("data-bind",s.bind)),s.curWidth=a,o.append(l).css({textAlign:s.align,width:a,"float":"auto"==a?"none":""}).appendTo(t.$header)})},msg:function(t){var e=this.$body[0].offsetHeight||100;this.$body.html('<div style="border-bottom: 1px solid #cdcdcd;height:'+e+"px;line-height:"+e+'px;text-align:center">'+t+"</div>")},data:function(t){var e=this;return void 0===t?e._data:(e._data=t,null!=t&&t.length?(e.$body.html(""),void i.each(t,function(t,n){e.append(n)})):void e.msg("ææ æ°æ®"))},append:function(t,e,n){var r=this,s=r.options,a=new p(r,{data:t,index:r.rows.length});if(r.rows.push(a),"tree"!=s.type&&s.children){var o,l=i('<div class="grid_child_non"></div>').appendTo(r.$body);a.childContainer=l,a.children=[],i.each(s.children,function(e,n){"function"==typeof n.render?a.children.push(n.render(l,t,a)):(s.subKey&&(n.data=t[s.subKey]),o=new m(i("<div></div>").appendTo(l),n),o.parentRow=a,a.children.push(o))})}else"tree"==s.type&&(e=e||0,r.treeDeepRecord[e]=r.treeDeepRecord[e]?r.treeDeepRecord[e]+1:1,a.treeDeep=e,n=n||0,a.parentTreeId=n,a.treeId=n+"_"+r.treeDeepRecord[e],a.$el.attr({"data-treeid":subtree}));i.each(s.columns,function(t,e){a.append(e)}),r.$body.append(a.$el)},load:function(){var t=this,e=t.ajaxSettings,n=e.data;return t.msg("æ­£å¨è½½å¥..."),t.page&&t.page.clear(),e.beforeSend&&e.beforeSend.call(t,n),i.ajax({url:e.url,type:e.type||"POST",data:n,dataType:"json",cache:!1,success:function(i){i.success?(t.data(i.data),t.options.pageEnabled&&(t.page.change({page:n.page,pageSize:n.pageSize,total:i.total}),t.trigger("PageChange",n.page)),e.success&&e.success.call(t,i.data)):t.msg("string"==typeof i.msg?i.msg:JSON.stringify(i.msg))},error:function(n){e.error?e.error.call(t,n):t.msg(n.responseText)}}),t},search:function(t){var e=this,n=i.extend(!0,{},e.ajaxSettings,!t||t.target?{}:t);e.ajaxSettings=n;var r=n.data||(n.data={});return e.options.pageEnabled&&(r.page=1,r.pageSize=e.options.pageSize),e.controls&&i.each(e.controls,function(t,e){r[t]=e.$el.val()}),e.load()},createSearch:function(){var t=this,e=this.options.search;if(t.ajaxSettings.data={},e){i.extend(t.ajaxSettings,r.pick(e,h));var n={},s=e.data;if(s&&i.each(s,function(e,r){i.isPlainObject(r)?(n[e]=r,s[e]=""):t.ajaxSettings.data[e]=r}),n&&!i.isEmptyObject(n)){t.controls=n;var a=i('<div class="search"></div>'),o=!1;i.each(n,function(e,r){r=i.extend({label:"",name:""||e,className:"text",type:"text",value:"",render:null,width:null,options:null,newLine:!1},r),r.newLine&&a.append("<br>"),r.label?i("<i>"+r.label+"</i>").appendTo(a):a.append(" ");var s=r.name,l={name:s,type:r.type};if(i.isFunction(r.render)){var c=r.render.call(t,a);"string"==typeof c&&a.append(c),l.type="render",l.$el=a.find('[name="'+s+'"]')}else"calendar"==r.type?(c=i('<input name="'+s+'" class="'+r.className+'" type="text"/>'),seajs.use(["./components/jquery.datepicker","./components/jquery.datepicker.css"],function(){c.datePicker(i.extend(r.options,{clickInput:!0}))})):"select"==r.type?(c=i('<select name="'+s+'"></select>'),i.isArray(r.options)&&i.each(r.options,function(t,e){c.each(function(){this.options.add(new Option(e.text,e.value))})}),r.change&&c.on("change",r.change)):c=i('<input type="'+r.type+'" name="'+s+'" class="'+r.className+'"/>'),r.width&&c.css({width:width}),c.appendTo(a).val(r.value),l.$el=c;"hidden"!=l.type&&(o=!0),n[e]=l}),o?t.$searchBtn=i('<button class="grid_search button">æç´¢</button>').appendTo(a):a.hide(),t.$search=a,t.$el.prepend(a)}}}},n.exports=m});define("components/page",["$","util"],function(t,e,n){function o(t){this.options=i.extend({id:"",page:1,pageSize:10,total:0,onChange:function(t){},msg:"å±<%=total%>æ¡æ°æ®&nbsp;&nbsp;æ¯é¡µ<%=pageSize%>&nbsp;&nbsp;å½åç¬¬<%=page%>/<%=totalPages%>é¡µ"},t),this.container=i(t.id),this.draw()}var i=t("$"),r=t("util"),s=r.template,a=function(t,e){return e=e||t,'<a href="javascript:void(0);" page="'+t+'">'+e+"</a>"};o.prototype={draw:function(){var t=this.options,e=this.container,n=t.pageSize||10;t.pageSize=n;var r=t.totalPages=(t.total-(t.total%n||n))/n+1;if(r>0){e.html(s(t.msg,t)),e=i("<div></div>").appendTo(e);var o="",l=parseInt(t.page),n=(t.total,t.pageSize),u=t.onChange,d=i.proxy(this._serialButtons,this);o+=1==l?"<span>ç¬¬ä¸é¡µ</span><span>ä¸ä¸é¡µ</span>":a(1,"ç¬¬ä¸é¡µ")+a(l-1,"ä¸ä¸é¡µ"),7>=r?o+=d(1,r):(o+=5>l?d(1,5)+"&nbsp;...&nbsp;":d(1,2)+"&nbsp;...&nbsp;"+(l+3>=r?d(r-4,r-1):d(l-1,l+2)+"&nbsp;...&nbsp;"),o+=d(r,r)),o+=r==l?"<span>ä¸ä¸é¡µ</span><span>æåä¸é¡µ</span>":a(l+1,"ä¸ä¸é¡µ")+a(r,"æåä¸é¡µ"),e.html(o).find("a").click(function(){u(this.getAttribute("page"))})}else e.html("å±0æ¡æ°æ®")},change:function(t){"number"==typeof t?this.options.page=page:i.extend(this.options,t),this.draw()},clear:function(){this.container.html("&nbsp;")},_serialButtons:function(t,e){var n=this.options.page;html="";for(var i=t;e>=i;i++)html+=i==n?"<span>"+i+"</span>":a(i);return html}},n.exports=o});define("widget/tip",["$","util","core/promise"],function(t,e){var n=t("$"),r=(t("util"),t("core/promise")),s=n('<div class="tip" style="display:none"></div>').on(n.fx.transitionEnd,function(){s.hasClass("tip-hide")&&s.hide()}).appendTo(document.body);e.promise=r.resolve(),e.msec=2e3,e.show=function(){s.hasClass("tip-show")||s.removeClass("tip-hide").show().addClass("tip-show")},e.msg=function(t){var e=this;e.promise.then(function(){return s.html(t),e.show(),setTimeout(function(){e.hide(),e.promise.resolve()},e.msec),this})},e.hide=function(){s.removeClass("tip-show").addClass("tip-hide")},sl.tip=function(t){e.msg(t)}});define("widget/dialog",["$","util","./../core/base","./../core/view"],function(t,e,n){var i=t("$"),r=t("util"),s=t("./../core/view"),a=null,o=s.extend({events:{"click .js_dialog_btn":"action","tap .js_close_dialog":function(){this.hide()},touchmove:function(t){t.preventDefault()}},className:"dialog",el:"<div></div>",template:r.template('<%if(isShowClose){%><div class="dialog-close js_close_dialog"></div><%}%><%if(isShowTitle){%><div class="dialog-title"><h3 class="js_title"><%=title%></h3></div><%}%><div class="dialog-content js_content"><%=content%></div><div class="dialog-btns"><%for(var i=0,len=buttons.length,button;i<len;i++){button=buttons[i];%><a class="dialog-btn js_dialog_btn<%=button.className?" "+button.className:" "%>"><%=button.text%></a><%}%></div>'),options:{isShowClose:!1,isShowTitle:!0,title:null,content:null,buttons:[]},title:function(t){return"undefined"==typeof t?this.$title.html():(this.$title.html(t),this)},initialize:function(){var t=this,e=r.pick(t.options,["top","isShowClose","isShowTitle","title","content","buttons"]);t.$el.html(t.template(e)),t.$title=t.$(".js_title"),t.$content=t.$(".js_content")},action:function(t){this.options.buttons[i(t.currentTarget).index()].click.call(this,t)},hide:function(){var t=this;t._visible&&(t._visible=!1,a.hide(),t.$el.css({"-webkit-transform":"scale(1)",opacity:1}).animate({opacity:0,scale:0},300,"ease-out",function(){t.$el.hide(),t.trigger("Hide")}))},show:function(){var t=this;t._visible||(t._visible=!0,a||(a=i('<div style="position:fixed;top:0px;bottom:0px;right:0px;width:100%;background: #888;opacity: 0.5;z-index:2000;display:none"></div>').appendTo(document.body)),a.show(),null==t.el.parentNode&&t.$el.appendTo(document.body),t.$el.css({"-webkit-transform":"",display:"block",top:this.options.top||"50%"}),t.$el.css({marginTop:this.$el.height()/-2,"-webkit-transform":"scale(0)",opacity:0}).animate({opacity:1,scale:1},300,"ease-out",function(){t.trigger("Show")}))},content:function(t){return"undefined"==typeof t?this.$content:void this.$content.html(t)}}),l=null;sl.prompt=function(t,e,n){e||(e=t,t="è¯·è¾å¥"),l?l.title(t):l=new o({title:t,content:'<input type="text" class="prompt-text" /><input type="password" class="prompt-text" />'}),l.$("input.prompt-text").val("").hide().filter('[type="'+(n||"text")+'"]').show(),l.options.onOk=function(){return e.call(this,this.$('input[type="'+(n||"text")+'"].prompt-text').val())},l.options.onCancel=function(){e.call(this)},l.show(),i(window).one("hashchange",function(){l.hide()})};var c=null;return sl.confirm=function(t,e,n,r){var s={};i.isPlainObject(t)?(r=n,n=e,i.extend(s,t)):i.isFunction(e)?(r=n,n=e,s.content=t,s.title="ç¡®è®¤æç¤º"):(s.title=t,s.content=e),c?(c.title(s.title),c.$(".dialog-content").html(s.content),c.$(".js_hide").html(s.cancelText||"åæ¶"),c.$(".js_ok").html(s.okText||"ç¡®å®")):c=new o(s),c.options.onOk=function(){n.call(this)},c.options.onCancel=function(){r&&r.call(this)},c.show(),i(window).one("hashchange",function(){c.hide()})},o});